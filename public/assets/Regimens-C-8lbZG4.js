import{c as le,q as fe,r as p,j as e,s as P,e as v,a as Q,d as be,I as N,T as q,B as je,o as ae,h as ve,D as Ne,t as we,A as Ce,H as De,S as Ae,F as ie}from"./index-Bhw970Mt.js";import{a as _}from"./env-CjZCiFfN.js";import{C as L}from"./Card-xxJ0N2iO.js";import{A as J}from"./Alert-Ce4CVrwB.js";import{L as z}from"./LoadingSpinner-DmXCsUX4.js";import{T as Se}from"./trending-down-BG9g-gf-.js";import{E as $e}from"./eye-B2OXPKvz.js";import{C as ke}from"./circle-check-big-BS3hXAhd.js";import{C as ne}from"./circle-x-pntuk0KV.js";import{F as Me}from"./funnel-BH8iwznT.js";import{D as Le}from"./download-BdaDgNV1.js";import{C as re}from"./check-CF29A6wX.js";import{C as Pe}from"./copy-Cv9jiAcT.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]],Te=le("droplet",Fe);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]],Ie=le("scale",Ee);class B{constructor(){}static getInstance(){return B.instance||(B.instance=new B),B.instance}calculateDoseWithAlerts(h,s,l,o,n){const i=[],m=[];let c=l,g=1;const y=this.calculateAge(h.demographics.dateOfBirth);if(y>=65){const w=this.getAgeBasedAdjustment(y,s);w.factor!==1&&(c*=w.factor,g*=w.factor,m.push({originalDose:l,recommendedDose:c,unit:o,adjustmentReason:w.reason,adjustmentFactor:w.factor,confidence:"high",references:["Geriatric Dosing Guidelines","Beers Criteria"]}),i.push({id:`age-${Date.now()}`,type:"dosing",severity:w.factor<.7?"high":"moderate",message:"Age-based dose adjustment recommended",details:`Patient age ${y} years requires dose modification for ${s.name}`,recommendedAction:`Consider ${Math.round((1-w.factor)*100)}% dose reduction`,affectedMedication:s.name,category:"age",source:"Geriatric Pharmacology Guidelines",priority:7}))}const d=this.checkRenalFunction(h,s,c,o);i.push(...d.alerts),d.adjustmentFactor!==1&&(c*=d.adjustmentFactor,g*=d.adjustmentFactor,m.push({originalDose:l*(g/d.adjustmentFactor),recommendedDose:c,unit:o,adjustmentReason:"Renal impairment adjustment",adjustmentFactor:d.adjustmentFactor,confidence:"high",references:["Kidney Disease: Improving Global Outcomes (KDIGO)","FDA Renal Impairment Guidance"]}));const b=this.checkHepaticFunction(h,s,c,o);i.push(...b.alerts),b.adjustmentFactor!==1&&(c*=b.adjustmentFactor,g*=b.adjustmentFactor,m.push({originalDose:l*(g/b.adjustmentFactor),recommendedDose:c,unit:o,adjustmentReason:"Hepatic impairment adjustment",adjustmentFactor:b.adjustmentFactor,confidence:"moderate",references:["Child-Pugh Classification","FDA Hepatic Impairment Guidance"]}));const T=this.checkWeightBasedDosing(h,s,c,o);i.push(...T.alerts);const C=this.checkGeneticFactors(h,s,c,o);i.push(...C.alerts),C.adjustmentFactor!==1&&(c*=C.adjustmentFactor,g*=C.adjustmentFactor);const E=this.checkDrugAllergies(h,s);i.push(...E);const F=this.checkLabValues(h,s);i.push(...F);const A=this.checkContraindications(h,s);i.push(...A);const x=this.calculateSafetyScore(i);return{recommendedDose:Math.round(c*100)/100,alerts:i.sort((w,u)=>u.priority-w.priority),adjustments:m,safetyScore:x}}calculateAge(h){const s=new Date,l=new Date(h);let o=s.getFullYear()-l.getFullYear();const n=s.getMonth()-l.getMonth();return(n<0||n===0&&s.getDate()<l.getDate())&&o--,o}getAgeBasedAdjustment(h,s){const l=s.name.toLowerCase();return h>=75?l.includes("doxorubicin")||l.includes("adriamycin")?{factor:.75,reason:"Increased cardiotoxicity risk in elderly patients"}:l.includes("carboplatin")||l.includes("cisplatin")?{factor:.8,reason:"Increased nephrotoxicity and ototoxicity risk"}:l.includes("fluorouracil")||l.includes("5-fu")?{factor:.85,reason:"Increased risk of severe mucositis and myelosuppression"}:{factor:.9,reason:"General elderly dose reduction for safety"}:h>=65?l.includes("doxorubicin")||l.includes("adriamycin")?{factor:.85,reason:"Moderate cardiotoxicity risk reduction"}:{factor:.95,reason:"Mild elderly dose adjustment"}:{factor:1,reason:"No age-based adjustment needed"}}checkRenalFunction(h,s,l,o){const n=[];let i=1;const m=h.labValues.filter(c=>c.labType.toLowerCase().includes("creatinine clearance")||c.labType.toLowerCase()==="crcl").sort((c,g)=>new Date(g.timestamp).getTime()-new Date(c.timestamp).getTime())[0];if(m){const c=m.value,g=s.name.toLowerCase();c<30?g.includes("carboplatin")?(i=.5,n.push({id:`renal-severe-${Date.now()}`,type:"dosing",severity:"critical",message:"Severe renal impairment detected",details:`CrCl ${c} mL/min requires significant dose reduction for ${s.name}`,recommendedAction:"50% dose reduction recommended, consider nephrology consultation",affectedMedication:s.name,category:"renal",source:"Renal Dosing Guidelines",priority:9})):g.includes("cisplatin")&&n.push({id:`renal-contraindication-${Date.now()}`,type:"contraindication",severity:"critical",message:"Cisplatin contraindicated in severe renal impairment",details:`CrCl ${c} mL/min is below safe threshold for cisplatin administration`,recommendedAction:"Consider alternative platinum agent (carboplatin) or non-platinum regimen",affectedMedication:s.name,category:"renal",source:"FDA Drug Label",priority:10}):c<50?(g.includes("carboplatin")||g.includes("cisplatin"))&&(i=.75,n.push({id:`renal-moderate-${Date.now()}`,type:"dosing",severity:"high",message:"Moderate renal impairment requires dose adjustment",details:`CrCl ${c} mL/min requires dose modification for ${s.name}`,recommendedAction:"25% dose reduction recommended",affectedMedication:s.name,category:"renal",source:"NCCN Guidelines",priority:8})):c<80&&n.push({id:`renal-mild-${Date.now()}`,type:"monitoring",severity:"moderate",message:"Mild renal impairment detected",details:`CrCl ${c} mL/min requires close monitoring during ${s.name} therapy`,recommendedAction:"Monitor renal function before each cycle",affectedMedication:s.name,category:"renal",source:"Clinical Guidelines",priority:5})}else n.push({id:`renal-missing-${Date.now()}`,type:"lab",severity:"moderate",message:"Recent renal function test required",details:`No recent creatinine clearance available for safe ${s.name} dosing`,recommendedAction:"Obtain creatinine clearance before drug administration",affectedMedication:s.name,category:"renal",source:"Standard of Care",priority:6});return{alerts:n,adjustmentFactor:i}}checkHepaticFunction(h,s,l,o){const n=[];let i=1;const m=h.labValues.filter(y=>y.labType.toLowerCase().includes("ast")||y.labType.toLowerCase().includes("sgot")).sort((y,d)=>new Date(d.timestamp).getTime()-new Date(y.timestamp).getTime())[0],c=h.labValues.filter(y=>y.labType.toLowerCase().includes("alt")||y.labType.toLowerCase().includes("sgpt")).sort((y,d)=>new Date(d.timestamp).getTime()-new Date(y.timestamp).getTime())[0],g=h.labValues.filter(y=>y.labType.toLowerCase().includes("bilirubin")).sort((y,d)=>new Date(d.timestamp).getTime()-new Date(y.timestamp).getTime())[0];if(m&&c&&g){const y=m.value,d=c.value,b=g.value;s.name.toLowerCase(),y>120||d>120||b>3?(i=.5,n.push({id:`hepatic-severe-${Date.now()}`,type:"dosing",severity:"critical",message:"Severe hepatic impairment detected",details:`Elevated liver enzymes (AST: ${y}, ALT: ${d}, Bilirubin: ${b}) require dose reduction`,recommendedAction:"50% dose reduction recommended, consider hepatology consultation",affectedMedication:s.name,category:"hepatic",source:"Child-Pugh Classification",priority:9})):y>80||d>80||b>2?(i=.75,n.push({id:`hepatic-moderate-${Date.now()}`,type:"dosing",severity:"high",message:"Moderate hepatic impairment requires dose adjustment",details:`Elevated liver enzymes require dose modification for ${s.name}`,recommendedAction:"25% dose reduction recommended",affectedMedication:s.name,category:"hepatic",source:"FDA Hepatic Impairment Guidance",priority:8})):(y>40||d>40||b>1.2)&&n.push({id:`hepatic-mild-${Date.now()}`,type:"monitoring",severity:"moderate",message:"Mild hepatic impairment detected",details:"Elevated liver enzymes require close monitoring during therapy",recommendedAction:"Monitor liver function before each cycle",affectedMedication:s.name,category:"hepatic",source:"Clinical Guidelines",priority:5})}return{alerts:n,adjustmentFactor:i}}checkWeightBasedDosing(h,s,l,o){const n=[],{heightCm:i,weightKg:m}=h.demographics;if(!m)return n.push({id:`weight-missing-${Date.now()}`,type:"dosing",severity:"high",message:"Patient weight required for accurate dosing",details:`Body weight is required for safe ${s.name} dosing calculations`,recommendedAction:"Obtain current accurate weight before dosing",affectedMedication:s.name,category:"weight",source:"Standard of Care",priority:8}),{alerts:n};if(i){const g=m/(i/100)**2;g<18.5?n.push({id:`weight-underweight-${Date.now()}`,type:"monitoring",severity:"moderate",message:"Patient underweight - monitor for toxicity",details:`BMI ${g.toFixed(1)} may increase risk of drug toxicity`,recommendedAction:"Consider dose reduction and enhanced monitoring",affectedMedication:s.name,category:"weight",source:"Clinical Guidelines",priority:6}):g>30&&n.push({id:`weight-obese-${Date.now()}`,type:"monitoring",severity:"moderate",message:"Obesity may affect drug distribution",details:`BMI ${g.toFixed(1)} may require dosing adjustment considerations`,recommendedAction:"Consider BSA-based dosing and monitor for efficacy",affectedMedication:s.name,category:"weight",source:"Obesity Pharmacology Guidelines",priority:5})}return s.name.toLowerCase().includes("carboplatin")&&n.push({id:`dosing-method-${Date.now()}`,type:"dosing",severity:"moderate",message:"Carboplatin dosing recommendation",details:"Carboplatin should be dosed using Calvert formula (AUC-based) rather than BSA",recommendedAction:"Use AUC-based dosing: Dose = AUC × (CrCl + 25)",affectedMedication:s.name,category:"general",source:"Calvert Formula",priority:7}),{alerts:n}}checkGeneticFactors(h,s,l,o){const n=[];let i=1;const m=s.name.toLowerCase();return h.genetics.forEach(c=>{const g=c.geneSymbol.toUpperCase();g==="DPYD"&&(m.includes("fluorouracil")||m.includes("5-fu")||m.includes("capecitabine"))&&(c.metabolizerStatus==="poor"||c.phenotype.toLowerCase().includes("deficient")?(i=.25,n.push({id:`genetic-dpyd-${Date.now()}`,type:"dosing",severity:"critical",message:"DPYD deficiency detected - severe dose reduction required",details:`${c.phenotype} DPYD status requires 75% dose reduction for fluoropyrimidines`,recommendedAction:"Start with 25% of standard dose and monitor closely",affectedMedication:s.name,category:"genetic",source:"CPIC Guidelines",priority:10})):c.metabolizerStatus==="intermediate"&&(i=.5,n.push({id:`genetic-dpyd-intermediate-${Date.now()}`,type:"dosing",severity:"high",message:"DPYD intermediate metabolism - dose reduction required",details:"Intermediate DPYD activity requires dose reduction for fluoropyrimidines",recommendedAction:"Start with 50% of standard dose",affectedMedication:s.name,category:"genetic",source:"CPIC Guidelines",priority:9}))),g==="UGT1A1"&&m.includes("irinotecan")&&(c.phenotype.includes("*28/*28")||c.metabolizerStatus==="poor")&&(i=.7,n.push({id:`genetic-ugt1a1-${Date.now()}`,type:"dosing",severity:"high",message:"UGT1A1 polymorphism affects irinotecan metabolism",details:"UGT1A1*28/*28 genotype increases risk of severe neutropenia and diarrhea",recommendedAction:"30% dose reduction recommended for initial cycles",affectedMedication:s.name,category:"genetic",source:"FDA Drug Label",priority:8})),g==="TPMT"&&(m.includes("mercaptopurine")||m.includes("azathioprine"))&&(c.metabolizerStatus==="poor"?(i=.1,n.push({id:`genetic-tpmt-${Date.now()}`,type:"dosing",severity:"critical",message:"TPMT deficiency - extreme dose reduction required",details:"TPMT poor metabolizer status requires 90% dose reduction",recommendedAction:"Start with 10% of standard dose",affectedMedication:s.name,category:"genetic",source:"CPIC Guidelines",priority:10})):c.metabolizerStatus==="intermediate"&&(i=.5,n.push({id:`genetic-tpmt-intermediate-${Date.now()}`,type:"dosing",severity:"high",message:"TPMT intermediate metabolism - dose reduction required",details:"Intermediate TPMT activity requires dose reduction",recommendedAction:"Start with 50% of standard dose",affectedMedication:s.name,category:"genetic",source:"CPIC Guidelines",priority:9})))}),{alerts:n,adjustmentFactor:i}}checkDrugAllergies(h,s){const l=[];return h.allergies.forEach(o=>{const n=o.allergen.toLowerCase(),i=s.name.toLowerCase();(i.includes(n)||n.includes(i))&&l.push({id:`allergy-direct-${Date.now()}`,type:"allergy",severity:o.severity==="life-threatening"?"critical":o.severity==="severe"?"high":"moderate",message:"Known drug allergy detected",details:`Patient has documented ${o.severity} allergy to ${o.allergen}`,recommendedAction:"DO NOT ADMINISTER - Consider alternative agent",affectedMedication:s.name,category:"general",source:"Patient Allergy History",priority:10}),n.includes("platinum")&&(i.includes("carboplatin")||i.includes("cisplatin")||i.includes("oxaliplatin"))&&l.push({id:`allergy-cross-platinum-${Date.now()}`,type:"allergy",severity:"high",message:"Potential platinum cross-sensitivity",details:`Patient has allergy to ${o.allergen}, cross-sensitivity possible with ${s.name}`,recommendedAction:"Consider premedication or alternative non-platinum regimen",affectedMedication:s.name,category:"general",source:"Cross-Sensitivity Database",priority:8}),n.includes("sulfa")&&i.includes("sulfamethoxazole")&&l.push({id:`allergy-cross-sulfa-${Date.now()}`,type:"allergy",severity:"high",message:"Sulfa allergy cross-sensitivity",details:`Patient has sulfa allergy, potential cross-reactivity with ${s.name}`,recommendedAction:"Consider alternative antibiotic",affectedMedication:s.name,category:"general",source:"Cross-Sensitivity Database",priority:8})}),l}checkLabValues(h,s){const l=[],o=s.name.toLowerCase(),n=g=>h.labValues.filter(y=>y.labType.toLowerCase().includes(g)).sort((y,d)=>new Date(d.timestamp).getTime()-new Date(y.timestamp).getTime())[0],i=n("anc")||n("neutrophil");i&&(o.includes("doxorubicin")||o.includes("carboplatin")||o.includes("paclitaxel"))&&(i.value<1e3?l.push({id:`lab-anc-low-${Date.now()}`,type:"lab",severity:"critical",message:"Severe neutropenia - hold chemotherapy",details:`ANC ${i.value} cells/μL is below safe threshold for chemotherapy`,recommendedAction:"Hold treatment until ANC > 1000, consider growth factor support",affectedMedication:s.name,category:"hematologic",source:"NCCN Guidelines",priority:10}):i.value<1500&&l.push({id:`lab-anc-borderline-${Date.now()}`,type:"lab",severity:"high",message:"Borderline neutropenia detected",details:`ANC ${i.value} cells/μL requires close monitoring`,recommendedAction:"Consider dose reduction or delay, monitor closely",affectedMedication:s.name,category:"hematologic",source:"Clinical Guidelines",priority:8}));const m=n("platelet");m&&m.value<100&&l.push({id:`lab-platelets-low-${Date.now()}`,type:"lab",severity:m.value<50?"critical":"high",message:`${m.value<50?"Severe":"Moderate"} thrombocytopenia detected`,details:`Platelet count ${m.value} × 10³/μL may contraindicate therapy`,recommendedAction:m.value<50?"Hold treatment, consider platelet transfusion":"Monitor closely, consider dose reduction",affectedMedication:s.name,category:"hematologic",source:"Hematology Guidelines",priority:m.value<50?10:8});const c=n("lvef")||n("ejection fraction");return c&&(o.includes("doxorubicin")||o.includes("trastuzumab"))&&c.value<50&&l.push({id:`lab-lvef-low-${Date.now()}`,type:"lab",severity:c.value<40?"critical":"high",message:"Reduced cardiac function detected",details:`LVEF ${c.value}% may contraindicate cardiotoxic therapy`,recommendedAction:c.value<40?"Cardiology consultation required before treatment":"Close cardiac monitoring recommended",affectedMedication:s.name,category:"cardiac",source:"Cardio-Oncology Guidelines",priority:9}),l}checkContraindications(h,s){const l=[],o=s.name.toLowerCase();return h.conditions.forEach(n=>{const i=n.condition.toLowerCase();i.includes("heart failure")&&o.includes("doxorubicin")&&l.push({id:`contraindication-hf-doxorubicin-${Date.now()}`,type:"contraindication",severity:"critical",message:"Doxorubicin contraindicated in heart failure",details:"Active heart failure is a contraindication to doxorubicin therapy",recommendedAction:"Consider alternative anthracycline-free regimen",affectedMedication:s.name,category:"cardiac",source:"FDA Drug Label",priority:10}),i.includes("renal failure")&&o.includes("cisplatin")&&l.push({id:`contraindication-rf-cisplatin-${Date.now()}`,type:"contraindication",severity:"critical",message:"Cisplatin contraindicated in renal failure",details:"Renal failure is a contraindication to cisplatin therapy",recommendedAction:"Consider carboplatin or alternative regimen",affectedMedication:s.name,category:"renal",source:"FDA Drug Label",priority:10}),i.includes("hearing loss")&&o.includes("cisplatin")&&l.push({id:`contraindication-hearing-cisplatin-${Date.now()}`,type:"contraindication",severity:"high",message:"Cisplatin ototoxicity risk in hearing impairment",details:"Pre-existing hearing loss increases ototoxicity risk with cisplatin",recommendedAction:"Consider carboplatin, baseline audiometry recommended",affectedMedication:s.name,category:"general",source:"Clinical Guidelines",priority:8}),i.includes("neuropathy")&&o.includes("paclitaxel")&&l.push({id:`contraindication-neuropathy-paclitaxel-${Date.now()}`,type:"contraindication",severity:"high",message:"Paclitaxel neurotoxicity risk in existing neuropathy",details:"Pre-existing neuropathy may be exacerbated by paclitaxel",recommendedAction:"Consider alternative taxane or non-taxane regimen",affectedMedication:s.name,category:"general",source:"Neurotoxicity Guidelines",priority:8})}),l}calculateSafetyScore(h){let s=100;return h.forEach(l=>{switch(l.severity){case"critical":s-=30;break;case"high":s-=20;break;case"moderate":s-=10;break;case"low":s-=5;break}}),Math.max(0,s)}getMonitoringRecommendations(h,s){const l=[],o=s.name.toLowerCase();return o.includes("doxorubicin")&&l.push({parameter:"LVEF/ECHO",frequency:"Before treatment, after 200-300 mg/m², then every 100 mg/m²",rationale:"Monitor for doxorubicin-induced cardiomyopathy",urgency:"critical"}),o.includes("cisplatin")&&l.push({parameter:"Creatinine/BUN",frequency:"Before each cycle",rationale:"Monitor for cisplatin nephrotoxicity",urgency:"critical"},{parameter:"Audiometry",frequency:"Baseline, then as clinically indicated",rationale:"Monitor for cisplatin ototoxicity",urgency:"routine"},{parameter:"Electrolytes (Mg, K)",frequency:"Before each cycle",rationale:"Monitor for cisplatin-induced electrolyte wasting",urgency:"urgent"}),o.includes("paclitaxel")&&l.push({parameter:"Neurological exam",frequency:"Before each cycle",rationale:"Monitor for paclitaxel-induced peripheral neuropathy",urgency:"routine"}),(o.includes("carboplatin")||o.includes("cisplatin")||o.includes("doxorubicin"))&&l.push({parameter:"CBC with differential",frequency:"Before each cycle, nadir count (day 10-14)",rationale:"Monitor for myelosuppression",urgency:"critical"}),l}}const ce=B.getInstance(),Re=({drug:k,standardDose:h=0,unit:s="mg/m²",indication:l,onDoseCalculated:o})=>{const{state:n}=fe(),{currentPatient:i}=n,[m,c]=p.useState(h),[g,y]=p.useState(s),[d,b]=p.useState(null),[T,C]=p.useState(!1),[E,F]=p.useState(!1);p.useEffect(()=>{i&&m>0&&A()},[i,m,g,k]);const A=async()=>{if(!(!i||m<=0)){C(!0);try{await new Promise(D=>setTimeout(D,500));const a=ce.calculateDoseWithAlerts(i,k,m,g,l),S=ce.getMonitoringRecommendations(i,k);b({...a,monitoringRecommendations:S}),o&&o(a)}catch(a){console.error("Dose calculation failed:",a)}finally{C(!1)}}},x=a=>{switch(a){case"critical":return e.jsx(ne,{className:"w-5 h-5 text-red-600"});case"high":return e.jsx(q,{className:"w-5 h-5 text-red-500"});case"moderate":return e.jsx(ae,{className:"w-5 h-5 text-yellow-500"});case"low":return e.jsx(N,{className:"w-5 h-5 text-blue-500"});default:return e.jsx(N,{className:"w-5 h-5 text-gray-500"})}},w=a=>{switch(a){case"cardiac":return e.jsx(De,{className:"w-4 h-4"});case"renal":return e.jsx(Te,{className:"w-4 h-4"});case"hepatic":return e.jsx(Ce,{className:"w-4 h-4"});case"hematologic":return e.jsx(we,{className:"w-4 h-4"});case"genetic":return e.jsx(Ne,{className:"w-4 h-4"});case"weight":case"bsa":return e.jsx(Ie,{className:"w-4 h-4"});case"age":return e.jsx(ve,{className:"w-4 h-4"});default:return e.jsx(N,{className:"w-4 h-4"})}},u=a=>a>=80?"text-green-600 bg-green-100":a>=60?"text-yellow-600 bg-yellow-100":a>=40?"text-orange-600 bg-orange-100":"text-red-600 bg-red-100",I=a=>a>=80?e.jsx(ke,{className:"w-5 h-5 text-green-600"}):a>=60?e.jsx(ae,{className:"w-5 h-5 text-yellow-600"}):a>=40?e.jsx(q,{className:"w-5 h-5 text-orange-600"}):e.jsx(ne,{className:"w-5 h-5 text-red-600"});return i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center",children:e.jsx(P,{className:"w-5 h-5 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Enhanced Dose Calculator"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["AI-powered dosing with safety alerts for ",k.name]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(v,{content:"Advanced clinical decision support with real-time safety monitoring",children:e.jsx(Q,{className:"w-5 h-5 text-primary-600"})})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Standard Dose"}),e.jsx("input",{type:"number",value:m,onChange:a=>c(Number(a.target.value)),step:"0.1",min:"0",className:"block w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit"}),e.jsxs("select",{value:g,onChange:a=>y(a.target.value),className:"block w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"mg/m²",children:"mg/m²"}),e.jsx("option",{value:"mg/kg",children:"mg/kg"}),e.jsx("option",{value:"mg",children:"mg (flat dose)"}),e.jsx("option",{value:"units/m²",children:"units/m²"}),e.jsx("option",{value:"AUC",children:"AUC (Carboplatin)"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:A,disabled:T||m<=0,className:"w-full flex items-center justify-center space-x-2 px-4 py-2 bg-primary-600 text-white text-sm font-medium rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:T?e.jsxs(e.Fragment,{children:[e.jsx(z,{size:"sm"}),e.jsx("span",{children:"Calculating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{children:"Calculate Dose"})]})})})]})]}),d&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(L,{children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(P,{className:"w-5 h-5 text-gray-400"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Recommended Dose"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"text-3xl font-bold text-primary-600",children:d.recommendedDose}),e.jsx("div",{className:"text-lg text-gray-600",children:g}),d.recommendedDose!==m&&e.jsxs("div",{className:"flex items-center space-x-1",children:[d.recommendedDose<m?e.jsx(Se,{className:"w-4 h-4 text-red-500"}):e.jsx(be,{className:"w-4 h-4 text-green-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[Math.round((d.recommendedDose-m)/m*100),"%"]})]})]}),d.adjustments.length>0&&e.jsxs("div",{className:"mt-3 text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Adjustments applied:"}),e.jsx("ul",{className:"mt-1 space-y-1",children:d.adjustments.map((a,S)=>e.jsxs("li",{children:["• ",a.adjustmentReason]},S))})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(Q,{className:"w-5 h-5 text-gray-400"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Safety Score"}),e.jsx(v,{content:"Overall safety assessment based on patient factors, drug interactions, and clinical alerts",children:e.jsx(N,{className:"w-4 h-4 text-gray-400"})})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[I(d.safetyScore),e.jsx("div",{className:`text-3xl font-bold ${u(d.safetyScore).split(" ")[0]}`,children:d.safetyScore}),e.jsx("div",{className:"text-lg text-gray-600",children:"/100"})]}),e.jsx("div",{className:`mt-3 inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${u(d.safetyScore)}`,children:d.safetyScore>=80?"Safe to administer":d.safetyScore>=60?"Caution recommended":d.safetyScore>=40?"High risk - close monitoring":"Critical risk - consider alternatives"})]})]})}),d.alerts.length>0&&e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(q,{className:"w-5 h-5 text-red-500"}),e.jsxs("h4",{className:"text-lg font-semibold text-gray-900",children:["Clinical Alerts (",d.alerts.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:d.alerts.map(a=>e.jsx("div",{className:`border-l-4 p-4 rounded-lg ${a.severity==="critical"?"border-red-500 bg-red-50":a.severity==="high"?"border-orange-500 bg-orange-50":a.severity==="moderate"?"border-yellow-500 bg-yellow-50":"border-blue-500 bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[x(a.severity),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:a.message}),w(a.category),e.jsx("span",{className:"text-xs text-gray-500 bg-white px-2 py-0.5 rounded",children:a.category})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:a.details}),e.jsxs("div",{className:"bg-white bg-opacity-70 rounded p-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Recommended Action:"}),e.jsx("p",{className:"text-sm text-gray-800 mt-1",children:a.recommendedAction})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["Source: ",a.source]}),e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded-full ${a.severity==="critical"?"bg-red-100 text-red-800":a.severity==="high"?"bg-orange-100 text-orange-800":a.severity==="moderate"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:["Priority: ",a.priority,"/10"]})]})]})]})},a.id))})]}),d.monitoringRecommendations.length>0&&e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx($e,{className:"w-5 h-5 text-blue-500"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Monitoring Recommendations"}),e.jsx(v,{content:"Required monitoring parameters based on drug toxicity profile and patient risk factors",children:e.jsx(N,{className:"w-4 h-4 text-gray-400"})})]}),e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Parameter"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Frequency"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Rationale"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Urgency"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:d.monitoringRecommendations.map((a,S)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm font-medium text-gray-900",children:a.parameter}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:a.frequency}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:a.rationale}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${a.urgency==="critical"?"bg-red-100 text-red-800":a.urgency==="urgent"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:a.urgency})})]},S))})]})})]}),e.jsxs(L,{children:[e.jsxs("button",{onClick:()=>F(!E),className:"flex items-center justify-between w-full text-left",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(je,{className:"w-5 h-5 text-gray-400"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Advanced Calculations"})]}),e.jsx("div",{className:`transform transition-transform ${E?"rotate-180":""}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),E&&e.jsxs("div",{className:"mt-4 space-y-4",children:[d.adjustments.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:"Dose Adjustments Applied:"}),e.jsx("div",{className:"space-y-2",children:d.adjustments.map((a,S)=>e.jsxs("div",{className:"bg-gray-50 rounded p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-gray-900",children:a.adjustmentReason}),e.jsxs("span",{className:`text-sm px-2 py-1 rounded ${a.confidence==="high"?"bg-green-100 text-green-800":a.confidence==="moderate"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[a.confidence," confidence"]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[a.originalDose," → ",a.recommendedDose," ",a.unit,"(×",a.adjustmentFactor.toFixed(2),")"]}),a.references.length>0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["References: ",a.references.join(", ")]})]},S))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:"Patient Factors Considered:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Age:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[Math.floor((new Date().getTime()-new Date(i.demographics.dateOfBirth).getTime())/(365.25*24*60*60*1e3))," years"]})]}),i.demographics.weightKg&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Weight:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[i.demographics.weightKg," kg"]})]}),i.demographics.heightCm&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Height:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[i.demographics.heightCm," cm"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Allergies:"}),e.jsx("span",{className:"ml-2 font-medium",children:i.allergies.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Active Medications:"}),e.jsx("span",{className:"ml-2 font-medium",children:i.medications.filter(a=>a.isActive).length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Genetic Variants:"}),e.jsx("span",{className:"ml-2 font-medium",children:i.genetics.length})]})]})]})]})]})]}),!d&&!T&&e.jsx(L,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(P,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium text-gray-500",children:"Enter dose and calculate"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Advanced dose calculation with safety alerts will appear here"})]})})]}):e.jsx(L,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(P,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium text-gray-500",children:"No Patient Selected"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Select a patient to perform dose calculations"})]})})},Ze=()=>{const[k,h]=p.useState([]),[s,l]=p.useState(null),[o,n]=p.useState(null),[i,m]=p.useState(!0),[c,g]=p.useState(!1),[y,d]=p.useState(!1),[b,T]=p.useState(""),[C,E]=p.useState(""),[F,A]=p.useState(null),[x,w]=p.useState({}),[u,I]=p.useState({}),[a,S]=p.useState(null),[D,O]=p.useState({}),[U,Z]=p.useState(null),[V,X]=p.useState(null),[R,ee]=p.useState(null),[Y,oe]=p.useState("5"),[f,de]=p.useState({}),[H,me]=p.useState(!1),[M,te]=p.useState(null);p.useEffect(()=>{if(F){const t=setTimeout(()=>A(null),3e3);return()=>clearTimeout(t)}},[F]),p.useEffect(()=>{(async()=>{m(!0);try{const t=_(),r=await fetch(`${t}/regimens`);if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const j=await r.json();h(j.regimens||[])}catch(t){n(t instanceof Error?t.message:"Failed to load regimens")}finally{m(!1)}})()},[]),p.useEffect(()=>{try{const t=localStorage.getItem("pgxPhenotypes");t&&O(JSON.parse(t))}catch{}},[]);const ue=async t=>{g(!0),n(null);try{const r=_(),j=await fetch(`${r}/regimens/${t}`);if(!j.ok)throw new Error(`HTTP ${j.status}: ${j.statusText}`);const $=await j.json();l($),Z(null),X(null),ee(null),S(null)}catch(r){n(r instanceof Error?r.message:"Failed to load regimen details")}finally{g(!1)}},K=p.useMemo(()=>_(),[]),xe=t=>{try{const r=`${K}/export/regimen/${encodeURIComponent(t)}/pdf`;window.open(r,"_blank"),A("PDF download initiated")}catch{n("Failed to initiate PDF download")}},he=async()=>{if(!Array.isArray(R)||!s)return;const t=[`Regimen: ${s.name}`,a?.BSA?`BSA: ${a.BSA.toFixed(2)} m²`:"",...R.map(r=>{const j=r.calculatedMg!==void 0?`${r.calculatedMg} mg`:"-",$=r.roundedMg!==void 0?`${r.roundedMg} mg`:"-";return`${r.component}: ${r.dose} | Calculated: ${j} | Rounded: ${$}`})].filter(Boolean).join(`
`);try{await navigator.clipboard.writeText(t),A("Dose calculations copied to clipboard")}catch{n("Failed to copy to clipboard")}},ge=()=>{const t={};return u.heightCm&&(u.heightCm<100||u.heightCm>250)&&(t.height="Height must be between 100-250 cm"),u.weightKg&&(u.weightKg<20||u.weightKg>300)&&(t.weight="Weight must be between 20-300 kg"),u.ageYears&&(u.ageYears<0||u.ageYears>120)&&(t.age="Age must be between 0-120 years"),u.serumCreatinineMgDl&&(u.serumCreatinineMgDl<.1||u.serumCreatinineMgDl>20)&&(t.creatinine="Serum creatinine must be between 0.1-20 mg/dL"),x.ANC&&(x.ANC<0||x.ANC>5e4)&&(t.anc="ANC must be between 0-50,000 /µL"),x.platelets&&(x.platelets<0||x.platelets>2e6)&&(t.platelets="Platelets must be between 0-2,000,000 /µL"),x.CrCl&&(x.CrCl<0||x.CrCl>300)&&(t.creatinine_clearance="CrCl must be between 0-300 mL/min"),x.LVEF&&(x.LVEF<0||x.LVEF>100)&&(t.lvef="LVEF must be between 0-100%"),de(t),Object.keys(t).length===0},pe=async()=>{if(s){if(!ge()){n("Please correct the validation errors before proceeding");return}d(!0),n(null);try{const t=await fetch(`${K}/dosing/adjust`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({regimenId:s.id,labs:x,phenotypes:D,patient:u,rounding:parseInt(Y,10)})});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const r=await t.json();Z(r.recommendations||[]),X(r.warnings||[]),ee(r.calculatedDoses||null),S(r.calculators||null),A("Dosing calculations completed successfully")}catch(t){n(t instanceof Error?t.message:"Failed to adjust dosing")}finally{d(!1)}}},W=p.useMemo(()=>k.filter(t=>{const r=t.name.toLowerCase().includes(b.toLowerCase())||t.indication.toLowerCase().includes(b.toLowerCase()),j=!C||t.indication.toLowerCase().includes(C.toLowerCase());return r&&j}),[k,b,C]),ye=p.useMemo(()=>Array.from(new Set(k.map(r=>r.indication))).sort(),[k]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Regimen Templates"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"w-6 h-6 text-blue-600"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Production Ready"})]})]}),o&&e.jsx(J,{type:"error",title:"Error",children:o}),F&&e.jsx(J,{type:"success",title:"Success",children:F}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold",children:["Regimens (",W.length,")"]}),e.jsx(v,{content:"Browse and select oncology treatment regimens for dose calculations",children:e.jsx(N,{className:"w-4 h-4 text-gray-400"})})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search regimens...",className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:b,onChange:t=>T(t.target.value)})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Me,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsxs("select",{className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:C,onChange:t=>E(t.target.value),children:[e.jsx("option",{value:"",children:"All indications"}),ye.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),i?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(z,{size:"md"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading regimens..."})]}):e.jsxs("ul",{className:"divide-y max-h-96 overflow-y-auto",children:[W.map(t=>e.jsxs("li",{className:"py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:t.name}),e.jsx("div",{className:"text-sm text-gray-500 truncate",children:t.indication}),t.cycleLengthDays&&e.jsxs("div",{className:"text-xs text-gray-400",children:[t.cycleLengthDays," day cycle"]})]}),e.jsx("button",{className:"ml-2 px-3 py-1 text-sm text-primary-600 hover:text-primary-700 hover:bg-primary-50 rounded-md transition-colors disabled:opacity-50",onClick:()=>ue(t.id),disabled:c,children:c?e.jsx(z,{size:"sm"}):"View"})]},t.id)),W.length===0&&!i&&e.jsx("li",{className:"py-8 text-center text-gray-500",children:b||C?"No regimens match your search criteria":"No regimens available"})]})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(L,{children:c?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(z,{size:"lg"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading regimen details..."})]}):s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:s.name}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Indication: ",s.indication]}),s.cycleLengthDays&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Cycle length: ",s.cycleLengthDays," days"]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(v,{content:"Download basic regimen protocol as PDF",children:e.jsxs("button",{onClick:()=>xe(s.id),className:"inline-flex items-center px-4 py-2 bg-gray-800 text-white text-sm font-medium rounded-md hover:bg-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Download PDF"]})}),e.jsx(v,{content:"Generate comprehensive electronic Prior Authorization package with patient data, dose calculations, clinical justification, and safety monitoring",children:e.jsxs("button",{onClick:()=>{const t=u.heightCm&&u.weightKg&&u.ageYears,r=x.ANC||x.platelets||x.CrCl||x.LVEF;if(!t&&!r){n("ePA package requires patient parameters (height, weight, age) and/or lab values. Please enter data and run dose calculations first.");return}const j={regimenId:s.id,regimenName:s.name,indication:s.indication,timestamp:new Date().toISOString(),patient:{heightCm:u.heightCm,weightKg:u.weightKg,ageYears:u.ageYears,sex:u.sex,serumCreatinineMgDl:u.serumCreatinineMgDl},labs:{ANC:x.ANC,platelets:x.platelets,CrCl:x.CrCl,LVEF:x.LVEF},pharmacogenomics:D,calculations:a,dosingRecommendations:U,clinicalWarnings:V,calculatedDoses:R,roundingPrecision:Y},$=new URLSearchParams;$.set("data",JSON.stringify(j)),$.set("format","comprehensive"),$.set("include","justification,calculations,safety");const G=`${K}/export/epa-package?${$.toString()}`;window.open(G,"_blank"),A("Comprehensive ePA package with clinical justification generated")},disabled:!s,className:"inline-flex items-center px-4 py-2 bg-purple-600 text-white text-sm font-medium rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Generate ePA Pack"]})})]}),(()=>{const t=u.heightCm&&u.weightKg&&u.ageYears,r=x.ANC||x.platelets||x.CrCl||x.LVEF,j=a&&R;return t||r||j?e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-green-700",children:[e.jsx(re,{className:"w-3 h-3"}),e.jsx("span",{children:"ePA data available:"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[t&&e.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 rounded text-xs",children:"Patient data"}),r&&e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-xs",children:"Lab values"}),j&&e.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 rounded text-xs",children:"Dose calculations"}),Object.keys(D||{}).length>0&&e.jsx("span",{className:"px-2 py-0.5 bg-indigo-100 text-indigo-700 rounded text-xs",children:"PGx data"})]})]}):e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-amber-700",children:[e.jsx(q,{className:"w-3 h-3"}),e.jsx("span",{children:"Add patient data and lab values to generate comprehensive ePA package"})]})})()]})]}),Object.keys(D||{}).length>0&&e.jsx("div",{className:"text-xs text-green-700 bg-green-50 inline-block px-2 py-1 rounded",children:"Using saved PGx phenotypes"}),s.components&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:"Components"}),e.jsx(v,{content:"Active medications and their standard doses in this regimen. Actual doses may be adjusted based on patient parameters and lab values.",children:e.jsx(N,{className:"w-3 h-3 text-gray-400"})})]}),e.jsx("ul",{className:"list-disc ml-6 text-sm text-gray-700",children:s.components.map((t,r)=>e.jsxs("li",{children:[t.name,": ",t.dose]},r))})]}),s.pretreatment&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:"Pre-treatment"}),e.jsx(v,{content:"Medications that must be given before chemotherapy to prevent adverse reactions (e.g., antihistamines, steroids, antiemetics).",children:e.jsx(N,{className:"w-3 h-3 text-gray-400"})})]}),e.jsx("ul",{className:"list-disc ml-6 text-sm text-gray-700",children:s.pretreatment.map((t,r)=>e.jsx("li",{children:t},r))})]}),s.monitoring&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:"Monitoring"}),e.jsx(v,{content:"Essential lab tests and clinical assessments required during treatment to monitor for toxicity and efficacy.",children:e.jsx(N,{className:"w-3 h-3 text-gray-400"})})]}),e.jsx("ul",{className:"list-disc ml-6 text-sm text-gray-700",children:s.monitoring.map((t,r)=>e.jsx("li",{children:t},r))})]}),s.notes&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:"Clinical Notes"}),e.jsx(v,{content:"Important clinical considerations, contraindications, special populations guidance, and institutional modifications.",children:e.jsx(N,{className:"w-3 h-3 text-gray-400"})})]}),e.jsx("ul",{className:"list-disc ml-6 text-sm text-gray-700",children:s.notes.map((t,r)=>e.jsx("li",{children:t},r))})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"w-5 h-5 text-blue-600"}),e.jsx("h4",{className:"font-medium text-blue-900",children:"Dosing Calculator"})]}),e.jsx(v,{content:"Enter patient parameters and lab values for personalized dose calculations",children:e.jsx(N,{className:"w-4 h-4 text-blue-600"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Laboratory Values"}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 mb-1",children:["ANC (/µL)",e.jsx(v,{content:"Absolute Neutrophil Count - used for myelotoxicity monitoring",children:e.jsx(N,{className:"inline w-3 h-3 ml-1 text-gray-400"})})]}),e.jsx("input",{type:"number",className:`w-full border rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${f.anc?"border-red-500":"border-gray-300"}`,value:x.ANC??"",onChange:t=>w({...x,ANC:t.target.value?Number(t.target.value):void 0}),placeholder:"e.g., 1500"}),f.anc&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:f.anc})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 mb-1",children:["Platelets (/µL)",e.jsx(v,{content:"Platelet count - important for bleeding risk assessment",children:e.jsx(N,{className:"inline w-3 h-3 ml-1 text-gray-400"})})]}),e.jsx("input",{type:"number",className:`w-full border rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${f.platelets?"border-red-500":"border-gray-300"}`,value:x.platelets??"",onChange:t=>w({...x,platelets:t.target.value?Number(t.target.value):void 0}),placeholder:"e.g., 150000"}),f.platelets&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:f.platelets})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 mb-1",children:["CrCl (mL/min)",e.jsx(v,{content:"Creatinine clearance - for renal dose adjustments",children:e.jsx(N,{className:"inline w-3 h-3 ml-1 text-gray-400"})})]}),e.jsx("input",{type:"number",className:`w-full border rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${f.creatinine_clearance?"border-red-500":"border-gray-300"}`,value:x.CrCl??"",onChange:t=>w({...x,CrCl:t.target.value?Number(t.target.value):void 0}),placeholder:"e.g., 90"}),f.creatinine_clearance&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:f.creatinine_clearance})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 mb-1",children:["LVEF (%)",e.jsx(v,{content:"Left Ventricular Ejection Fraction - for cardiotoxicity monitoring",children:e.jsx(N,{className:"inline w-3 h-3 ml-1 text-gray-400"})})]}),e.jsx("input",{type:"number",className:`w-full border rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${f.lvef?"border-red-500":"border-gray-300"}`,value:x.LVEF??"",onChange:t=>w({...x,LVEF:t.target.value?Number(t.target.value):void 0}),placeholder:"e.g., 65"}),f.lvef&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:f.lvef})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Patient Parameters"}),e.jsxs("div",{className:"grid md:grid-cols-5 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 mb-1",children:"Height (cm)"}),e.jsx("input",{type:"number",className:`w-full border rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${f.height?"border-red-500":"border-gray-300"}`,value:u.heightCm??"",onChange:t=>I({...u,heightCm:t.target.value?Number(t.target.value):void 0}),placeholder:"e.g., 170"}),f.height&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:f.height})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 mb-1",children:"Weight (kg)"}),e.jsx("input",{type:"number",className:`w-full border rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${f.weight?"border-red-500":"border-gray-300"}`,value:u.weightKg??"",onChange:t=>I({...u,weightKg:t.target.value?Number(t.target.value):void 0}),placeholder:"e.g., 70"}),f.weight&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:f.weight})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 mb-1",children:"Age (years)"}),e.jsx("input",{type:"number",className:`w-full border rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${f.age?"border-red-500":"border-gray-300"}`,value:u.ageYears??"",onChange:t=>I({...u,ageYears:t.target.value?Number(t.target.value):void 0}),placeholder:"e.g., 65"}),f.age&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:f.age})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 mb-1",children:"Sex"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:u.sex||"",onChange:t=>I({...u,sex:t.target.value}),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 mb-1",children:"Serum Creatinine (mg/dL)"}),e.jsx("input",{type:"number",step:"0.01",className:`w-full border rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${f.creatinine?"border-red-500":"border-gray-300"}`,value:u.serumCreatinineMgDl??"",onChange:t=>I({...u,serumCreatinineMgDl:t.target.value?Number(t.target.value):void 0}),placeholder:"e.g., 1.0"}),f.creatinine&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:f.creatinine})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Pharmacogenomics"}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 mb-1",children:["DPYD phenotype",e.jsx(v,{content:"DPYD metabolizer status affects 5-FU/capecitabine dosing",children:e.jsx(N,{className:"inline w-3 h-3 ml-1 text-gray-400"})})]}),e.jsxs("select",{className:"w-full border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:D.DPYD||"",onChange:t=>O({...D,DPYD:t.target.value}),children:[e.jsx("option",{value:"",children:"Unknown"}),e.jsx("option",{value:"Normal metabolizer",children:"Normal metabolizer"}),e.jsx("option",{value:"Intermediate metabolizer",children:"Intermediate metabolizer"}),e.jsx("option",{value:"Poor metabolizer",children:"Poor metabolizer"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 mb-1",children:["CYP2D6 phenotype",e.jsx(v,{content:"CYP2D6 metabolizer status affects various drug metabolisms",children:e.jsx(N,{className:"inline w-3 h-3 ml-1 text-gray-400"})})]}),e.jsxs("select",{className:"w-full border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:D.CYP2D6||"",onChange:t=>O({...D,CYP2D6:t.target.value}),children:[e.jsx("option",{value:"",children:"Unknown"}),e.jsx("option",{value:"Normal metabolizer",children:"Normal metabolizer"}),e.jsx("option",{value:"Intermediate metabolizer",children:"Intermediate metabolizer"}),e.jsx("option",{value:"Poor metabolizer",children:"Poor metabolizer"}),e.jsx("option",{value:"Ultra-rapid metabolizer",children:"Ultra-rapid metabolizer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 mb-1",children:"Rounding Precision"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:Y,onChange:t=>oe(t.target.value),children:[e.jsx("option",{value:"5",children:"5 mg"}),e.jsx("option",{value:"10",children:"10 mg"}),e.jsx("option",{value:"25",children:"25 mg"})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-blue-200",children:[e.jsx("button",{onClick:pe,disabled:y,className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white text-sm font-medium rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:y?e.jsxs(e.Fragment,{children:[e.jsx(z,{size:"sm"}),e.jsx("span",{className:"ml-2",children:"Calculating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Apply Adjustments"]})}),Object.keys(D||{}).length>0&&e.jsxs("div",{className:"text-xs text-green-700 bg-green-100 px-2 py-1 rounded flex items-center",children:[e.jsx(re,{className:"w-3 h-3 mr-1"}),"Using saved PGx phenotypes"]})]})]}),a&&e.jsxs("div",{className:"flex items-center space-x-2 mt-2 text-xs text-gray-600",children:[e.jsx("span",{children:"Calculated:"}),a.BSA&&e.jsx(v,{content:"Body Surface Area calculated using Dubois formula: BSA = 0.007184 × Weight^0.425 × Height^0.725",children:e.jsxs("span",{className:"underline cursor-help",children:["BSA ",a.BSA.toFixed(2)," m²"]})}),a.CrCl&&e.jsx(v,{content:"Creatinine Clearance calculated using Cockcroft-Gault equation for renal function assessment",children:e.jsxs("span",{className:"underline cursor-help",children:["• CrCl ",Math.round(a.CrCl)," mL/min"]})})]}),U&&e.jsxs("div",{className:"mt-3 space-y-1 text-sm text-gray-700",children:[U.length===0&&e.jsx("div",{children:"No adjustments recommended."}),U.map((t,r)=>e.jsxs("div",{children:["• ",t]},r))]}),V&&V.length>0&&e.jsx("div",{className:"mt-3",children:e.jsx(J,{type:"warning",title:"Clinical Warnings",children:e.jsx("ul",{className:"list-disc ml-6 space-y-1",children:V.map((t,r)=>e.jsx("li",{children:t},r))})})}),a&&Array.isArray(R)&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"w-4 h-4 text-blue-600"}),e.jsx("h5",{className:"font-medium text-gray-900",children:"Calculated Doses"}),a.BSA&&e.jsxs("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:["BSA: ",a.BSA.toFixed(2)," m²"]})]}),e.jsxs("button",{onClick:he,className:"inline-flex items-center px-3 py-1 text-xs bg-gray-100 hover:bg-gray-200 border border-gray-300 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx(Pe,{className:"w-3 h-3 mr-1"}),"Copy Doses"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-600 bg-gray-50",children:[e.jsx("th",{className:"px-3 py-2 font-medium",children:"Component"}),e.jsx("th",{className:"px-3 py-2 font-medium",children:"Regimen Dose"}),e.jsx("th",{className:"px-3 py-2 font-medium",children:"Calculated (mg)"}),e.jsx("th",{className:"px-3 py-2 font-medium",children:"Rounded (mg)"}),e.jsx("th",{className:"px-3 py-2 font-medium",children:"Note"}),e.jsx("th",{className:"px-3 py-2 font-medium",children:"Vial Guidance"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:R.map((t,r)=>{const j={oxaliplatin:50,irinotecan:100,doxorubicin:10,leucovorin:50,paclitaxel:100,rituximab:100},$=(t.component||"").toLowerCase(),G=j[$];let se="-";return G&&t.roundedMg&&(se=`~${Math.ceil(t.roundedMg/G)} × ${G} mg`),e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 font-medium text-gray-900",children:t.component}),e.jsx("td",{className:"px-3 py-2 text-gray-700",children:t.dose}),e.jsx("td",{className:"px-3 py-2 text-gray-700",children:t.calculatedMg!==void 0?`${t.calculatedMg} mg`:"-"}),e.jsx("td",{className:"px-3 py-2 font-medium text-blue-700",children:t.roundedMg!==void 0?`${t.roundedMg} mg`:"-"}),e.jsx("td",{className:"px-3 py-2 text-gray-600",children:t.note||"-"}),e.jsx("td",{className:"px-3 py-2 text-purple-700 font-medium",children:se})]},r)})})]})}),e.jsx("div",{className:"mt-3 p-2 bg-yellow-50 border border-yellow-200 rounded text-xs text-yellow-800",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(q,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Important:"})," These are calculated suggestions only. Always verify doses, confirm vial sizes, and follow institutional protocols before finalizing orders. Rounded to nearest ",Y," mg."]})]})}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{className:"w-4 h-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h6",{className:"text-sm font-medium text-blue-900",children:"Enhanced Safety Calculator"}),e.jsx("p",{className:"text-xs text-blue-700",children:"AI-powered dose calculation with comprehensive safety alerts"})]})]}),e.jsx("button",{onClick:()=>me(!H),className:"px-3 py-1 bg-blue-600 text-white text-xs font-medium rounded hover:bg-blue-700 transition-colors",children:H?"Hide Calculator":"Open Calculator"})]}),H&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"Select Drug for Enhanced Analysis:"}),e.jsxs("select",{value:M?`${M.name}|${M.dose}`:"",onChange:t=>{if(t.target.value){const[r,j]=t.target.value.split("|");te({name:r,dose:j})}else te(null)},className:"block w-full border border-blue-300 rounded-md px-2 py-1 text-xs focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select a drug..."}),s?.components?.map((t,r)=>e.jsxs("option",{value:`${t.name}|${t.dose}`,children:[t.name," (",t.dose,")"]},r))]})]}),M&&e.jsx("div",{className:"border border-blue-200 rounded p-3 bg-white",children:e.jsx(Re,{drug:{rxcui:"mock-rxcui",name:M.name,generic_name:M.name},standardDose:parseFloat(M.dose.match(/\d+(\.\d+)?/)?.[0]||"0"),unit:M.dose.includes("mg/m²")?"mg/m²":M.dose.includes("mg/kg")?"mg/kg":"mg",indication:s?.indication})})]})]})]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ie,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-500",children:"Select a regimen from the list to view details and perform dose calculations."})]})})})]})]})};export{Ze as default};
//# sourceMappingURL=Regimens-C-8lbZG4.js.map
