import{r as N,j as e}from"./index-8LC8IQKY.js";import{L as ne}from"./index-DzqAJQtC.js";import{a as F,b as me,s as V}from"./App-oj_FpO4B.js";import{C as u}from"./Card-D3HCI77k.js";import{T as A}from"./Tooltip-CCp_Mki3.js";import{C as ye}from"./ComprehensivePatientForm-cBX_6vHm.js";import{U as Q}from"./user-Dpecevp5.js";import{S as je}from"./star-BHZprFQJ.js";import{S as ae}from"./search-Cd1nfMpK.js";import{I as L}from"./info-BEmptaGI.js";import{P as H}from"./plus-BSkQUrbd.js";import{R as fe}from"./refresh-cw-COcu3qHG.js";import{C as _}from"./clock-cnhIl4So.js";import{T as U}from"./trash-2-mKsraGkV.js";import{A as ee}from"./Alert-BZt2G7Co.js";import{L as be}from"./LoadingSpinner-Dl5grMUf.js";import{P as J}from"./pill-BTwo5XMb.js";import{F as ie}from"./funnel-BoLak_RK.js";import{C as K}from"./circle-check-big-CYsdojUB.js";import{S as Z}from"./square-pen-5H-W882X.js";import{D as X}from"./dna-CkqnhaTf.js";import{H as Y}from"./history-VFipUyHR.js";import{A as W}from"./activity-BXSagPiR.js";import{T as se}from"./target-BsLO2_W8.js";import{c as Ne}from"./createLucideIcon-DlukwGQd.js";import{Z as ve}from"./zap-BTYUmM9b.js";import{T as xe}from"./trending-down-DFu57dNF.js";import{M as he}from"./minus-BagaLUr9.js";import{T as B}from"./trending-up-B8-67GCO.js";import{C as le}from"./chart-column-Cpp69poi.js";import{H as we}from"./heart-i3E_mUuI.js";import{D as q}from"./download-p-Tta4FD.js";import{S as Se}from"./settings-BOlIvdsj.js";import{S as pe}from"./shield-BY4b8Nc2.js";import{S as Ce}from"./share-2-DeKRIIxO.js";import{F as te}from"./file-text-CyEOTfEa.js";import{C as De}from"./copy-BssB0KcP.js";import{P as Te}from"./printer-6R3rHSzR.js";import{M as ue}from"./mail-CBMmcK37.js";import{u as ge}from"./index-DcGTfjVj.js";import{C as Ae}from"./calendar-B3krNJ8E.js";import{B as ke}from"./bell-8nCoQylQ.js";import{T as ce}from"./triangle-alert-BOEc2-VO.js";import{E as Pe}from"./eye-DBjH61aH.js";import{T as re}from"./test-tube-Hkyfs53W.js";import{P as oe}from"./phone-BDjQDKh0.js";import{M as Oe}from"./map-pin-DAr6LCg8.js";import{S as $e}from"./stethoscope-t2AjCGlG.js";import{S as Re}from"./sparkles-wulzOQXE.js";import{B as Me}from"./brain-CKq3hGqe.js";import{A as z}from"./arrow-right-BxCayUM4.js";import{M as Ie}from"./message-square-DnSrRja7.js";import{S as Ee}from"./smartphone-erm8VJd_.js";import{C as Le}from"./calculator-CIMTtdvV.js";import{U as de}from"./users-CyD4O_24.js";import"./index-DthtDp8X.js";import"./circle-alert-DFeyOpEy.js";import"./circle-question-mark-UIDQGT3E.js";import"./x-CQXgGKGO.js";import"./house-svls-J_z.js";import"./save-CZVRNu7b.js";import"./circle-x-ejKZ_s4C.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],ze=Ne("scissors",Fe),Be=()=>{const{state:E,actions:C}=F(),{showToast:d}=me(),{currentPatient:i,recentPatients:$}=E,[y,j]=N.useState(""),[b,p]=N.useState(!1),M=async a=>{if(!a.trim())return[];try{const{data:l}=await V.auth.getSession(),t=l?.session?.access_token;if(t){const o=new URLSearchParams({q:a,page:"1",pageSize:"10"}),w=await fetch(`/api/patients?${o.toString()}`,{headers:{Authorization:`Bearer ${t}`}});if(w.ok){const S=await w.json();return(Array.isArray(S?.patients)?S.patients:[]).map(r=>r.data||r)}}}catch{}const s=a.toLowerCase();return $.filter(l=>`${l.demographics.firstName} ${l.demographics.lastName}`.toLowerCase().includes(s)||(l.demographics.mrn||"").toLowerCase().includes(s))},[T,h]=N.useState([]),[n,x]=N.useState(!1),[m,g]=N.useState(!1),P=async a=>{if(j(a),a.trim().length===0){h([]);return}x(!0);try{const s=await M(a);h(s)}catch(s){console.error("Search failed:",s)}finally{x(!1)}},c=a=>{C.setCurrentPatient(a),j(""),h([]),g(!1)},v=()=>{y.trim()===""&&(g(!0),h($))},k=()=>{setTimeout(()=>{g(!1),y.trim()===""&&h([])},200)},I=async a=>{try{const s={firstName:a.firstName||"Unknown",lastName:a.lastName||"Patient",dateOfBirth:a.dateOfBirth||"1980-01-01",sex:a.sex||"unknown",mrn:a.mrn||`MRN${Date.now()}`,heightCm:a.heightCm||170,weightKg:a.weightKg||70};let l="guest";try{const{data:o}=await V.auth.getSession();l=o?.session?.user?.id||l}catch(o){console.warn("Auth session check failed:",o)}const t={id:crypto.randomUUID(),demographics:s,allergies:a.allergies||[],medications:[],conditions:a.medicalConditions||[],labValues:a.labValues?[a.labValues]:[],genetics:[],vitals:a.vitals?[a.vitals]:[],treatmentHistory:[],notes:[],preferences:{},lastUpdated:new Date().toISOString(),createdBy:l,isActive:!0};C.setCurrentPatient(t);try{let o=null;try{const{data:D}=await V.auth.getSession();o=D?.session?.access_token,console.log("🔐 Auth token:",o?"Found":"Not found")}catch(D){console.warn("⚠️ Auth failed, proceeding without token:",D)}const w={"Content-Type":"application/json"};o&&(w.Authorization=`Bearer ${o}`),console.log("📡 Making API call to /api/patients with headers:",w),console.log("📋 Patient data:",JSON.stringify({patient:t}));const S=await fetch("/api/patients",{method:"POST",headers:w,body:JSON.stringify({patient:t})});if(console.log("📨 API Response status:",S.status),console.log("📨 API Response headers:",Object.fromEntries(S.headers.entries())),S.ok){const D=await S.json();if(console.log("✅ Patient created successfully in database:",D),d("success","Patient created and saved to database"),D.patient){const r=D.patient.data||D.patient;C.setCurrentPatient(r);try{await C.syncFromServer()}catch{}}}else{const D=await S.text().catch(()=>"Unknown error");console.error("❌ Server patient creation failed:",S.status,D),console.error("❌ Response body:",D),d("error",`Patient creation failed: ${S.status} ${D}`);try{await C.syncFromServer()}catch{}}}catch(o){console.error("Network error creating patient:",o),d("warning","Patient saved locally (network error)")}p(!1)}catch(s){console.error("Failed to create patient:",s),d("error","Failed to create patient")}},R=a=>{const s=new Date,l=new Date(a);let t=s.getFullYear()-l.getFullYear();const o=s.getMonth()-l.getMonth();return(o<0||o===0&&s.getDate()<l.getDate())&&t--,t};return e.jsxs("div",{className:"space-y-6",children:[i&&e.jsx(u,{className:"bg-primary-50 border-primary-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx(Q,{className:"w-6 h-6 text-primary-600"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-primary-900",children:[i.demographics.firstName," ",i.demographics.lastName]}),e.jsxs("div",{className:"flex items-center space-x-3 text-sm text-primary-700",children:[e.jsxs("span",{children:[R(i.demographics.dateOfBirth)," years old"]}),e.jsx("span",{className:"capitalize",children:i.demographics.sex}),i.demographics.mrn&&e.jsxs("span",{children:["MRN: ",i.demographics.mrn]})]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(A,{content:"Currently selected patient",children:e.jsx(je,{className:"w-5 h-5 text-primary-600 fill-current"})})})]})}),e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(ae,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Patient Search"}),e.jsx(A,{content:"Search for existing patients by name or MRN, or create a new patient profile. Focus on the search field to see all available patients.",type:"help",position:"bottom",children:e.jsx(L,{className:"w-4 h-4 text-gray-400 hover:text-blue-600 cursor-help transition-colors"})})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:y,onChange:a=>P(a.target.value),onFocus:v,onBlur:k,placeholder:"Search by patient name or MRN...",className:"block w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),n&&e.jsx("div",{className:"absolute right-3 top-2.5",children:e.jsx("div",{className:"w-4 h-4 border-2 border-primary-600 border-t-transparent rounded-full animate-spin"})})]}),e.jsx(A,{content:"Create a new patient profile with comprehensive clinical information",position:"bottom",children:e.jsxs("button",{onClick:()=>p(!0),className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white text-sm font-medium rounded-md hover:bg-primary-700",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{children:"New Patient"})]})}),e.jsx(A,{content:"Sync patients from server",position:"bottom",children:e.jsxs("button",{onClick:()=>C.syncFromServer(),className:"flex items-center space-x-2 px-3 py-2 bg-white border text-sm font-medium rounded-md hover:bg-gray-50",children:[e.jsx(fe,{className:"w-4 h-4"}),e.jsx("span",{children:"Sync"})]})})]}),T.length>0&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:m?"Available Patients:":"Search Results:"}),T.map(a=>e.jsx("div",{onClick:()=>c(a),className:"p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[a.demographics.firstName," ",a.demographics.lastName]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[R(a.demographics.dateOfBirth)," years • ",a.demographics.sex," • MRN: ",a.demographics.mrn]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date(a.lastUpdated).toLocaleDateString()]})]})},a.id))]}),y.length>=1&&T.length===0&&!n&&e.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:['No patients found matching "',y,'"']})]}),$.length>0&&e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(_,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Patients"}),e.jsx(A,{content:"Recently accessed patient profiles for quick selection",children:e.jsx(L,{className:"w-4 h-4 text-gray-400"})})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:$.slice(0,6).map(a=>e.jsx("div",{onClick:()=>c(a),className:`p-3 border rounded-lg cursor-pointer transition-colors ${i?.id===a.id?"border-primary-300 bg-primary-50":"border-gray-200 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(Q,{className:"w-4 h-4 text-gray-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"font-medium text-gray-900 truncate",children:[a.demographics.firstName," ",a.demographics.lastName]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[R(a.demographics.dateOfBirth)," years • MRN: ",a.demographics.mrn]})]}),e.jsx("button",{className:"p-1 text-gray-400 hover:text-red-600",onClick:async s=>{if(s.stopPropagation(),!confirm("Delete this patient?"))return;const l=a;C.removePatient(a.id),d("success","Patient deleted",5e3,{label:"Undo",onClick:async()=>{C.setCurrentPatient(l);try{const{data:t}=await V.auth.getSession(),o=t?.session?.access_token;o&&await fetch("/api/patients",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({patient:l})})}catch{}}})},title:"Delete patient",children:e.jsx(U,{className:"w-4 h-4"})})]})},a.id))})]}),b&&e.jsx(ye,{onSubmit:I,onCancel:()=>p(!1)})]})},Ue=({patientId:E})=>{const{state:C,actions:d}=F(),{currentPatient:i}=C,[$,y]=N.useState(!1),[j,b]=N.useState(null),[p,M]=N.useState("all"),[T,h]=N.useState(""),[n,x]=N.useState({drugName:"",dosage:"",frequency:"",route:"Oral",startDate:new Date().toISOString().split("T")[0],indication:"",prescribedBy:"",isActive:!0,adherence:"good"});if(!i)return e.jsx(u,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(J,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Patient Selected"}),e.jsx("p",{className:"text-gray-400",children:"Select a patient to manage their medications"})]})});const m=()=>{let a=i.medications||[];return p==="active"?a=a.filter(s=>s.isActive):p==="inactive"&&(a=a.filter(s=>!s.isActive)),T.trim()&&(a=a.filter(s=>s.drugName?.toLowerCase().includes(T.toLowerCase())||s.indication?.toLowerCase().includes(T.toLowerCase())||s.prescribedBy?.toLowerCase().includes(T.toLowerCase()))),a},g=()=>{if(!n.drugName||!n.dosage||!n.frequency){alert("Please fill in all required fields");return}const a={id:`med-${Date.now()}`,drugName:n.drugName,dosage:n.dosage,frequency:n.frequency,route:n.route||"Oral",startDate:n.startDate||new Date().toISOString().split("T")[0],endDate:n.endDate,indication:n.indication||"",prescribedBy:n.prescribedBy||"",isActive:n.isActive!==!1,adherence:n.adherence||"good",sideEffects:n.sideEffects||[]},s=[...i.medications||[],a];d.updatePatientData({medications:s}),x({drugName:"",dosage:"",frequency:"",route:"Oral",startDate:new Date().toISOString().split("T")[0],indication:"",prescribedBy:"",isActive:!0,adherence:"good"}),y(!1)},P=a=>{b(a),x(a),y(!0)},c=()=>{if(!j||!n.drugName||!n.dosage||!n.frequency){alert("Please fill in all required fields");return}const a=i.medications.map(s=>s.id===j.id?{...n,id:j.id}:s);d.updatePatientData({medications:a}),x({drugName:"",dosage:"",frequency:"",route:"Oral",startDate:new Date().toISOString().split("T")[0],indication:"",prescribedBy:"",isActive:!0,adherence:"good"}),b(null),y(!1)},v=a=>{if(confirm("Are you sure you want to remove this medication?")){const s=i.medications.filter(l=>l.id!==a);d.updatePatientData({medications:s})}},k=a=>{const s=i.medications.map(l=>l.id===a?{...l,isActive:!l.isActive,endDate:l.isActive?new Date().toISOString().split("T")[0]:void 0}:l);d.updatePatientData({medications:s})},I=a=>{switch(a){case"excellent":return"bg-green-100 text-green-800";case"good":return"bg-blue-100 text-blue-800";case"fair":return"bg-yellow-100 text-yellow-800";case"poor":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},R=m();return e.jsxs("div",{className:"space-y-6",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(J,{className:"w-6 h-6 text-primary-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Medication Management"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[i.demographics.firstName," ",i.demographics.lastName," - Current medications and history"]})]})]}),e.jsxs("button",{onClick:()=>y(!0),className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Medication"})]})]})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"w-4 h-4 text-gray-400"}),e.jsxs("select",{value:p,onChange:a=>M(a.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"all",children:"All Medications"}),e.jsx("option",{value:"active",children:"Active Only"}),e.jsx("option",{value:"inactive",children:"Inactive Only"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search medications...",value:T,onChange:a=>h(a.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[R.length," medication",R.length!==1?"s":""," found"]})]})}),e.jsx("div",{className:"space-y-4",children:R.length===0?e.jsx(u,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(J,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Medications Found"}),e.jsx("p",{className:"text-gray-400",children:T||p!=="all"?"Try adjusting your search or filter criteria":"Add the first medication to get started"})]})}):R.map(a=>e.jsx(u,{className:`${a.isActive?"":"bg-gray-50 border-gray-200"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.drugName}),e.jsxs("div",{className:"flex items-center space-x-2",children:[a.isActive?e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(K,{className:"w-3 h-3 mr-1"}),"Active"]}):e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[e.jsx(_,{className:"w-3 h-3 mr-1"}),"Inactive"]}),a.adherence&&e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${I(a.adherence)}`,children:[a.adherence," adherence"]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Dosage & Frequency:"}),e.jsxs("p",{className:"text-gray-900",children:[a.dosage," ",a.frequency]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Route:"}),e.jsx("p",{className:"text-gray-900",children:a.route})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Start Date:"}),e.jsx("p",{className:"text-gray-900",children:new Date(a.startDate).toLocaleDateString()})]})]}),a.indication&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Indication:"}),e.jsx("p",{className:"text-gray-900",children:a.indication})]}),a.prescribedBy&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Prescribed by:"}),e.jsx("p",{className:"text-gray-900",children:a.prescribedBy})]}),a.endDate&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"End Date:"}),e.jsx("p",{className:"text-gray-900",children:new Date(a.endDate).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(A,{content:a.isActive?"Mark as inactive":"Mark as active",children:e.jsx("button",{onClick:()=>k(a.id),className:`p-2 rounded-lg ${a.isActive?"text-green-600 hover:bg-green-50":"text-gray-400 hover:bg-gray-50"}`,children:a.isActive?e.jsx(K,{className:"w-4 h-4"}):e.jsx(_,{className:"w-4 h-4"})})}),e.jsx(A,{content:"Edit medication",children:e.jsx("button",{onClick:()=>P(a),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",children:e.jsx(Z,{className:"w-4 h-4"})})}),e.jsx(A,{content:"Remove medication",children:e.jsx("button",{onClick:()=>v(a.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:e.jsx(U,{className:"w-4 h-4"})})})]})]})},a.id))}),$&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:j?"Edit Medication":"Add New Medication"})}),e.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto max-h-[60vh]",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Drug Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:n.drugName||"",onChange:a=>x({...n,drugName:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Tamoxifen"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Dosage ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:n.dosage||"",onChange:a=>x({...n,dosage:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., 20 mg"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Frequency ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:n.frequency||"",onChange:a=>x({...n,frequency:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Select frequency"}),e.jsx("option",{value:"Once daily",children:"Once daily"}),e.jsx("option",{value:"Twice daily",children:"Twice daily"}),e.jsx("option",{value:"Three times daily",children:"Three times daily"}),e.jsx("option",{value:"Four times daily",children:"Four times daily"}),e.jsx("option",{value:"Every other day",children:"Every other day"}),e.jsx("option",{value:"Weekly",children:"Weekly"}),e.jsx("option",{value:"Every 3 weeks",children:"Every 3 weeks"}),e.jsx("option",{value:"Monthly",children:"Monthly"}),e.jsx("option",{value:"As needed",children:"As needed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Route"}),e.jsxs("select",{value:n.route||"Oral",onChange:a=>x({...n,route:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"Oral",children:"Oral"}),e.jsx("option",{value:"IV",children:"Intravenous (IV)"}),e.jsx("option",{value:"IM",children:"Intramuscular (IM)"}),e.jsx("option",{value:"SC",children:"Subcutaneous (SC)"}),e.jsx("option",{value:"Topical",children:"Topical"}),e.jsx("option",{value:"Inhalation",children:"Inhalation"}),e.jsx("option",{value:"Other",children:"Other"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:n.startDate||"",onChange:a=>x({...n,startDate:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:n.endDate||"",onChange:a=>x({...n,endDate:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Indication"}),e.jsx("input",{type:"text",value:n.indication||"",onChange:a=>x({...n,indication:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Breast cancer adjuvant therapy"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prescribed By"}),e.jsx("input",{type:"text",value:n.prescribedBy||"",onChange:a=>x({...n,prescribedBy:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Dr. Smith"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adherence"}),e.jsxs("select",{value:n.adherence||"good",onChange:a=>x({...n,adherence:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"excellent",children:"Excellent"}),e.jsx("option",{value:"good",children:"Good"}),e.jsx("option",{value:"fair",children:"Fair"}),e.jsx("option",{value:"poor",children:"Poor"})]})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:n.isActive!==!1,onChange:a=>x({...n,isActive:a.target.checked}),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Active medication"})]})})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-between",children:[e.jsx("button",{onClick:()=>{y(!1),b(null),x({drugName:"",dosage:"",frequency:"",route:"Oral",startDate:new Date().toISOString().split("T")[0],indication:"",prescribedBy:"",isActive:!0,adherence:"good"})},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:j?c:g,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:j?"Update Medication":"Add Medication"})]})]})})]})},Ge=({patientId:E})=>{const{state:C,actions:d}=F(),{currentPatient:i}=C,[$,y]=N.useState(!1),[j,b]=N.useState(null),[p,M]=N.useState(""),[T,h]=N.useState("all"),[n,x]=N.useState({geneSymbol:"",alleles:["",""],phenotype:"",metabolizerStatus:"normal",testDate:new Date().toISOString().split("T")[0],testMethod:"",clinicalSignificance:"",notes:""});if(!i)return e.jsx(u,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(X,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Patient Selected"}),e.jsx("p",{className:"text-gray-400",children:"Select a patient to manage their genomic data"})]})});const m=()=>{let s=i.genetics||[];const l=["CYP2D6","CYP2C19","CYP2C9","CYP3A4","TPMT","UGT1A1","DPYD","NUDT15"];return T==="pharmacogenomic"?s=s.filter(t=>l.includes(t.geneSymbol.toUpperCase())):T==="oncologic"&&(s=s.filter(t=>!l.includes(t.geneSymbol.toUpperCase()))),p.trim()&&(s=s.filter(t=>t.geneSymbol.toLowerCase().includes(p.toLowerCase())||t.phenotype.toLowerCase().includes(p.toLowerCase())||t.clinicalSignificance?.toLowerCase().includes(p.toLowerCase()))),s},g=()=>{if(!n.geneSymbol||!n.phenotype){alert("Please fill in gene symbol and phenotype");return}const s={geneSymbol:n.geneSymbol,alleles:n.alleles.filter(t=>t.trim()!==""),phenotype:n.phenotype,metabolizerStatus:n.metabolizerStatus,testDate:n.testDate||new Date().toISOString().split("T")[0],testMethod:n.testMethod,clinicalSignificance:n.clinicalSignificance,notes:n.notes},l=[...i.genetics||[],s];d.updatePatientData({genetics:l}),x({geneSymbol:"",alleles:["",""],phenotype:"",metabolizerStatus:"normal",testDate:new Date().toISOString().split("T")[0],testMethod:"",clinicalSignificance:"",notes:""}),y(!1)},P=s=>{b(s),x({...s,alleles:s.alleles.length<2?[...s.alleles,"",""]:s.alleles}),y(!0)},c=()=>{if(!j||!n.geneSymbol||!n.phenotype){alert("Please fill in gene symbol and phenotype");return}const s=i.genetics.map(l=>l.geneSymbol===j.geneSymbol&&l.testDate===j.testDate?{...n,geneSymbol:n.geneSymbol,alleles:n.alleles.filter(t=>t.trim()!==""),phenotype:n.phenotype}:l);d.updatePatientData({genetics:s}),x({geneSymbol:"",alleles:["",""],phenotype:"",metabolizerStatus:"normal",testDate:new Date().toISOString().split("T")[0],testMethod:"",clinicalSignificance:"",notes:""}),b(null),y(!1)},v=s=>{if(confirm("Are you sure you want to remove this genetic data?")){const l=i.genetics.filter(t=>!(t.geneSymbol===s.geneSymbol&&t.testDate===s.testDate));d.updatePatientData({genetics:l})}},k=s=>{switch(s){case"poor":return"bg-red-100 text-red-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"normal":return"bg-green-100 text-green-800";case"rapid":return"bg-blue-100 text-blue-800";case"ultra-rapid":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},I=s=>{if(!s)return"bg-gray-100 text-gray-800";const l=s.toLowerCase();return l.includes("high")||l.includes("pathogenic")?"bg-red-100 text-red-800":l.includes("moderate")||l.includes("likely")?"bg-yellow-100 text-yellow-800":l.includes("low")||l.includes("benign")?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"},R=()=>[{gene:"CYP2D6",description:"Metabolizes many antidepressants, antipsychotics, and opioids"},{gene:"CYP2C19",description:"Metabolizes proton pump inhibitors, clopidogrel, and some antidepressants"},{gene:"CYP2C9",description:"Metabolizes warfarin, phenytoin, and NSAIDs"},{gene:"CYP3A4",description:"Metabolizes many medications including some chemotherapy drugs"},{gene:"TPMT",description:"Metabolizes thiopurine drugs (azathioprine, mercaptopurine)"},{gene:"UGT1A1",description:"Metabolizes irinotecan and affects bilirubin levels"},{gene:"DPYD",description:"Metabolizes fluoropyrimidines (5-FU, capecitabine)"},{gene:"NUDT15",description:"Affects thiopurine metabolism, important in Asian populations"}],a=m();return e.jsxs("div",{className:"space-y-6",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(X,{className:"w-6 h-6 text-primary-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Genomic Profile"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[i.demographics.firstName," ",i.demographics.lastName," - Genetic testing results and pharmacogenomics"]})]})]}),e.jsxs("button",{onClick:()=>y(!0),className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Genetic Data"})]})]})}),a.some(s=>s.metabolizerStatus==="poor"||s.metabolizerStatus==="ultra-rapid")&&e.jsx(ee,{type:"warning",title:"Pharmacogenomic Considerations",children:e.jsx("p",{className:"text-sm",children:"This patient has genetic variants that may affect drug metabolism. Review medication dosing and selection based on pharmacogenomic guidance."})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"w-4 h-4 text-gray-400"}),e.jsxs("select",{value:T,onChange:s=>h(s.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"all",children:"All Genetic Data"}),e.jsx("option",{value:"pharmacogenomic",children:"Pharmacogenomic"}),e.jsx("option",{value:"oncologic",children:"Oncologic"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search genes...",value:p,onChange:s=>M(s.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[a.length," result",a.length!==1?"s":""," found"]})]})}),e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(L,{className:"w-5 h-5 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Common Pharmacogenes"}),e.jsx(A,{content:"These genes are commonly tested for drug metabolism and dosing guidance",children:e.jsx(L,{className:"w-4 h-4 text-gray-400"})})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-3",children:R().map(({gene:s,description:l})=>{const t=a.some(o=>o.geneSymbol.toUpperCase()===s);return e.jsxs("div",{className:`p-3 rounded-lg border ${t?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s}),t&&e.jsx(K,{className:"w-4 h-4 text-green-600"})]}),e.jsx("p",{className:"text-xs text-gray-600",children:l})]},s)})})]}),e.jsx("div",{className:"space-y-4",children:a.length===0?e.jsx(u,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(X,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Genetic Data Found"}),e.jsx("p",{className:"text-gray-400",children:p||T!=="all"?"Try adjusting your search or filter criteria":"Add genetic testing results to enable pharmacogenomic guidance"})]})}):a.map((s,l)=>e.jsx(u,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.geneSymbol}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.metabolizerStatus&&e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${k(s.metabolizerStatus)}`,children:[s.metabolizerStatus," metabolizer"]}),s.clinicalSignificance&&e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${I(s.clinicalSignificance)}`,children:s.clinicalSignificance})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Alleles:"}),e.jsx("p",{className:"text-gray-900",children:s.alleles.join(" / ")||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Phenotype:"}),e.jsx("p",{className:"text-gray-900",children:s.phenotype})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Test Date:"}),e.jsx("p",{className:"text-gray-900",children:new Date(s.testDate).toLocaleDateString()})]})]}),s.testMethod&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Test Method:"}),e.jsx("p",{className:"text-gray-900",children:s.testMethod})]}),s.geneFunction&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Gene Function:"}),e.jsx("p",{className:"text-gray-900",children:s.geneFunction})]}),s.notes&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Notes:"}),e.jsx("p",{className:"text-gray-900",children:s.notes})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(A,{content:"Edit genetic data",children:e.jsx("button",{onClick:()=>P(s),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",children:e.jsx(Z,{className:"w-4 h-4"})})}),e.jsx(A,{content:"Remove genetic data",children:e.jsx("button",{onClick:()=>v(s),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:e.jsx(U,{className:"w-4 h-4"})})})]})]})},`${s.geneSymbol}-${s.testDate}-${l}`))}),$&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:j?"Edit Genetic Data":"Add Genetic Data"})}),e.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto max-h-[60vh]",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Gene Symbol ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:n.geneSymbol||"",onChange:s=>x({...n,geneSymbol:s.target.value.toUpperCase()}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., CYP2D6"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Phenotype ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:n.phenotype||"",onChange:s=>x({...n,phenotype:s.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Intermediate Metabolizer"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Allele 1"}),e.jsx("input",{type:"text",value:n.alleles&&n.alleles[0]||"",onChange:s=>{const l=[...n.alleles||["",""]];l[0]=s.target.value,x({...n,alleles:l})},className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., *1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Allele 2"}),e.jsx("input",{type:"text",value:n.alleles&&n.alleles[1]||"",onChange:s=>{const l=[...n.alleles||["",""]];l[1]=s.target.value,x({...n,alleles:l})},className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., *4"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Metabolizer Status"}),e.jsxs("select",{value:n.metabolizerStatus||"normal",onChange:s=>x({...n,metabolizerStatus:s.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"poor",children:"Poor Metabolizer"}),e.jsx("option",{value:"intermediate",children:"Intermediate Metabolizer"}),e.jsx("option",{value:"normal",children:"Normal Metabolizer"}),e.jsx("option",{value:"rapid",children:"Rapid Metabolizer"}),e.jsx("option",{value:"ultra-rapid",children:"Ultra-Rapid Metabolizer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Date"}),e.jsx("input",{type:"date",value:n.testDate||"",onChange:s=>x({...n,testDate:s.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Method"}),e.jsx("input",{type:"text",value:n.testMethod||"",onChange:s=>x({...n,testMethod:s.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., PCR-RFLP, Sequencing, Array"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clinical Significance"}),e.jsx("input",{type:"text",value:n.clinicalSignificance||"",onChange:s=>x({...n,clinicalSignificance:s.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Reduced enzyme activity"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:n.notes||"",onChange:s=>x({...n,notes:s.target.value}),rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Additional clinical notes..."})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-between",children:[e.jsx("button",{onClick:()=>{y(!1),b(null),x({geneSymbol:"",alleles:["",""],phenotype:"",metabolizerStatus:"normal",testDate:new Date().toISOString().split("T")[0],testMethod:"",clinicalSignificance:"",notes:""})},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:j?c:g,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:j?"Update Genetic Data":"Add Genetic Data"})]})]})})]})},qe=({patientId:E})=>{const{state:C,actions:d}=F(),{currentPatient:i}=C,[$,y]=N.useState(!1),[j,b]=N.useState(null),[p,M]=N.useState(""),[T,h]=N.useState("all"),[n,x]=N.useState("all"),[m,g]=N.useState({treatmentType:"chemotherapy",regimen:"",drugs:[],startDate:new Date().toISOString().split("T")[0],endDate:"",cycles:1,response:"stable",toxicities:[],notes:""}),[P,c]=N.useState({grade:1,description:"",action:""});if(!i)return e.jsx(u,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Y,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Patient Selected"}),e.jsx("p",{className:"text-gray-400",children:"Select a patient to view their treatment history"})]})});const v=()=>{let r=i.treatmentHistory||[];return T==="active"?r=r.filter(f=>!f.endDate):T==="completed"&&(r=r.filter(f=>f.endDate)),n!=="all"&&(r=r.filter(f=>f.treatmentType===n)),p.trim()&&(r=r.filter(f=>f.regimen?.toLowerCase().includes(p.toLowerCase())||f.drugs?.some(O=>O.toLowerCase().includes(p.toLowerCase()))||f.notes?.toLowerCase().includes(p.toLowerCase()))),r.sort((f,O)=>new Date(O.startDate).getTime()-new Date(f.startDate).getTime())},k=N.useMemo(()=>(i.treatmentHistory||[]).sort((f,O)=>new Date(f.startDate).getTime()-new Date(O.startDate).getTime()).map((f,O)=>({...f,order:O+1})),[i.treatmentHistory]),I=()=>{if(!m.treatmentType||!m.startDate){alert("Please fill in treatment type and start date");return}const r={id:`treatment-${Date.now()}`,treatmentType:m.treatmentType,regimen:m.regimen||"",drugs:m.drugs||[],startDate:m.startDate,endDate:m.endDate,cycles:m.cycles,response:m.response,toxicities:m.toxicities||[],notes:m.notes},f=[...i.treatmentHistory||[],r];d.updatePatientData({treatmentHistory:f}),g({treatmentType:"chemotherapy",regimen:"",drugs:[],startDate:new Date().toISOString().split("T")[0],endDate:"",cycles:1,response:"stable",toxicities:[],notes:""}),y(!1)},R=r=>{b(r),g(r),y(!0)},a=()=>{if(!j||!m.treatmentType||!m.startDate){alert("Please fill in treatment type and start date");return}const r=i.treatmentHistory.map(f=>f.id===j.id?{...m,id:j.id}:f);d.updatePatientData({treatmentHistory:r}),g({treatmentType:"chemotherapy",regimen:"",drugs:[],startDate:new Date().toISOString().split("T")[0],endDate:"",cycles:1,response:"stable",toxicities:[],notes:""}),b(null),y(!1)},s=r=>{if(confirm("Are you sure you want to remove this treatment?")){const f=i.treatmentHistory.filter(O=>O.id!==r);d.updatePatientData({treatmentHistory:f})}},l=r=>{switch(r){case"complete":return"bg-green-100 text-green-800";case"partial":return"bg-blue-100 text-blue-800";case"stable":return"bg-yellow-100 text-yellow-800";case"progression":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},t=r=>{switch(r){case"complete":return e.jsx(K,{className:"w-4 h-4"});case"partial":return e.jsx(B,{className:"w-4 h-4"});case"stable":return e.jsx(he,{className:"w-4 h-4"});case"progression":return e.jsx(xe,{className:"w-4 h-4"});default:return e.jsx(_,{className:"w-4 h-4"})}},o=r=>{switch(r){case"chemotherapy":return e.jsx(ve,{className:"w-5 h-5"});case"radiation":return e.jsx(se,{className:"w-5 h-5"});case"surgery":return e.jsx(ze,{className:"w-5 h-5"});case"immunotherapy":return e.jsx(W,{className:"w-5 h-5"});case"targeted":return e.jsx(se,{className:"w-5 h-5"});default:return e.jsx(Y,{className:"w-5 h-5"})}},w=r=>{switch(r){case 1:return"bg-green-100 text-green-800";case 2:return"bg-yellow-100 text-yellow-800";case 3:return"bg-orange-100 text-orange-800";case 4:return"bg-red-100 text-red-800";case 5:return"bg-red-200 text-red-900";default:return"bg-gray-100 text-gray-800"}},S=()=>{P.description&&P.action&&(g({...m,toxicities:[...m.toxicities||[],{...P,grade:P.grade}]}),c({grade:1,description:"",action:""}))},D=v();return e.jsxs("div",{className:"space-y-6",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Y,{className:"w-6 h-6 text-primary-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Treatment History"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[i.demographics.firstName," ",i.demographics.lastName," - Complete treatment timeline and outcomes"]})]})]}),e.jsxs("button",{onClick:()=>y(!0),className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Treatment"})]})]})}),k.length>0&&e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(W,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Treatment Summary"}),e.jsx(A,{content:"Overview of all treatments and their outcomes",children:e.jsx(L,{className:"w-4 h-4 text-gray-400"})})]}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Total Treatments"}),e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:k.length})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Complete/Partial Response"}),e.jsx("div",{className:"text-2xl font-bold text-green-900",children:k.filter(r=>r.response==="complete"||r.response==="partial").length})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-yellow-600 font-medium",children:"Active Treatments"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-900",children:k.filter(r=>!r.endDate).length})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-red-600 font-medium",children:"Grade 3+ Toxicities"}),e.jsx("div",{className:"text-2xl font-bold text-red-900",children:k.reduce((r,f)=>r+(f.toxicities?.filter(O=>O.grade>=3).length||0),0)})]})]})]}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"w-4 h-4 text-gray-400"}),e.jsxs("select",{value:T,onChange:r=>h(r.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"all",children:"All Treatments"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("select",{value:n,onChange:r=>x(r.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"chemotherapy",children:"Chemotherapy"}),e.jsx("option",{value:"radiation",children:"Radiation"}),e.jsx("option",{value:"surgery",children:"Surgery"}),e.jsx("option",{value:"immunotherapy",children:"Immunotherapy"}),e.jsx("option",{value:"targeted",children:"Targeted"}),e.jsx("option",{value:"other",children:"Other"})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search treatments...",value:p,onChange:r=>M(r.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[D.length," treatment",D.length!==1?"s":""," found"]})]})}),e.jsx("div",{className:"space-y-4",children:D.length===0?e.jsx(u,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Y,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Treatments Found"}),e.jsx("p",{className:"text-gray-400",children:p||T!=="all"||n!=="all"?"Try adjusting your search or filter criteria":"Add the first treatment to start building the treatment history"})]})}):D.map((r,f)=>e.jsxs(u,{className:"relative",children:[f<D.length-1&&e.jsx("div",{className:"absolute left-8 top-16 w-0.5 h-full bg-gray-200 -z-10"}),e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center ${r.endDate?"bg-gray-100 text-gray-600":"bg-primary-100 text-primary-600"}`,children:o(r.treatmentType)}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 capitalize",children:[r.treatmentType," ",r.regimen&&`- ${r.regimen}`]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[!r.endDate&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(_,{className:"w-3 h-3 mr-1"}),"Active"]}),r.response&&e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${l(r.response)}`,children:[t(r.response),e.jsxs("span",{className:"ml-1 capitalize",children:[r.response," response"]})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Start Date:"}),e.jsx("p",{className:"text-gray-900",children:new Date(r.startDate).toLocaleDateString()})]}),r.endDate&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"End Date:"}),e.jsx("p",{className:"text-gray-900",children:new Date(r.endDate).toLocaleDateString()})]}),r.cycles&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Cycles:"}),e.jsx("p",{className:"text-gray-900",children:r.cycles})]})]}),r.drugs&&r.drugs.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"font-medium text-gray-700 text-sm",children:"Drugs:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:r.drugs.map((O,G)=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-50 text-blue-800",children:O},G))})]}),r.toxicities&&r.toxicities.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"font-medium text-gray-700 text-sm",children:"Toxicities:"}),e.jsx("div",{className:"space-y-1 mt-1",children:r.toxicities.map((O,G)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${w(O.grade)}`,children:["Grade ",O.grade]}),e.jsx("span",{className:"text-sm text-gray-900",children:O.description}),e.jsxs("span",{className:"text-xs text-gray-600",children:["(",O.action,")"]})]},G))})]}),r.notes&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Notes:"}),e.jsx("p",{className:"text-gray-900 mt-1",children:r.notes})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(A,{content:"Edit treatment",children:e.jsx("button",{onClick:()=>R(r),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",children:e.jsx(Z,{className:"w-4 h-4"})})}),e.jsx(A,{content:"Remove treatment",children:e.jsx("button",{onClick:()=>s(r.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:e.jsx(U,{className:"w-4 h-4"})})})]})]})})]})]},r.id))}),$&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:j?"Edit Treatment":"Add Treatment"})}),e.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto max-h-[70vh]",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Treatment Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:m.treatmentType||"chemotherapy",onChange:r=>g({...m,treatmentType:r.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"chemotherapy",children:"Chemotherapy"}),e.jsx("option",{value:"radiation",children:"Radiation"}),e.jsx("option",{value:"surgery",children:"Surgery"}),e.jsx("option",{value:"immunotherapy",children:"Immunotherapy"}),e.jsx("option",{value:"targeted",children:"Targeted Therapy"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Regimen/Protocol"}),e.jsx("input",{type:"text",value:m.regimen||"",onChange:r=>g({...m,regimen:r.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., FOLFOX, AC-T"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Drugs (comma-separated)"}),e.jsx("input",{type:"text",value:m.drugs?.join(", ")||"",onChange:r=>g({...m,drugs:r.target.value.split(",").map(f=>f.trim()).filter(f=>f)}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Doxorubicin, Cyclophosphamide"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Start Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:m.startDate||"",onChange:r=>g({...m,startDate:r.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:m.endDate||"",onChange:r=>g({...m,endDate:r.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cycles"}),e.jsx("input",{type:"number",value:m.cycles||"",onChange:r=>g({...m,cycles:r.target.value?parseInt(r.target.value):void 0}),min:"1",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Response"}),e.jsxs("select",{value:m.response||"stable",onChange:r=>g({...m,response:r.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"complete",children:"Complete Response"}),e.jsx("option",{value:"partial",children:"Partial Response"}),e.jsx("option",{value:"stable",children:"Stable Disease"}),e.jsx("option",{value:"progression",children:"Disease Progression"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Toxicities"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[e.jsx("div",{className:"col-span-2",children:e.jsxs("select",{value:P.grade,onChange:r=>c({...P,grade:parseInt(r.target.value)}),className:"w-full border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:1,children:"Grade 1"}),e.jsx("option",{value:2,children:"Grade 2"}),e.jsx("option",{value:3,children:"Grade 3"}),e.jsx("option",{value:4,children:"Grade 4"}),e.jsx("option",{value:5,children:"Grade 5"})]})}),e.jsx("div",{className:"col-span-5",children:e.jsx("input",{type:"text",placeholder:"Toxicity description",value:P.description,onChange:r=>c({...P,description:r.target.value}),className:"w-full border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})}),e.jsx("div",{className:"col-span-4",children:e.jsx("input",{type:"text",placeholder:"Action taken",value:P.action,onChange:r=>c({...P,action:r.target.value}),className:"w-full border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("button",{type:"button",onClick:S,className:"w-full h-8 bg-primary-600 text-white rounded-md hover:bg-primary-700 text-sm",children:"+"})})]}),m.toxicities&&m.toxicities.length>0&&e.jsx("div",{className:"space-y-1",children:m.toxicities.map((r,f)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${w(r.grade)}`,children:["Grade ",r.grade]}),e.jsx("span",{className:"text-sm",children:r.description}),e.jsxs("span",{className:"text-xs text-gray-600",children:["(",r.action,")"]})]}),e.jsx("button",{type:"button",onClick:()=>g({...m,toxicities:m.toxicities?.filter((O,G)=>G!==f)}),className:"text-red-600 hover:text-red-800",children:e.jsx(U,{className:"w-4 h-4"})})]},f))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:m.notes||"",onChange:r=>g({...m,notes:r.target.value}),rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Additional treatment notes..."})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-between",children:[e.jsx("button",{onClick:()=>{y(!1),b(null),g({treatmentType:"chemotherapy",regimen:"",drugs:[],startDate:new Date().toISOString().split("T")[0],endDate:"",cycles:1,response:"stable",toxicities:[],notes:""})},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:j?a:I,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:j?"Update Treatment":"Add Treatment"})]})]})})]})},_e=({patientId:E})=>{const{state:C,actions:d}=F(),{currentPatient:i}=C,[$,y]=N.useState(!1),[j,b]=N.useState(null),[p,M]=N.useState("all"),T=()=>{if(!i)return[];const t=i.notes?.filter(o=>o.type==="clinical"&&o.content.startsWith("OUTCOME_DATA:"));return t?t.map(o=>{try{return{...JSON.parse(o.content.replace("OUTCOME_DATA:","")),id:o.id}}catch{return null}}).filter(Boolean):[]},[h,n]=N.useState({type:"response",measurement:"",value:"",unit:"",date:new Date().toISOString().split("T")[0],notes:"",treatmentRelated:""});if(!i)return e.jsx(u,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(B,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Patient Selected"}),e.jsx("p",{className:"text-gray-400",children:"Select a patient to track their outcomes"})]})});const x=T(),m=p==="all"?x:x.filter(t=>t.type===p),g=()=>{if(!h.measurement||!h.value||!h.date){alert("Please fill in measurement, value, and date");return}const t={id:`outcome-${Date.now()}`,type:h.type,measurement:h.measurement,value:h.value,unit:h.unit,date:h.date,notes:h.notes,treatmentRelated:h.treatmentRelated},o=`OUTCOME_DATA:${JSON.stringify(t)}`,w=[...i.notes||[],{id:t.id,timestamp:new Date().toISOString(),author:"current-user",type:"clinical",content:o}];d.updatePatientData({notes:w}),n({type:"response",measurement:"",value:"",unit:"",date:new Date().toISOString().split("T")[0],notes:"",treatmentRelated:""}),y(!1)},P=t=>{b(t),n(t),y(!0)},c=()=>{if(!j||!h.measurement||!h.value||!h.date){alert("Please fill in measurement, value, and date");return}const t={...h,id:j.id},o=`OUTCOME_DATA:${JSON.stringify(t)}`,w=i.notes?.map(S=>S.id===j.id?{...S,content:o}:S)||[];d.updatePatientData({notes:w}),n({type:"response",measurement:"",value:"",unit:"",date:new Date().toISOString().split("T")[0],notes:"",treatmentRelated:""}),b(null),y(!1)},v=t=>{if(confirm("Are you sure you want to remove this outcome data?")){const o=i.notes?.filter(w=>w.id!==t)||[];d.updatePatientData({notes:o})}},k=t=>{switch(t){case"survival":return e.jsx(we,{className:"w-4 h-4"});case"response":return e.jsx(se,{className:"w-4 h-4"});case"quality_of_life":return e.jsx(W,{className:"w-4 h-4"});case"biomarker":return e.jsx(le,{className:"w-4 h-4"});case"functional_status":return e.jsx(B,{className:"w-4 h-4"});default:return e.jsx(L,{className:"w-4 h-4"})}},I=t=>{switch(t){case"survival":return"bg-red-100 text-red-800";case"response":return"bg-green-100 text-green-800";case"quality_of_life":return"bg-blue-100 text-blue-800";case"biomarker":return"bg-purple-100 text-purple-800";case"functional_status":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},R=(t,o)=>{const w=typeof t=="number"?t:parseFloat(t.toString());if(isNaN(w))return null;const S=o.toLowerCase();return S.includes("tumor")||S.includes("lesion")||S.includes("mass")?w<20?"improving":w>50?"worsening":"stable":S.includes("quality")||S.includes("karnofsky")||S.includes("ecog")?w>80?"improving":w<40?"worsening":"stable":null},a=t=>{switch(t){case"improving":return e.jsx(B,{className:"w-4 h-4 text-green-600"});case"worsening":return e.jsx(xe,{className:"w-4 h-4 text-red-600"});case"stable":return e.jsx(he,{className:"w-4 h-4 text-yellow-600"});default:return null}},s=N.useMemo(()=>{const o=x.filter(r=>r.type==="response").sort((r,f)=>new Date(f.date).getTime()-new Date(r.date).getTime())[0],w=x.filter(r=>r.type==="survival"),S=x.filter(r=>r.type==="quality_of_life"),D=x.filter(r=>r.type==="biomarker");return{totalOutcomes:x.length,latestResponse:o?.value||"Not assessed",survivalData:w.length>0,qolTracked:S.length>0,biomarkersTracked:D.length>0}},[x]),l={survival:["Overall Survival (months)","Disease-Free Survival (months)","Progression-Free Survival (months)"],response:["RECIST Response","Tumor Size (cm)","Target Lesion Sum (cm)","Response Rate (%)"],quality_of_life:["EORTC QLQ-C30 Score","Karnofsky Performance Score","ECOG Performance Status","Pain Score (0-10)"],biomarker:["PSA (ng/mL)","CA 19-9 (U/mL)","CEA (ng/mL)","CA-125 (U/mL)","AFP (ng/mL)"],functional_status:["Activities of Daily Living","Mobility Score","Cognitive Function","Social Function"]};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(B,{className:"w-6 h-6 text-primary-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Outcome Tracking"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[i.demographics.firstName," ",i.demographics.lastName," - Treatment outcomes and response monitoring"]})]})]}),e.jsxs("button",{onClick:()=>y(!0),className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Outcome"})]})]})}),e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(le,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Outcome Summary"}),e.jsx(A,{content:"Overview of tracked outcomes and current status",children:e.jsx(L,{className:"w-4 h-4 text-gray-400"})})]}),e.jsxs("div",{className:"grid md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Total Outcomes"}),e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:s.totalOutcomes})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Latest Response"}),e.jsx("div",{className:"text-lg font-bold text-green-900 truncate",children:s.latestResponse})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-red-600 font-medium",children:"Survival Data"}),e.jsx("div",{className:"text-2xl font-bold text-red-900",children:s.survivalData?"✓":"○"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"QoL Tracked"}),e.jsx("div",{className:"text-2xl font-bold text-purple-900",children:s.qolTracked?"✓":"○"})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-orange-600 font-medium",children:"Biomarkers"}),e.jsx("div",{className:"text-2xl font-bold text-orange-900",children:s.biomarkersTracked?"✓":"○"})]})]})]}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("select",{value:p,onChange:t=>M(t.target.value),className:"border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"all",children:"All Outcome Types"}),e.jsx("option",{value:"survival",children:"Survival Outcomes"}),e.jsx("option",{value:"response",children:"Response Assessment"}),e.jsx("option",{value:"quality_of_life",children:"Quality of Life"}),e.jsx("option",{value:"biomarker",children:"Biomarkers"}),e.jsx("option",{value:"functional_status",children:"Functional Status"})]})}),e.jsxs("div",{className:"text-sm text-gray-600",children:[m.length," outcome",m.length!==1?"s":""," found"]})]})}),e.jsx("div",{className:"space-y-4",children:m.length===0?e.jsx(u,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(B,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Outcomes Found"}),e.jsx("p",{className:"text-gray-400",children:p!=="all"?`No ${p.replace("_"," ")} outcomes recorded yet`:"Start tracking treatment outcomes and patient responses"})]})}):m.sort((t,o)=>new Date(o.date).getTime()-new Date(t.date).getTime()).map(t=>{const o=R(t.value,t.measurement);return e.jsx(u,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${I(t.type)}`,children:[k(t.type),e.jsx("span",{className:"ml-1 capitalize",children:t.type.replace("_"," ")})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.measurement}),a(o)]}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Value:"}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:[t.value," ",t.unit&&t.unit]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Date:"}),e.jsx("p",{className:"text-gray-900",children:new Date(t.date).toLocaleDateString()})]}),t.treatmentRelated&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Related Treatment:"}),e.jsx("p",{className:"text-gray-900",children:t.treatmentRelated})]}),o&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Trend:"}),e.jsx("p",{className:`font-medium capitalize ${o==="improving"?"text-green-600":o==="worsening"?"text-red-600":"text-yellow-600"}`,children:o})]})]}),t.notes&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Notes:"}),e.jsx("p",{className:"text-gray-900",children:t.notes})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(A,{content:"Edit outcome",children:e.jsx("button",{onClick:()=>P(t),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",children:e.jsx(Z,{className:"w-4 h-4"})})}),e.jsx(A,{content:"Remove outcome",children:e.jsx("button",{onClick:()=>v(t.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:e.jsx(U,{className:"w-4 h-4"})})})]})]})},t.id)})}),$&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:j?"Edit Outcome":"Add Outcome"})}),e.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto max-h-[60vh]",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Outcome Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:h.type||"response",onChange:t=>n({...h,type:t.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"response",children:"Response Assessment"}),e.jsx("option",{value:"survival",children:"Survival Outcome"}),e.jsx("option",{value:"quality_of_life",children:"Quality of Life"}),e.jsx("option",{value:"biomarker",children:"Biomarker"}),e.jsx("option",{value:"functional_status",children:"Functional Status"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Measurement ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:h.measurement||"",onChange:t=>n({...h,measurement:t.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Tumor Size, ECOG Score",list:"measurement-suggestions"}),e.jsx("datalist",{id:"measurement-suggestions",children:h.type&&l[h.type]?.map((t,o)=>e.jsx("option",{value:t},o))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Value ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:h.value||"",onChange:t=>n({...h,value:t.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., 5.2, Complete Response"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit"}),e.jsx("input",{type:"text",value:h.unit||"",onChange:t=>n({...h,unit:t.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., cm, %, ng/mL"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:h.date||"",onChange:t=>n({...h,date:t.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Treatment"}),e.jsxs("select",{value:h.treatmentRelated||"",onChange:t=>n({...h,treatmentRelated:t.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Select treatment (optional)"}),i.treatmentHistory?.map(t=>e.jsxs("option",{value:t.regimen||t.treatmentType,children:[t.regimen||t.treatmentType," (",new Date(t.startDate).toLocaleDateString(),")"]},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:h.notes||"",onChange:t=>n({...h,notes:t.target.value}),rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Additional notes about this outcome..."})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-between",children:[e.jsx("button",{onClick:()=>{y(!1),b(null),n({type:"response",measurement:"",value:"",unit:"",date:new Date().toISOString().split("T")[0],notes:"",treatmentRelated:""})},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:j?c:g,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:j?"Update Outcome":"Add Outcome"})]})]})})]})},He=({patientId:E})=>{const{state:C}=F(),{currentPatient:d}=C,[i,$]=N.useState({demographics:!0,medications:!0,allergies:!0,conditions:!0,vitals:!0,labValues:!0,genetics:!1,treatmentHistory:!0,notes:!1}),[y,j]=N.useState("summary"),[b,p]=N.useState("download"),[M,T]=N.useState(""),[h,n]=N.useState(!0),[x,m]=N.useState(!1);if(!d)return e.jsx(u,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(q,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Patient Selected"}),e.jsx("p",{className:"text-gray-400",children:"Select a patient to export their data"})]})});const g=()=>{const s={patientInfo:{id:d.id,name:`${d.demographics.firstName} ${d.demographics.lastName}`,mrn:d.demographics.mrn,exportDate:new Date().toISOString(),exportedBy:"current-user"}};return i.demographics&&(s.demographics=d.demographics),i.medications&&(s.medications=d.medications),i.allergies&&(s.allergies=d.allergies),i.conditions&&(s.conditions=d.conditions),i.vitals&&(s.vitals=d.vitals),i.labValues&&(s.labValues=d.labValues),i.genetics&&(s.genetics=d.genetics),i.treatmentHistory&&(s.treatmentHistory=d.treatmentHistory),i.notes&&(s.notes=d.notes),s},P=()=>{const s=g(),l=h?new Date().toLocaleString():"";return`
PATIENT SUMMARY REPORT
${l?`Generated: ${l}`:""}
${"-".repeat(50)}

PATIENT INFORMATION
Name: ${s.patientInfo.name}
MRN: ${s.patientInfo.mrn||"Not specified"}
Date of Birth: ${s.demographics?.dateOfBirth||"Not specified"}
Sex: ${s.demographics?.sex||"Not specified"}
${s.demographics?.heightCm?`Height: ${s.demographics.heightCm} cm`:""}
${s.demographics?.weightKg?`Weight: ${s.demographics.weightKg} kg`:""}

${s.allergies?.length>0?`
ALLERGIES
${s.allergies.map(t=>`• ${t.allergen} (${t.severity}) - ${t.reaction}`).join(`
`)}
`:""}

${s.conditions?.length>0?`
MEDICAL CONDITIONS
${s.conditions.map(t=>`• ${t.name} (${t.status}) - Diagnosed: ${new Date(t.dateOfDiagnosis).toLocaleDateString()}`).join(`
`)}
`:""}

${s.medications?.length>0?`
CURRENT MEDICATIONS
${s.medications.filter(t=>t.isActive).map(t=>`• ${t.drugName} ${t.dosage} ${t.frequency} (${t.route})`).join(`
`)}
`:""}

${s.treatmentHistory?.length>0?`
TREATMENT HISTORY
${s.treatmentHistory.map(t=>`• ${t.treatmentType}${t.regimen?` - ${t.regimen}`:""} (${new Date(t.startDate).toLocaleDateString()}${t.endDate?` to ${new Date(t.endDate).toLocaleDateString()}`:" - ongoing"})`).join(`
`)}
`:""}

${s.vitals?.length>0?`
RECENT VITALS (${new Date(s.vitals[s.vitals.length-1].timestamp).toLocaleDateString()})
${s.vitals[s.vitals.length-1].bloodPressureSystolic?`Blood Pressure: ${s.vitals[s.vitals.length-1].bloodPressureSystolic}/${s.vitals[s.vitals.length-1].bloodPressureDiastolic} mmHg`:""}
${s.vitals[s.vitals.length-1].heartRate?`Heart Rate: ${s.vitals[s.vitals.length-1].heartRate} bpm`:""}
${s.vitals[s.vitals.length-1].temperature?`Temperature: ${s.vitals[s.vitals.length-1].temperature}°C`:""}
${s.vitals[s.vitals.length-1].performanceStatus!==void 0?`ECOG Performance Status: ${s.vitals[s.vitals.length-1].performanceStatus}`:""}
`:""}

${s.labValues?.length>0?`
RECENT LAB VALUES
${s.labValues.slice(-5).map(t=>`• ${t.labType}: ${t.value} ${t.unit} (${new Date(t.timestamp).toLocaleDateString()})${t.isAbnormal?" [ABNORMAL]":""}`).join(`
`)}
`:""}

${s.genetics?.length>0?`
GENETIC INFORMATION
${s.genetics.map(t=>`• ${t.geneSymbol}: ${t.phenotype}${t.metabolizerStatus?` (${t.metabolizerStatus} metabolizer)`:""}`).join(`
`)}
`:""}

${"-".repeat(50)}
This report was generated by OncoSafeRx
CONFIDENTIAL MEDICAL INFORMATION
    `.trim()},c=s=>{if(s.medications){const l=["Drug Name","Dosage","Frequency","Route","Start Date","Status"],t=s.medications.map(o=>[o.drugName||"",o.dosage||"",o.frequency||"",o.route||"",o.startDate||"",o.isActive?"Active":"Inactive"]);return[l,...t].map(o=>o.map(w=>`"${w}"`).join(",")).join(`
`)}return"No data selected for CSV export"},v=async()=>{const s=g();let l,t,o;switch(y){case"json":l=JSON.stringify(s,null,2),t=`patient-${d.demographics.firstName}-${d.demographics.lastName}-${Date.now()}.json`,o="application/json";break;case"csv":l=c(s),t=`patient-medications-${Date.now()}.csv`,o="text/csv";break;case"summary":l=P(),t=`patient-summary-${Date.now()}.txt`,o="text/plain";break;default:return}switch(b){case"download":const w=new Blob([l],{type:o}),S=URL.createObjectURL(w),D=document.createElement("a");D.href=S,D.download=t,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(S);break;case"copy":try{await navigator.clipboard.writeText(l),m(!0),setTimeout(()=>m(!1),2e3)}catch{alert("Failed to copy to clipboard")}break;case"print":const r=window.open("","_blank");r&&(r.document.write(`
            <html>
              <head>
                <title>Patient Report - ${d.demographics.firstName} ${d.demographics.lastName}</title>
                <style>
                  body { font-family: monospace; white-space: pre-wrap; padding: 20px; }
                  @media print { body { margin: 0; } }
                </style>
              </head>
              <body>${l}</body>
            </html>
          `),r.document.close(),r.print());break;case"email":if(!M){alert("Please enter an email address");return}const f=encodeURIComponent(`Patient Report - ${d.demographics.firstName} ${d.demographics.lastName}`),O=encodeURIComponent(l);window.open(`mailto:${M}?subject=${f}&body=${O}`);break}},k=s=>{$(l=>({...l,[s]:!l[s]}))},I=()=>{const s=Object.values(i).every(Boolean),l=Object.keys(i).reduce((t,o)=>({...t,[o]:!s}),{});$(l)},R=()=>{const s=g(),l=JSON.stringify(s),t=new Blob([l]).size;return t<1024?`${t} bytes`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(1)} MB`},a=s=>{if(!d)return 0;switch(s){case"medications":return d.medications?.length||0;case"allergies":return d.allergies?.length||0;case"conditions":return d.conditions?.length||0;case"vitals":return d.vitals?.length||0;case"labValues":return d.labValues?.length||0;case"genetics":return d.genetics?.length||0;case"treatmentHistory":return d.treatmentHistory?.length||0;case"notes":return d.notes?.length||0;case"demographics":return 1;default:return 0}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(q,{className:"w-6 h-6 text-primary-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Data Export & Sharing"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Export ",d.demographics.firstName," ",d.demographics.lastName,"'s data for reporting, backup, or sharing"]})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Export size: ",R()]})]})}),e.jsx(ee,{type:"warning",title:"Privacy & Security Notice",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"mb-2",children:"Patient data contains sensitive health information. Please ensure compliance with HIPAA and institutional policies when sharing or exporting data."}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Only share data with authorized healthcare providers"}),e.jsx("li",{children:"Use secure channels for transmission"}),e.jsx("li",{children:"Remove or de-identify data when possible"}),e.jsx("li",{children:"Delete exported files after use"})]})]})}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Se,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Select Data to Export"})]}),e.jsx("button",{onClick:I,className:"text-sm text-primary-600 hover:text-primary-700",children:Object.values(i).every(Boolean)?"Deselect All":"Select All"})]}),e.jsx("div",{className:"space-y-3",children:Object.entries(i).map(([s,l])=>e.jsxs("label",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:()=>k(s),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-900 capitalize",children:s.replace(/([A-Z])/g," $1").trim()}),e.jsxs("div",{className:"text-sm text-gray-600",children:[a(s)," item",a(s)!==1?"s":""]})]})]}),s==="genetics"&&e.jsx(A,{content:"Genetic data requires special handling and may have additional privacy considerations",children:e.jsx(pe,{className:"w-4 h-4 text-yellow-500"})})]},s))})]}),e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Ce,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Export Options"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Export Format"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{value:"summary",label:"Summary Report",icon:te},{value:"json",label:"JSON Data",icon:q},{value:"csv",label:"CSV (Medications)",icon:q},{value:"pdf",label:"PDF Report",icon:te,disabled:!0}].map(({value:s,label:l,icon:t,disabled:o})=>e.jsxs("button",{onClick:()=>!o&&j(s),disabled:o,className:`flex items-center space-x-2 p-3 border rounded-lg text-left transition-colors ${y===s&&!o?"border-primary-500 bg-primary-50 text-primary-700":o?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(t,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:l}),o&&e.jsx("span",{className:"text-xs",children:"(Coming Soon)"})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sharing Method"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{value:"download",label:"Download File",icon:q},{value:"copy",label:"Copy to Clipboard",icon:De},{value:"print",label:"Print Report",icon:Te},{value:"email",label:"Email Report",icon:ue}].map(({value:s,label:l,icon:t})=>e.jsxs("button",{onClick:()=>p(s),className:`flex items-center space-x-2 p-3 border rounded-lg text-left transition-colors ${b===s?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(t,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:l})]},s))})]}),b==="email"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:M,onChange:s=>T(s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"recipient@hospital.org"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:s=>n(s.target.checked),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Include timestamp in export"})]})})]})]})]}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ready to Export"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[Object.values(i).filter(Boolean).length," section",Object.values(i).filter(Boolean).length!==1?"s":""," selected • ",y.toUpperCase()," format • ",b," method"]})]}),e.jsxs("button",{onClick:v,disabled:!Object.values(i).some(Boolean),className:"flex items-center space-x-2 px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:[x?e.jsx(K,{className:"w-4 h-4"}):e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{children:x?"Copied!":b==="copy"?"Copy Data":b==="email"?"Send Email":b==="print"?"Print Report":"Download"})]})]})})]})},Ve=()=>{const{state:E,actions:C}=F(),{showToast:d}=me(),{currentPatient:i,alerts:$,isLoading:y,error:j}=E,b=ge(),[p,M]=N.useState("overview");if(y)return e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(be,{size:"lg"})});if(!i)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Q,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium text-gray-500",children:"No Patient Selected"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Select a patient to view their clinical profile"})]});const T=c=>{const v=new Date,k=new Date(c);let I=v.getFullYear()-k.getFullYear();const R=v.getMonth()-k.getMonth();return(R<0||R===0&&v.getDate()<k.getDate())&&I--,I},h=(c,v)=>!c||!v?null:Math.sqrt(c*v/3600),n=()=>$.filter(c=>c.patientId===i.id&&!c.isAcknowledged),x=()=>(i.labValues||[]).sort((c,v)=>new Date(v.timestamp).getTime()-new Date(c.timestamp).getTime()).slice(0,5),m=()=>(i.medications||[]).filter(c=>c.isActive),g=()=>{const c=i.vitals||[];return c.length>0?c.sort((v,k)=>new Date(k.timestamp).getTime()-new Date(v.timestamp).getTime())[0]:null},P=[{id:"overview",label:"Overview",icon:Pe},{id:"medications",label:"Medications",icon:J},{id:"labs",label:"Lab Values",icon:re},{id:"genetics",label:"Genomics",icon:X},{id:"history",label:"History",icon:Y},{id:"outcomes",label:"Outcomes",icon:W},{id:"export",label:"Export",icon:te}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-end",children:e.jsxs("button",{onClick:async()=>{if(!i||!confirm("Delete this patient?"))return;const c=i;C.removePatient(i.id),d("success","Patient deleted",5e3,{label:"Undo",onClick:async()=>{C.setCurrentPatient(c);try{const{data:v}=await V.auth.getSession(),k=v?.session?.access_token;k&&await fetch("/api/patients",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${k}`},body:JSON.stringify({patient:c})})}catch{}}})},className:"inline-flex items-center px-3 py-1.5 text-sm bg-red-600 text-white rounded hover:bg-red-700",children:[e.jsx(U,{className:"w-4 h-4 mr-1"})," Delete Patient"]})}),j&&e.jsx(ee,{type:"error",title:"Error",children:j}),n().length>0&&e.jsx("div",{className:"space-y-2",children:n().map((c,v)=>e.jsx(ee,{type:c.severity==="critical"?"error":c.severity==="high"?"warning":"info",title:c.message,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[c.details&&e.jsx("p",{className:"text-sm mt-1",children:c.details}),c.recommendedAction&&e.jsxs("p",{className:"text-sm mt-2 font-medium",children:["Recommended: ",c.recommendedAction]})]}),e.jsx("button",{onClick:()=>C.acknowledgeAlert(c.id),className:"ml-4 px-3 py-1 text-xs bg-white bg-opacity-20 rounded hover:bg-opacity-30",children:"Acknowledge"})]})},c.id||`alert-${v}`))}),e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx(Q,{className:"w-8 h-8 text-primary-600"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[i.demographics.firstName," ",i.demographics.lastName]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mt-1",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsxs("span",{children:[T(i.demographics.dateOfBirth)," years old"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{className:"capitalize",children:i.demographics.sex})]}),i.demographics.mrn&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsxs("span",{children:["MRN: ",i.demographics.mrn]})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{content:"Edit patient information",children:e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:e.jsx(Z,{className:"w-4 h-4"})})}),e.jsx(A,{content:"View clinical alerts",children:e.jsxs("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 relative",children:[e.jsx(ke,{className:"w-4 h-4"}),n().length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"})]})})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:"Height/Weight"})]}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900 mt-1",children:[i.demographics.heightCm?`${i.demographics.heightCm} cm`:"N/A"," / "," ",i.demographics.weightKg?`${i.demographics.weightKg} kg`:"N/A"]}),i.demographics.heightCm&&i.demographics.weightKg&&e.jsxs("div",{className:"text-xs text-gray-500",children:["BSA: ",h(i.demographics.heightCm,i.demographics.weightKg)?.toFixed(2)," m²"]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:"Active Medications"})]}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 mt-1",children:m().length})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(ce,{className:"w-4 h-4"}),e.jsx("span",{children:"Allergies"})]}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 mt-1",children:(i.allergies||[]).length})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(_,{className:"w-4 h-4"}),e.jsx("span",{children:"Last Updated"})]}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 mt-1",children:new Date(i.lastUpdated).toLocaleDateString()})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:P.map(c=>{const v=c.icon;return e.jsxs("button",{onClick:()=>M(c.id),className:`group inline-flex items-center space-x-2 py-4 px-6 border-b-2 font-medium text-sm ${p===c.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(v,{className:"w-4 h-4"}),e.jsx("span",{children:c.label})]},c.id)})})}),e.jsxs("div",{className:"p-6",children:[p==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(oe,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Contact Information"})]}),e.jsxs("div",{className:"space-y-3",children:[i.demographics.contact?.phone&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(oe,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:i.demographics.contact.phone})]}),i.demographics.contact?.email&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ue,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:i.demographics.contact.email})]}),i.demographics.contact?.address&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Oe,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:i.demographics.contact.address})]})]})]}),e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx($e,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Vitals"}),e.jsx(A,{content:"Most recent vital signs and performance status",children:e.jsx(L,{className:"w-4 h-4 text-gray-400"})})]}),g()?e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[g().bloodPressureSystolic&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"BP:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[g().bloodPressureSystolic,"/",g().bloodPressureDiastolic]})]},"blood-pressure"),g().heartRate&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"HR:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[g().heartRate," bpm"]})]},"heart-rate"),g().temperature&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Temp:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[g().temperature,"°C"]})]},"temperature"),g().performanceStatus!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ECOG:"}),e.jsx("span",{className:"ml-1 font-medium",children:g().performanceStatus})]},"performance-status")]}):e.jsx("p",{className:"text-sm text-gray-500",children:"No recent vitals recorded"})]})]}),e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"w-5 h-5 text-red-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Allergies"}),e.jsx(A,{content:"Known drug and environmental allergies with severity levels",children:e.jsx(L,{className:"w-4 h-4 text-gray-400"})})]}),e.jsx("button",{className:"p-1 text-gray-400 hover:text-gray-600",children:e.jsx(H,{className:"w-4 h-4"})})]}),(i.allergies||[]).length>0?e.jsx("div",{className:"space-y-2",children:(i.allergies||[]).map((c,v)=>e.jsxs("div",{className:`p-3 rounded-lg border-l-4 ${c.severity==="life-threatening"?"border-red-500 bg-red-50":c.severity==="severe"?"border-orange-500 bg-orange-50":c.severity==="moderate"?"border-yellow-500 bg-yellow-50":"border-gray-500 bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-900",children:c.allergen}),e.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["(",c.allergenType,")"]})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${c.severity==="life-threatening"?"bg-red-100 text-red-800":c.severity==="severe"?"bg-orange-100 text-orange-800":c.severity==="moderate"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:c.severity})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:c.reaction})]},c.id||`allergy-${v}`))}):e.jsx("p",{className:"text-sm text-gray-500",children:"No known allergies"})]}),e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(re,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Lab Values"}),e.jsx(A,{content:"Most recent laboratory test results with reference ranges",children:e.jsx(L,{className:"w-4 h-4 text-gray-400"})})]}),x().length>0?e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Test"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Value"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Reference"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:x().map((c,v)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 text-sm font-medium text-gray-900",children:c.labType}),e.jsxs("td",{className:`px-3 py-2 text-sm ${c.isAbnormal?"text-red-600 font-medium":"text-gray-900"}`,children:[c.value," ",c.unit,c.criticalFlag&&e.jsx("span",{className:"ml-1 text-red-500",children:"⚠"})]}),e.jsx("td",{className:"px-3 py-2 text-sm text-gray-600",children:c.referenceRange}),e.jsx("td",{className:"px-3 py-2 text-sm text-gray-600",children:new Date(c.timestamp).toLocaleDateString()})]},`${c.labType}-${c.timestamp}-${v}`))})]})}):e.jsx("p",{className:"text-sm text-gray-500",children:"No recent lab values"})]}),e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[e.jsx(Re,{className:"w-5 h-5 text-purple-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"AI & Advanced Features"}),e.jsx(A,{content:"Access powerful AI and analytics tools for this patient",children:e.jsx(L,{className:"w-4 h-4 text-gray-400"})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"group bg-gradient-to-br from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4 hover:shadow-md transition-all cursor-pointer",onClick:()=>setTimeout(()=>b("/ai-decision-engine"),100),children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Me,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"AI Decision Engine"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Clinical decision support"})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Get AI-powered clinical recommendations and drug interaction analysis"}),e.jsxs("div",{className:"flex items-center text-blue-600 text-sm font-medium group-hover:text-blue-700",children:[e.jsx("span",{children:"Launch AI Analysis"}),e.jsx(z,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})]})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4 hover:shadow-md transition-all cursor-pointer",onClick:()=>setTimeout(()=>b("/safety-alerts"),100),children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(pe,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Safety Alerts"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Real-time monitoring"})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Monitor drug safety alerts and potential adverse events"}),e.jsxs("div",{className:"flex items-center text-green-600 text-sm font-medium group-hover:text-green-700",children:[e.jsx("span",{children:"View Safety Dashboard"}),e.jsx(z,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})]})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-orange-50 to-red-50 border border-orange-200 rounded-lg p-4 hover:shadow-md transition-all cursor-pointer",onClick:()=>setTimeout(()=>b("/ml-analytics"),100),children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(B,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"ML Analytics"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Advanced insights"})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Access machine learning analytics and predictive models"}),e.jsxs("div",{className:"flex items-center text-orange-600 text-sm font-medium group-hover:text-orange-700",children:[e.jsx("span",{children:"Open Analytics"}),e.jsx(z,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})]})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-purple-50 to-pink-50 border border-purple-200 rounded-lg p-4 hover:shadow-md transition-all cursor-pointer",onClick:()=>setTimeout(()=>b("/predictive-outcomes"),100),children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(se,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Predictive Outcomes"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Treatment predictions"})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Generate AI-powered treatment outcome predictions"}),e.jsxs("div",{className:"flex items-center text-purple-600 text-sm font-medium group-hover:text-purple-700",children:[e.jsx("span",{children:"Generate Predictions"}),e.jsx(z,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})]})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-teal-50 to-cyan-50 border border-teal-200 rounded-lg p-4 hover:shadow-md transition-all cursor-pointer",onClick:()=>setTimeout(()=>b("/clinical-communication"),100),children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-teal-100 rounded-lg flex items-center justify-center",children:e.jsx(Ie,{className:"w-5 h-5 text-teal-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Team Communication"}),e.jsx("p",{className:"text-xs text-gray-600",children:"HIPAA-compliant messaging"})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Secure team communication and collaboration"}),e.jsxs("div",{className:"flex items-center text-teal-600 text-sm font-medium group-hover:text-teal-700",children:[e.jsx("span",{children:"Open Messenger"}),e.jsx(z,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})]})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-indigo-50 to-blue-50 border border-indigo-200 rounded-lg p-4 hover:shadow-md transition-all cursor-pointer",onClick:()=>setTimeout(()=>b("/iot-monitoring"),100),children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center",children:e.jsx(Ee,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"IoT Monitoring"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Connected devices"})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Monitor connected health devices and sensors"}),e.jsxs("div",{className:"flex items-center text-indigo-600 text-sm font-medium group-hover:text-indigo-700",children:[e.jsx("span",{children:"View Devices"}),e.jsx(z,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})]})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-red-50 to-pink-50 border border-red-200 rounded-lg p-4 hover:shadow-md transition-all cursor-pointer",onClick:()=>setTimeout(()=>b("/opioid-risk-report"),100),children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(Le,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Opioid Risk Report"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Addiction risk assessment"})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Comprehensive addiction risk and pharmacogenomic analysis"}),e.jsxs("div",{className:"flex items-center text-red-600 text-sm font-medium group-hover:text-red-700",children:[e.jsx("span",{children:"View Risk Assessment"}),e.jsx(z,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})]})]})]})]})]}),p==="medications"&&e.jsx(Ue,{}),p==="genetics"&&e.jsx(Ge,{}),p==="history"&&e.jsx(qe,{}),p==="outcomes"&&e.jsx(_e,{}),p==="export"&&e.jsx(He,{}),p==="labs"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx(re,{className:"w-12 h-12 mx-auto"})}),e.jsx("p",{className:"text-lg font-medium text-gray-500",children:"Lab Management"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Coming soon in Phase 2"})]})]})]})]})},st=()=>{const E=ge(),{state:C,dispatch:d}=F(),{currentPatient:i}=C,$=()=>{try{sessionStorage.setItem("oncosaferx:offline_banner_dismissed","1")}catch{}d({type:"DISMISS_OFFLINE_BANNER"})},y=()=>{i&&setTimeout(()=>E("/interactions?patient="+i.id),100)},j=()=>{i&&setTimeout(()=>E("/genomics?patient="+i.id),100)},b=()=>{i&&setTimeout(()=>E("/regimens?patient="+i.id),100)};return e.jsxs("div",{className:"space-y-6",children:[C.lastSaveOffline&&C.showOfflineBanner&&e.jsx("div",{className:"rounded-md border border-yellow-200 bg-yellow-50 p-3 text-sm text-yellow-800",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Saved locally — not persisted"}),e.jsx("div",{children:C.offlineNote||"The server is not configured for persistence. Data was saved locally only."})]}),e.jsxs("div",{className:"text-xs flex items-center gap-3",children:[e.jsx(ne,{to:"/auth-diagnostics",className:"text-blue-700 hover:underline",children:"Auth Diagnostics"}),e.jsx("button",{onClick:$,className:"px-2 py-1 border rounded bg-white text-yellow-800 hover:bg-yellow-100",children:"Dismiss"})]})]})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[e.jsx(de,{className:"w-8 h-8 text-primary-600"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Patient Management"}),e.jsx(A,{content:"Comprehensive patient profile management with clinical data, medication history, and safety alerts",children:e.jsx(L,{className:"w-5 h-5 text-gray-400"})})]}),e.jsx("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto",children:"Search for existing patients or create new patient profiles to access comprehensive clinical information and decision support tools."}),e.jsx("div",{className:"mt-3",children:e.jsx(ne,{to:"/patients/all",className:"text-sm text-blue-600 hover:underline",children:"View all patients"})})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(Be,{})}),e.jsx("div",{className:"lg:col-span-2",children:i?e.jsx(Ve,{}):e.jsx(u,{className:"h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(de,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-500 mb-2",children:"No Patient Selected"}),e.jsx("p",{className:"text-gray-400 max-w-md mx-auto",children:"Search for an existing patient or create a new patient profile to begin accessing clinical information and decision support tools."})]})})})]}),i&&e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Quick Actions"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Common clinical workflows for this patient"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:y,className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700",children:"Check Interactions"}),e.jsx("button",{onClick:j,className:"px-4 py-2 bg-purple-600 text-white text-sm font-medium rounded-md hover:bg-purple-700",children:"Genomic Analysis"}),e.jsx("button",{onClick:b,className:"px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700",children:"Plan Regimen"})]})]})}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Patient Safety Features"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Allergy Checking"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Automatic cross-referencing of patient allergies with drug selections to prevent adverse reactions and ensure safe prescribing practices."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Clinical Alerts"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Real-time alerts for drug interactions, contraindications, dosing concerns, and monitoring requirements based on patient-specific factors."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Genomic Integration"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Integration of pharmacogenomic data to personalize drug selection and dosing based on individual genetic variants and metabolizer status."})]})]})]})})]})};export{st as default};
