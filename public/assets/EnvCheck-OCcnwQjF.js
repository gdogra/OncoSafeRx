import{r as d,j as e}from"./index-8LC8IQKY.js";function j(){const[c,x]=d.useState(null),[t,h]=d.useState(null),[p,b]=d.useState(null),i=d.useMemo(()=>{const s="https://emfrwckxctyarphjvfeu.supabase.co".trim(),l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVtZnJ3Y2t4Y3R5YXJwaGp2ZmV1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgwNjM2NjcsImV4cCI6MjA3MzYzOTY2N30.yYrhigcrMY82OkA4KPqSANtN5YgeA6xGH9fnrTe5k8c".trim(),r="/api".trim(),o="true".toLowerCase()==="true";return{supabaseUrl:s?"present":"missing",supabaseAnonKey:l?"present":"missing",apiBase:r||"/api",supabaseViaProxy:o}},[]);d.useEffect(()=>{let s=!1;return(async()=>{try{const[r,o]=await Promise.allSettled([fetch("/api/health"),fetch("/api/config/check")]);if(r.status==="fulfilled"&&r.value.ok){const u=await r.value.json().catch(()=>null);s||x(u)}if(o.status==="fulfilled"&&o.value.ok){const u=await o.value.json().catch(()=>null);s||h(u)}}catch(r){s||b(r?.message||"Failed to load diagnostics")}})(),()=>{s=!0}},[]);const a=({label:s,value:l})=>e.jsxs("div",{style:{display:"flex",gap:12,padding:"6px 0",alignItems:"center"},children:[e.jsx("div",{style:{width:220,color:"#374151"},children:s}),e.jsx("div",{style:{fontWeight:600},children:l})]}),n=({ok:s,text:l})=>e.jsx("span",{style:{padding:"2px 8px",borderRadius:999,background:s?"#DEF7EC":"#FDE8E8",color:s?"#03543F":"#9B1C1C",fontSize:12,fontWeight:600},children:l});return e.jsxs("div",{style:{maxWidth:880,margin:"24px auto",padding:16,fontFamily:"system-ui, -apple-system, Segoe UI, Roboto, sans-serif"},children:[e.jsx("h1",{style:{margin:0,marginBottom:8},children:"Environment Check"}),e.jsx("p",{style:{marginTop:0,color:"#4B5563"},children:"Quick, non-secret diagnostics for build-time and runtime configuration."}),p&&e.jsx("div",{style:{background:"#FDE8E8",color:"#9B1C1C",padding:8,borderRadius:6},children:p}),e.jsxs("div",{style:{border:"1px solid #E5E7EB",borderRadius:8,padding:12,marginTop:12},children:[e.jsx("h3",{style:{margin:"4px 0 8px 0"},children:"Build-time env (frontend)"}),e.jsx(a,{label:"VITE_SUPABASE_URL",value:e.jsx(n,{ok:i.supabaseUrl==="present",text:i.supabaseUrl})}),e.jsx(a,{label:"VITE_SUPABASE_ANON_KEY",value:e.jsx(n,{ok:i.supabaseAnonKey==="present",text:i.supabaseAnonKey})}),e.jsx(a,{label:"VITE_API_URL",value:e.jsx("span",{children:i.apiBase})}),e.jsx(a,{label:"Auth via proxy",value:e.jsx(n,{ok:!!i.supabaseViaProxy,text:i.supabaseViaProxy?"enabled":"disabled"})})]}),e.jsxs("div",{style:{border:"1px solid #E5E7EB",borderRadius:8,padding:12,marginTop:12},children:[e.jsx("h3",{style:{margin:"4px 0 8px 0"},children:"Runtime health (backend)"}),e.jsx(a,{label:"/api/health",children:e.jsx(n,{ok:c?.status==="healthy",text:c?.status||"unknown"})}),e.jsx(a,{label:"Server Supabase",children:e.jsx(n,{ok:c?.supabase?.enabled===!0,text:c?.supabase?.enabled?"enabled":"disabled"})})]}),e.jsxs("div",{style:{border:"1px solid #E5E7EB",borderRadius:8,padding:12,marginTop:12},children:[e.jsx("h3",{style:{margin:"4px 0 8px 0"},children:"Server config check"}),e.jsx(a,{label:"Supabase configured",children:e.jsx(n,{ok:t?.supabase?.enabled===!0,text:t?.supabase?.enabled?"yes":"no"})}),e.jsx(a,{label:"SUPABASE_URL present",children:e.jsx(n,{ok:t?.supabase?.urlPresent===!0,text:t?.supabase?.urlPresent?"yes":"no"})}),e.jsx(a,{label:"Service role present",children:e.jsx(n,{ok:t?.supabase?.serviceRolePresent===!0,text:t?.supabase?.serviceRolePresent?"yes":"no"})}),t?.warnings?.length?e.jsxs("div",{style:{marginTop:6,color:"#92400E"},children:["Warnings: ",t.warnings.join(", ")]}):null]}),e.jsxs("div",{style:{marginTop:16,display:"flex",gap:12},children:[e.jsx("a",{href:"/auth-diagnostics",style:{color:"#1D4ED8",textDecoration:"underline"},children:"Go to Auth Diagnostics"}),e.jsx("a",{href:"/",style:{color:"#374151",textDecoration:"underline"},children:"Back to App"})]})]})}export{j as default};
