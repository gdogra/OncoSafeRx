import{c as F,r as c,a6 as _,j as e,M as E,i as H,T as A,b as V,h as Y,d as W,U as K,E as P,R as O,V as $,C as X,a7 as T,X as J,s as Q,S as Z,x as ee,a8 as se,K as te}from"./index-4Ly-s4cr.js";import{C as b}from"./Card-DLOVFYwQ.js";import{R as I}from"./refresh-cw-Da3gWcAr.js";import{D as M}from"./download-CEa9LHc5.js";import{C as z}from"./calendar-CM498r1t.js";import{C as R}from"./check-pB4liXIF.js";import{C as L}from"./copy-CJleH8s8.js";import{S as D}from"./settings-BG7XI4yB.js";import{E as ae}from"./eye-off-DGjjVpUS.js";import{E as re}from"./eye-BNehSfOP.js";import{S as ie}from"./save-BcthHOQ5.js";import{D as G}from"./database-CjiuAixY.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ne=F("circle-check",le);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],de=F("git-branch",ce);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],q=F("github",oe);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],me=F("key",xe),he=({isOpen:l,onClose:o})=>{const[n,f]=c.useState(null),[m,g]=c.useState(!0);c.useEffect(()=>{l&&y()},[l]);const y=()=>{g(!0);try{const a=_.getFeedbackAnalytics();f(a)}catch(a){console.error("Error loading feedback analytics:",a)}finally{g(!1)}},x=()=>{try{const a=_.exportFeedbackData(),s=new Blob([a],{type:"application/json"}),r=URL.createObjectURL(s),u=document.createElement("a");u.href=r,u.download=`oncosaferx-feedback-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(r)}catch(a){console.error("Error exporting data:",a)}},i=a=>({critical:"bg-red-100 text-red-800",high:"bg-orange-100 text-orange-800",medium:"bg-yellow-100 text-yellow-800",low:"bg-green-100 text-green-800"})[a]||"bg-gray-100 text-gray-800",d=a=>({bug:"🐛",feature_request:"💡",improvement:"⚡",question:"❓",complaint:"😠",compliment:"👍",security_concern:"🔒",performance_issue:"🚀",usability_issue:"🎯",data_issue:"📊",integration_issue:"🔗"})[a]||"📝";if(m)return e.jsx(E,{isOpen:l,onClose:o,title:"Feedback Dashboard",size:"xl",children:e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(I,{className:"w-8 h-8 animate-spin text-primary-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading analytics..."})]})});if(!n)return e.jsx(E,{isOpen:l,onClose:o,title:"Feedback Dashboard",size:"xl",children:e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-600",children:"No feedback data available."})})});const{totalFeedback:j,totalTickets:k,byType:v,byCategory:S,byPriority:C,recentFeedback:h,sprintPlan:N}=n;return e.jsx(E,{isOpen:l,onClose:o,title:"Feedback Dashboard",size:"full",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:y,className:"flex items-center space-x-2 px-3 py-2 text-sm bg-gray-100 rounded-md hover:bg-gray-200",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{children:"Refresh"})]}),e.jsxs("button",{onClick:x,className:"flex items-center space-x-2 px-3 py-2 text-sm bg-primary-100 text-primary-700 rounded-md hover:bg-primary-200",children:[e.jsx(M,{className:"w-4 h-4"}),e.jsx("span",{children:"Export Data"})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(b,{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-600",children:j}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Feedback"})]}),e.jsxs(b,{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:k}),e.jsx("div",{className:"text-sm text-gray-600",children:"Active Tickets"})]}),e.jsxs(b,{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:N.currentSprint.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Current Sprint"})]}),e.jsxs(b,{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:N.nextSprint.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Next Sprint"})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs(b,{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(H,{className:"w-5 h-5 mr-2"}),"Feedback by Type"]}),e.jsx("div",{className:"space-y-3",children:Object.entries(v).map(([a,s])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-lg",children:d(a)}),e.jsx("span",{className:"text-sm font-medium",children:a.replace("_"," ")})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-primary-600 h-2 rounded-full",style:{width:`${s/j*100}%`}})}),e.jsx("span",{className:"text-sm font-semibold w-8 text-right",children:s})]})]},a))})]}),e.jsxs(b,{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(A,{className:"w-5 h-5 mr-2"}),"Priority Distribution"]}),e.jsx("div",{className:"space-y-3",children:Object.entries(C).map(([a,s])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${i(a)}`,children:a}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-orange-500 h-2 rounded-full",style:{width:`${s/j*100}%`}})}),e.jsx("span",{className:"text-sm font-semibold w-8 text-right",children:s})]})]},a))})]})]}),e.jsxs(b,{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(V,{className:"w-5 h-5 mr-2"}),"Sprint Planning"]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-green-900 mb-3 flex items-center",children:[e.jsx(z,{className:"w-4 h-4 mr-1"}),"Current Sprint (",N.currentSprint.length," items)"]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:N.currentSprint.map((a,s)=>e.jsxs("div",{className:"p-2 bg-green-50 rounded border border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${i(a.priority)}`,children:a.priority}),e.jsx("span",{className:"text-xs text-gray-500",children:a.effort})]}),e.jsxs("div",{className:"text-xs font-medium mt-1",children:[d(a.type)," ",a.type]})]},s))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-blue-900 mb-3 flex items-center",children:[e.jsx(Y,{className:"w-4 h-4 mr-1"}),"Next Sprint (",N.nextSprint.length," items)"]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:N.nextSprint.map((a,s)=>e.jsxs("div",{className:"p-2 bg-blue-50 rounded border border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${i(a.priority)}`,children:a.priority}),e.jsx("span",{className:"text-xs text-gray-500",children:a.effort})]}),e.jsxs("div",{className:"text-xs font-medium mt-1",children:[d(a.type)," ",a.type]})]},s))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[e.jsx(W,{className:"w-4 h-4 mr-1"}),"Backlog (",N.backlog.length," items)"]}),e.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[N.backlog.slice(0,10).map((a,s)=>e.jsxs("div",{className:"p-2 bg-gray-50 rounded border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${i(a.priority)}`,children:a.priority}),e.jsx("span",{className:"text-xs text-gray-500",children:a.effort})]}),e.jsxs("div",{className:"text-xs font-medium mt-1",children:[d(a.type)," ",a.type]})]},s)),N.backlog.length>10&&e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["+",N.backlog.length-10," more items..."]})]})]})]})]}),e.jsxs(b,{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(K,{className:"w-5 h-5 mr-2"}),"Recent Feedback"]}),e.jsx("div",{className:"space-y-4",children:h.slice(0,5).map((a,s)=>e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"text-lg",children:d(a.type)}),e.jsx("span",{className:"font-medium text-gray-900",children:a.title}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${i(a.priority)}`,children:a.priority})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[a.description.substring(0,150),"..."]}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("span",{children:["📍 ",a.page]}),e.jsxs("span",{children:["🕒 ",new Date(a.timestamp).toLocaleDateString()]}),e.jsxs("span",{children:["🏷️ ",a.category]}),a.metadata?.githubIssue&&e.jsx("a",{href:a.metadata.githubIssue.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center space-x-1 text-blue-600 hover:text-blue-800",children:e.jsxs("span",{children:["🔗 GitHub #",a.metadata.githubIssue.number]})})]})]})})},s))})]})]})})},ue=({isOpen:l,onClose:o})=>{const[n,f]=c.useState(0),[m,g]=c.useState(null),y=async(i,d)=>{try{await navigator.clipboard.writeText(i),g(d),setTimeout(()=>g(null),2e3)}catch(j){console.error("Failed to copy:",j)}},x=[{title:"Create or Choose Repository",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-700",children:"First, you'll need a GitHub repository where the issues will be created. This can be:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700",children:[e.jsx("li",{children:"Your main OncoSafeRx repository (if you have one)"}),e.jsx("li",{children:"A dedicated feedback/issues repository"}),e.jsx("li",{children:"Any repository where you want to track feedback"})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Repository Requirements:"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Must have Issues enabled (default for most repositories)"}),e.jsx("li",{children:"• You must have write access to create issues"}),e.jsx("li",{children:"• Can be public or private"})]})]})]})},{title:"Create Personal Access Token",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-700",children:"Create a Personal Access Token (PAT) to authenticate with GitHub's API."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"1. Go to GitHub Settings"}),e.jsxs("a",{href:"https://github.com/settings/tokens",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-blue-600 hover:text-blue-800",children:[e.jsx("span",{className:"text-sm",children:"Open"}),e.jsx(P,{className:"w-3 h-3"})]})]}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsx("span",{className:"text-sm font-medium",children:'2. Click "Generate new token" → "Generate new token (classic)"'})}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"3. Configure the token:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Note:"}),' "OncoSafeRx Feedback Integration"']}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Expiration:"})," Choose appropriate duration"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Scopes:"}),' Select "repo" (or "public_repo" for public repositories only)']})]})]}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsx("span",{className:"text-sm font-medium",children:'4. Click "Generate token" and copy the token immediately'})})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(A,{className:"w-4 h-4 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Important:"})," Copy the token immediately after creation. GitHub will only show it once for security reasons."]})]})})]})},{title:"Set Up Repository Labels",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-700",children:"OncoSafeRx automatically creates labels for better issue organization. You can create these labels in advance:"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Priority Labels:"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{name:"priority:critical",color:"#d73a49",desc:"Critical issues"},{name:"priority:high",color:"#f66a0a",desc:"High priority"},{name:"priority:medium",color:"#fbca04",desc:"Medium priority"},{name:"priority:low",color:"#28a745",desc:"Low priority"}].map(i=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:i.color}}),e.jsx("span",{className:"text-sm font-mono",children:i.name})]}),e.jsx("button",{onClick:()=>y(i.name,i.name),className:"text-gray-400 hover:text-gray-600",children:m===i.name?e.jsx(R,{className:"w-3 h-3"}):e.jsx(L,{className:"w-3 h-3"})})]},i.name))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Type Labels:"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{name:"bug",color:"#d73a49"},{name:"enhancement",color:"#a2eeef"},{name:"question",color:"#d876e3"},{name:"security",color:"#0052cc"}].map(i=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:i.color}}),e.jsx("span",{className:"text-sm font-mono",children:i.name})]}),e.jsx("button",{onClick:()=>y(i.name,i.name),className:"text-gray-400 hover:text-gray-600",children:m===i.name?e.jsx(R,{className:"w-3 h-3"}):e.jsx(L,{className:"w-3 h-3"})})]},i.name))})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Auto-Creation"}),e.jsx("p",{className:"text-sm text-blue-800",children:"Don't worry if you skip this step! GitHub will automatically create labels when OncoSafeRx tries to use them. Creating them in advance just ensures consistent colors and descriptions."})]})]})},{title:"Configure OncoSafeRx",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-700",children:"Now configure the GitHub integration in OncoSafeRx:"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"1. Repository Information:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Owner:"})," Your GitHub username or organization name"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Repository:"})," The repository name (not the full URL)"]})]})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"2. Authentication:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Paste the Personal Access Token you created"}),e.jsx("li",{children:"• Leave API URL empty (uses GitHub.com by default)"})]})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"3. Test & Enable:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:'• Click "Test Connection" to verify setup'}),e.jsx("li",{children:"• Enable the integration if test succeeds"}),e.jsx("li",{children:"• Save the configuration"})]})]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-900 mb-2",children:"Example Configuration:"}),e.jsxs("div",{className:"text-sm font-mono text-green-800 space-y-1",children:[e.jsxs("div",{children:["Owner: ",e.jsx("span",{className:"bg-white px-1 rounded",children:"your-username"})]}),e.jsxs("div",{children:["Repository: ",e.jsx("span",{className:"bg-white px-1 rounded",children:"oncosaferx-feedback"})]}),e.jsxs("div",{children:["Token: ",e.jsx("span",{className:"bg-white px-1 rounded",children:"ghp_xxxxxxxxxxxxxxxxxxxxx"})]})]})]})]})},{title:"Test the Integration",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-700",children:"Once configured, test the integration to ensure everything works correctly:"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"1. Submit Test Feedback:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Use the feedback button to submit a test report"}),e.jsx("li",{children:"• Try different feedback types (bug, feature request, etc.)"}),e.jsx("li",{children:"• Include detailed information for testing"})]})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"2. Verify GitHub Issues:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Check your GitHub repository for new issues"}),e.jsx("li",{children:"• Verify labels are applied correctly"}),e.jsx("li",{children:"• Confirm issue content includes all feedback details"})]})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"3. Check Feedback Dashboard:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• View the feedback admin dashboard"}),e.jsx("li",{children:"• Look for GitHub issue links in recent feedback"}),e.jsx("li",{children:"• Verify the integration status"})]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"What Gets Created:"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• GitHub issue with formatted title and description"}),e.jsx("li",{children:"• Automatic labels based on feedback type and priority"}),e.jsx("li",{children:"• Browser and environment information"}),e.jsx("li",{children:"• Direct link back to the OncoSafeRx page"}),e.jsx("li",{children:"• Reproduction steps for bug reports"})]})]})]})}];return e.jsx(E,{isOpen:l,onClose:o,title:"GitHub Integration Setup Guide",size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center space-x-2",children:x.map((i,d)=>e.jsxs(O.Fragment,{children:[e.jsx("button",{onClick:()=>f(d),className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${d===n?"bg-primary-600 text-white":d<n?"bg-green-500 text-white":"bg-gray-200 text-gray-600"}`,children:d<n?e.jsx(R,{className:"w-4 h-4"}):d+1}),d<x.length-1&&e.jsx("div",{className:`w-8 h-0.5 ${d<n?"bg-green-500":"bg-gray-200"}`})]},d))}),e.jsxs("div",{className:"min-h-[400px]",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsxs("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center",children:[n===0&&e.jsx(q,{className:"w-5 h-5 text-primary-600"}),n===1&&e.jsx(me,{className:"w-5 h-5 text-primary-600"}),n===2&&e.jsx(D,{className:"w-5 h-5 text-primary-600"}),n===3&&e.jsx($,{className:"w-5 h-5 text-primary-600"}),n===4&&e.jsx(R,{className:"w-5 h-5 text-primary-600"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:x[n].title}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Step ",n+1," of ",x.length]})]})]}),e.jsx("div",{className:"prose prose-sm max-w-none",children:x[n].content})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>f(Math.max(0,n-1)),disabled:n===0,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[n+1," of ",x.length]}),n<x.length-1?e.jsxs("button",{onClick:()=>f(n+1),className:"flex items-center space-x-2 px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700",children:[e.jsx("span",{children:"Next"}),e.jsx(X,{className:"w-4 h-4"})]}):e.jsx("button",{onClick:o,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700",children:"Get Started"})]})]})})},pe=({onConfigChange:l})=>{const[o,n]=c.useState({owner:"",repo:"",token:"",enabled:!1}),[f,m]=c.useState(!1),[g,y]=c.useState(!1),[x,i]=c.useState(null),[d,j]=c.useState(!1),[k,v]=c.useState([]),[S,C]=c.useState(!1);c.useEffect(()=>{const r=T.getConfig();r&&n(r)},[]);const h=(r,u)=>{n(w=>({...w,[r]:u})),i(null),v([])},N=async()=>{y(!0),i(null);const r=T.validateConfig(o);if(!r.valid){v(r.errors),y(!1);return}const u=T.getConfig();T.saveConfig({...o,enabled:!0});try{const w=await T.testConnection();i(w)}catch(w){i({success:!1,message:w instanceof Error?w.message:"Test failed"})}finally{u&&T.saveConfig(u),y(!1)}},a=async()=>{j(!0),v([]);try{const r=T.validateConfig(o);if(!r.valid){v(r.errors),j(!1);return}T.saveConfig(o),l?.(o.enabled),i({success:!0,message:"Configuration saved successfully"})}catch(r){v([r instanceof Error?r.message:"Failed to save configuration"])}finally{j(!1)}},s=()=>{confirm("Are you sure you want to clear the GitHub configuration?")&&(T.clearConfig(),n({owner:"",repo:"",token:"",enabled:!1}),i(null),v([]),l?.(!1))};return e.jsx(b,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-900 rounded-lg flex items-center justify-center",children:e.jsx(q,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"GitHub Issues Integration"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Automatically create GitHub issues from user feedback"})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:o.enabled&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(R,{className:"w-3 h-3 mr-1"}),"Enabled"]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Enable GitHub Integration"}),e.jsx("p",{className:"text-sm text-gray-600",children:"When enabled, feedback will automatically create GitHub issues"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o.enabled,onChange:r=>h("enabled",r.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"owner",className:"block text-sm font-medium text-gray-700 mb-1",children:["Repository Owner ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"owner",value:o.owner,onChange:r=>h("owner",r.target.value),placeholder:"username or organization",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"GitHub username or organization name"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"repo",className:"block text-sm font-medium text-gray-700 mb-1",children:["Repository Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"repo",value:o.repo,onChange:r=>h("repo",r.target.value),placeholder:"repository-name",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Repository name (e.g., "my-project")'})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"token",className:"block text-sm font-medium text-gray-700 mb-1",children:["Personal Access Token ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:f?"text":"password",id:"token",value:o.token,onChange:r=>h("token",r.target.value),placeholder:"ghp_xxxxxxxxxxxxxxxxxxxx",className:"w-full border border-gray-300 rounded-md px-3 py-2 pr-10 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("button",{type:"button",onClick:()=>m(!f),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:f?e.jsx(ae,{className:"w-4 h-4 text-gray-400"}):e.jsx(re,{className:"w-4 h-4 text-gray-400"})})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1 space-y-1",children:[e.jsxs("p",{children:["Required permissions: ",e.jsx("code",{children:"repo"})," (or ",e.jsx("code",{children:"public_repo"})," for public repositories)"]}),e.jsxs("a",{href:"https://github.com/settings/tokens/new?scopes=repo&description=OncoSafeRx%20Feedback%20Integration",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-primary-600 hover:text-primary-700",children:["Create token on GitHub ",e.jsx(P,{className:"w-3 h-3 ml-1"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"apiUrl",className:"block text-sm font-medium text-gray-700 mb-1",children:"API URL (Optional)"}),e.jsx("input",{type:"url",id:"apiUrl",value:o.apiUrl||"",onChange:r=>h("apiUrl",r.target.value),placeholder:"https://api.github.com (default)",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty to use GitHub.com. Use for GitHub Enterprise Server."})]})]}),k.length>0&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(A,{className:"w-4 h-4 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-red-800",children:"Configuration Errors"}),e.jsx("ul",{className:"text-sm text-red-700 mt-1 list-disc list-inside",children:k.map((r,u)=>e.jsx("li",{children:r},u))})]})]})}),x&&e.jsx("div",{className:`p-3 border rounded-lg ${x.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:e.jsxs("div",{className:"flex items-start space-x-2",children:[x.success?e.jsx(R,{className:"w-4 h-4 text-green-500 flex-shrink-0 mt-0.5"}):e.jsx(J,{className:"w-4 h-4 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:`text-sm font-medium ${x.success?"text-green-800":"text-red-800"}`,children:x.success?"Connection Successful":"Connection Failed"}),e.jsx("p",{className:`text-sm mt-1 ${x.success?"text-green-700":"text-red-700"}`,children:x.message})]})]})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"Clear Configuration"}),e.jsxs("button",{onClick:()=>C(!0),className:"flex items-center space-x-2 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{children:"Setup Guide"})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:N,disabled:g||!o.owner||!o.repo||!o.token,className:"flex items-center space-x-2 px-4 py-2 text-sm font-medium text-blue-700 bg-blue-100 rounded-md hover:bg-blue-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:g?"Testing...":"Test Connection"})]}),e.jsxs("button",{onClick:a,disabled:d,className:"flex items-center space-x-2 px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ie,{className:"w-4 h-4"}),e.jsx("span",{children:d?"Saving...":"Save Configuration"})]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"How it works"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• User feedback is automatically converted to GitHub issues"}),e.jsx("li",{children:"• Issues include detailed metadata, labels, and context"}),e.jsx("li",{children:"• Priority and effort estimation are added as labels"}),e.jsx("li",{children:"• Bug reports include reproduction steps and browser info"}),e.jsx("li",{children:"• Issues are automatically labeled for organization"})]})]}),e.jsx(ue,{isOpen:S,onClose:()=>C(!1)})]})})},U=["new","triaged","in_backlog","in_sprint","in_progress","in_review","done","closed","duplicate","wont_fix"],ge=["critical","high","medium","low"],je=["bug","feature_request","improvement","question","complaint","compliment","security_concern","performance_issue","usability_issue","data_issue","integration_issue"],ye=l=>l==="critical"?"bg-red-100 text-red-800":l==="high"?"bg-orange-100 text-orange-800":l==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800",be=()=>{const[l,o]=c.useState([]),[n,f]=c.useState(0),[m,g]=c.useState(1),[y,x]=c.useState(25),[i,d]=c.useState(!0),[j,k]=c.useState({}),[v,S]=c.useState(""),[C,h]=c.useState(null),[N,a]=c.useState(null),s=async()=>{d(!0);try{const t=await _.getAllFeedback(m,y,j);o(t.feedback||[]),f(t.total||0)}catch(t){console.error("Failed to load feedback list:",t),o([]),f(0)}finally{d(!1)}};c.useEffect(()=>{s()},[m,y,j]);const r=c.useMemo(()=>{if(!v.trim())return l;const t=v.toLowerCase();return l.filter(p=>`${p.title} ${p.description}`.toLowerCase().includes(t))},[l,v]),u=async(t,p)=>{try{a(t),await _.updateFeedbackStatus(t,p),await s()}catch(B){console.error("Update status failed:",B),alert("Failed to update status")}finally{a(null)}},w=async t=>{try{h(t);const p=await _.createGitHubIssue(t);p?.issueUrl&&window.open(p.issueUrl,"_blank"),await s()}catch(p){console.error("Create issue failed:",p),alert("Failed to create GitHub issue")}finally{h(null)}};return e.jsxs(b,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(D,{className:"w-5 h-5 mr-2"}),"Feedback List & Triage"]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:s,className:"px-3 py-2 text-sm bg-gray-100 rounded hover:bg-gray-200",children:e.jsx(I,{className:`w-4 h-4 ${i?"animate-spin":""}`})})})]}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-3 mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"w-4 h-4 absolute left-2 top-2.5 text-gray-400"}),e.jsx("input",{value:v,onChange:t=>S(t.target.value),placeholder:"Search title/description",className:"w-full pl-7 pr-2 py-2 border border-gray-300 rounded text-sm"})]}),e.jsxs("select",{value:j.status||"",onChange:t=>{g(1),k(p=>({...p,status:t.target.value||void 0}))},className:"border border-gray-300 rounded px-2 py-2 text-sm",children:[e.jsx("option",{value:"",children:"All Statuses"}),U.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:j.priority||"",onChange:t=>{g(1),k(p=>({...p,priority:t.target.value||void 0}))},className:"border border-gray-300 rounded px-2 py-2 text-sm",children:[e.jsx("option",{value:"",children:"All Priorities"}),ge.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:j.type||"",onChange:t=>{g(1),k(p=>({...p,type:t.target.value||void 0}))},className:"border border-gray-300 rounded px-2 py-2 text-sm",children:[e.jsx("option",{value:"",children:"All Types"}),je.map(t=>e.jsx("option",{value:t,children:t.replace("_"," ")},t))]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left bg-gray-50",children:[e.jsx("th",{className:"px-3 py-2",children:"Title"}),e.jsx("th",{className:"px-3 py-2",children:"Type"}),e.jsx("th",{className:"px-3 py-2",children:"Priority"}),e.jsx("th",{className:"px-3 py-2",children:"Status"}),e.jsx("th",{className:"px-3 py-2",children:"When"}),e.jsx("th",{className:"px-3 py-2",children:"Actions"})]})}),e.jsxs("tbody",{children:[i&&e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-3 py-6 text-center text-gray-500",children:[e.jsx(I,{className:"w-5 h-5 inline mr-2 animate-spin"})," Loading..."]})}),!i&&r.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-3 py-6 text-center text-gray-500",children:[e.jsx(A,{className:"w-5 h-5 inline mr-2"})," No feedback found"]})}),!i&&r.map(t=>e.jsxs("tr",{className:"border-t",children:[e.jsxs("td",{className:"px-3 py-2 align-top",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.title}),e.jsx("div",{className:"text-gray-600 line-clamp-2",children:t.description}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[t.page||"unknown"," • ",t.category]})]}),e.jsx("td",{className:"px-3 py-2 align-top",children:t.type}),e.jsx("td",{className:"px-3 py-2 align-top",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full ${ye(t.priority)}`,children:t.priority})}),e.jsx("td",{className:"px-3 py-2 align-top",children:e.jsx("select",{value:t.status,onChange:p=>u(t.id,p.target.value),className:"border border-gray-300 rounded px-2 py-1 text-xs",disabled:N===t.id,children:U.map(p=>e.jsx("option",{value:p,children:p},p))})}),e.jsx("td",{className:"px-3 py-2 align-top text-xs text-gray-500",children:new Date(t.timestamp).toLocaleString()}),e.jsx("td",{className:"px-3 py-2 align-top",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>w(t.id),className:"px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700",disabled:C===t.id,title:"Create GitHub Issue",children:[e.jsx(de,{className:"w-3 h-3 inline mr-1"})," ",C===t.id?"Creating...":"Issue"]}),t.metadata?.githubIssue?.url&&e.jsxs("a",{href:t.metadata.githubIssue.url,target:"_blank",rel:"noopener noreferrer",className:"px-2 py-1 text-xs bg-gray-100 rounded hover:bg-gray-200",children:[e.jsx(R,{className:"w-3 h-3 inline mr-1 text-green-600"})," View"]})]})})]},t.id))]})]})}),e.jsxs("div",{className:"flex items-center justify-between mt-4 text-sm",children:[e.jsxs("div",{className:"text-gray-600",children:["Total: ",n]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{disabled:m<=1,onClick:()=>g(t=>Math.max(1,t-1)),className:"px-3 py-1 bg-gray-100 rounded disabled:opacity-50",children:"Prev"}),e.jsxs("span",{children:["Page ",m]}),e.jsx("button",{disabled:m*y>=n,onClick:()=>g(t=>t+1),className:"px-3 py-1 bg-gray-100 rounded disabled:opacity-50",children:"Next"}),e.jsx("select",{value:y,onChange:t=>{g(1),x(parseInt(t.target.value))},className:"border border-gray-300 rounded px-2 py-1",children:[10,25,50,100].map(t=>e.jsxs("option",{value:t,children:[t,"/page"]},t))})]})]})]})},fe=()=>{const[l,o]=c.useState(null),[n,f]=c.useState(!0),[m,g]=c.useState(null);c.useEffect(()=>{let x=!1;return(async()=>{try{const i=y(),d=await fetch("/api/admin/deploy/status",{headers:i?{Authorization:`Bearer ${i}`}:{}});if(!d.ok)throw new Error(`HTTP ${d.status}`);const j=await d.json();x||o(j)}catch(i){x||g(i?.message||"Failed to load deploy status")}finally{x||f(!1)}})(),()=>{x=!0}},[]);const y=()=>{try{const x=localStorage.getItem("osrx_auth_tokens");return x?JSON.parse(x).access_token:null}catch{return null}};return e.jsxs("div",{className:"border rounded-md p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Deploy Status"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:"Refresh"})]}),n&&e.jsx("div",{className:"text-sm text-gray-600",children:"Loading..."}),m&&e.jsx("div",{className:"text-sm text-red-700",children:m}),!n&&!m&&e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"border rounded p-3",children:[e.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Netlify"}),l?.warnings?.includes("netlify_not_configured")?e.jsx("div",{className:"text-gray-600",children:"Not configured (set NETLIFY_AUTH_TOKEN and NETLIFY_SITE_ID on the server)"}):l?.netlify?e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:["Status: ",e.jsx("span",{className:"font-mono",children:l.netlify.state})]}),e.jsxs("div",{children:["Commit: ",e.jsx("span",{className:"font-mono",children:l.netlify.commit_ref?.slice(0,7)||"n/a"})]}),e.jsxs("div",{children:["Updated: ",new Date(l.netlify.updated_at).toLocaleString()]}),l.netlify.deploy_ssl_url&&e.jsx("a",{className:"text-blue-600 hover:underline",href:l.netlify.deploy_ssl_url,target:"_blank",rel:"noreferrer",children:"View deploy"})]}):e.jsx("div",{className:"text-gray-600",children:"Status unavailable"})]}),e.jsxs("div",{className:"border rounded p-3",children:[e.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Render"}),l?.warnings?.includes("render_not_configured")?e.jsx("div",{className:"text-gray-600",children:"Not configured (set RENDER_API_KEY and RENDER_SERVICE_ID on the server)"}):l?.render?e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:["Status: ",e.jsx("span",{className:"font-mono",children:l.render.status||l.render.deploy?.status||"unknown"})]}),e.jsxs("div",{children:["Commit: ",e.jsx("span",{className:"font-mono",children:(l.render.commit||l.render.gitCommit)?.slice(0,7)||"n/a"})]}),e.jsxs("div",{children:["Updated: ",new Date(l.render.updatedAt||l.render.createdAt||Date.now()).toLocaleString()]}),l.render.url&&e.jsx("a",{className:"text-blue-600 hover:underline",href:l.render.url,target:"_blank",rel:"noreferrer",children:"View deploy"})]}):e.jsx("div",{className:"text-gray-600",children:"Status unavailable"})]})]}),!!l?.warnings?.length&&e.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:["Warnings: ",l.warnings.join(", ")]})]})},Fe=()=>{const[l,o]=c.useState(!1),[n,f]=c.useState(null),[m,g]=c.useState(!0),y=()=>{try{const s=_.exportFeedbackData(),r=new Blob([s],{type:"application/json"}),u=URL.createObjectURL(r),w=document.createElement("a");w.href=u,w.download=`oncosaferx-feedback-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(u)}catch(s){console.error("Error exporting data:",s)}},x=()=>{confirm("Are you sure you want to clear all feedback data? This action cannot be undone.")&&(_.clearFeedbackData(),i(),alert("Feedback data cleared successfully."))},i=async()=>{g(!0);try{const s=await _.getFeedbackAnalytics();f(s)}catch(s){console.error("Error loading analytics:",s),f({totalFeedback:0,totalTickets:0,recentFeedback:[],sprintPlan:{currentSprint:[],nextSprint:[],backlog:[]}})}finally{g(!1)}};O.useEffect(()=>{i(),j(),k()},[]);const{showToast:d}=ee(),j=async()=>{try{const s=a(),r=await fetch("/api/feedback/admin/migration-status",{headers:s?{Authorization:`Bearer ${s}`}:{}});if(r.ok){const u=await r.json();C(u)}}catch{}},k=async()=>{try{const s=a(),r=await fetch("/api/admin/rbac/seed-status",{headers:s?{Authorization:`Bearer ${s}`}:{}});if(r.ok){const u=await r.json();N(u)}}catch{}},v=async()=>{try{const s=a(),r=await fetch("/api/feedback/admin/migrate",{method:"POST",headers:{"Content-Type":"application/json",...s?{Authorization:`Bearer ${s}`}:{}},body:JSON.stringify({force:!0})});if(r.ok){const u=await r.json();await j(),d("success",`Migration complete: inserted ${u.inserted||0} item(s).`,4e3)}else d("error","Migration failed.",4e3)}catch{d("error","Migration error.",4e3)}},[S,C]=c.useState(null),[h,N]=c.useState(null),a=()=>{try{const s=localStorage.getItem("osrx_auth_tokens");return s?JSON.parse(s).access_token:null}catch{return null}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(se,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(D,{className:"w-6 h-6 mr-2"}),"Feedback Administration"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage user feedback, view analytics, and plan sprints based on automated ticket categorization."})]}),e.jsxs("div",{className:"flex space-x-3 items-center",children:[e.jsxs("div",{className:"hidden sm:flex items-center space-x-2 px-3 py-1 rounded-full border text-xs",title:"Feedback storage status",children:[e.jsx(G,{className:"w-3.5 h-3.5"}),S?.supabaseEnabled?e.jsx("span",{className:"text-green-700",children:"Supabase on"}):e.jsx("span",{className:"text-gray-700",children:"Supabase off"}),S?.ran&&e.jsxs("span",{className:"ml-2 inline-flex items-center",children:[e.jsx(ne,{className:"w-3.5 h-3.5 text-green-600 mr-1"}),"migrated ",S.inserted]}),!S?.ran&&S?.supabaseEnabled&&e.jsxs("span",{className:"ml-2 inline-flex items-center",children:[e.jsx(A,{className:"w-3.5 h-3.5 text-yellow-600 mr-1"}),"migration pending"]})]}),S?.supabaseEnabled&&e.jsxs("button",{onClick:v,className:"hidden sm:inline-flex items-center space-x-1 px-3 py-1 text-xs bg-gray-100 rounded hover:bg-gray-200",title:"Run in-memory → Supabase migration",children:[e.jsx(G,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"Migrate"})]}),e.jsxs("button",{onClick:y,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[e.jsx(M,{className:"w-4 h-4"}),e.jsx("span",{children:"Export Data"})]}),e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{children:"View Dashboard"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(b,{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-primary-600",children:m?"...":n?.totalFeedback||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Feedback"})]}),e.jsxs(b,{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:m?"...":n?.totalTickets||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Active Tickets"})]}),e.jsxs(b,{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:m?"...":n?.sprintPlan?.currentSprint?.length||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Current Sprint"})]}),e.jsxs(b,{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-600",children:m?"...":n?.sprintPlan?.nextSprint?.length||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Next Sprint"})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs(b,{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Automated Classification System"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Classification Features"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Automatic type detection (bug, feature, improvement, etc.)"}),e.jsx("li",{children:"• Priority assignment based on keywords and context"}),e.jsx("li",{children:"• Effort estimation for sprint planning"}),e.jsx("li",{children:"• Category mapping to product areas"}),e.jsx("li",{children:"• Label generation for better organization"})]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-green-900 mb-2",children:"Sprint Integration"}),e.jsxs("ul",{className:"text-sm text-green-800 space-y-1",children:[e.jsx("li",{children:"• Automatic sprint capacity calculation"}),e.jsx("li",{children:"• Priority-based ticket sorting"}),e.jsx("li",{children:"• Effort point distribution (XS: 1pt → XXL: 21pts)"}),e.jsx("li",{children:"• Backlog management with overflow handling"})]})]})]})]}),e.jsxs(b,{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Feedback Activity"}),e.jsxs("div",{className:"space-y-3",children:[!m&&n?.recentFeedback?.slice(0,5).map((s,r)=>e.jsxs("div",{className:"p-3 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-sm",children:s.title}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${s.priority==="critical"?"bg-red-100 text-red-800":s.priority==="high"?"bg-orange-100 text-orange-800":s.priority==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:s.priority})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.type," • ",s.category," • ",new Date(s.timestamp).toLocaleDateString()]})]},r)),m&&e.jsx("div",{className:"text-center text-gray-500 py-8",children:e.jsx("div",{className:"animate-pulse",children:"Loading recent feedback..."})}),!m&&(!n?.recentFeedback||n.recentFeedback.length===0)&&e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx(te,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No feedback submitted yet"})]})]})]})]}),e.jsx(be,{}),e.jsx(pe,{onConfigChange:i}),e.jsx(fe,{}),e.jsxs(b,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"RBAC Seeding Status"}),e.jsx("button",{onClick:k,className:"px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:"Refresh"})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800 mb-1",children:"Tenant"}),e.jsx("div",{className:"text-gray-600",children:h?.tenantId||"unknown"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800 mb-1",children:"IDs Assigned"}),e.jsx("div",{className:"text-gray-600",children:h?.totalAssigned??0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800 mb-1",children:"Emails Resolved/Unresolved"}),e.jsx("div",{className:"text-gray-600",children:h?`${h.totalResolved}/${h.totalUnresolved}`:"0/0"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mt-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Assigned User IDs"}),e.jsxs("ul",{className:"text-xs text-gray-600 space-y-1 max-h-36 overflow-auto border rounded p-2",children:[(h?.idsAssigned||[]).map((s,r)=>e.jsx("li",{className:"font-mono",children:s},r)),(!h?.idsAssigned||h.idsAssigned.length===0)&&e.jsx("li",{className:"text-gray-400",children:"None"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Resolved Emails"}),e.jsxs("ul",{className:"text-xs text-gray-600 space-y-1 max-h-36 overflow-auto border rounded p-2",children:[(h?.emailsResolved||[]).map((s,r)=>e.jsx("li",{children:s},r)),(!h?.emailsResolved||h.emailsResolved.length===0)&&e.jsx("li",{className:"text-gray-400",children:"None"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Unresolved Emails"}),e.jsxs("ul",{className:"text-xs text-gray-600 space-y-1 max-h-36 overflow-auto border rounded p-2",children:[(h?.emailsUnresolved||[]).map((s,r)=>e.jsx("li",{children:s},r)),(!h?.emailsUnresolved||h.emailsUnresolved.length===0)&&e.jsx("li",{className:"text-gray-400",children:"None"})]})]})]})]}),e.jsxs(b,{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Management"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-yellow-900 mb-2",children:"⚠️ Important Notes"}),e.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1",children:[e.jsx("li",{children:"• Feedback data is currently stored locally in browser localStorage"}),e.jsx("li",{children:"• In production, this should be connected to a backend API"}),e.jsx("li",{children:"• Data may be lost if browser storage is cleared"}),e.jsx("li",{children:"• Export data regularly for backup purposes"})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:y,className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200",children:"Export All Data"}),e.jsx("button",{onClick:i,className:"px-4 py-2 bg-green-100 text-green-700 rounded-md hover:bg-green-200",disabled:m,children:m?"Refreshing...":"Refresh Analytics"}),e.jsx("button",{onClick:x,className:"px-4 py-2 bg-red-100 text-red-700 rounded-md hover:bg-red-200",children:"Clear All Data"})]})]})]}),e.jsxs(b,{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(z,{className:"w-5 h-5 mr-2"}),"Sprint Planning Workflow"]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium text-green-900",children:"1. Collection"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("p",{children:"Users submit feedback through the floating feedback button throughout the application."}),e.jsxs("div",{className:"mt-2 p-2 bg-green-50 rounded",children:[e.jsx("strong",{children:"Automated:"})," Type detection, priority assignment, effort estimation"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium text-blue-900",children:"2. Classification"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("p",{children:"ML-style classification assigns tickets to appropriate categories and estimates work required."}),e.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded",children:[e.jsx("strong",{children:"Output:"})," Categorized tickets with priority, effort, and labels"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium text-purple-900",children:"3. Sprint Planning"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("p",{children:"Automated sprint capacity calculation distributes tickets across current and future sprints."}),e.jsxs("div",{className:"mt-2 p-2 bg-purple-50 rounded",children:[e.jsx("strong",{children:"Result:"})," Ready-to-implement sprint backlog"]})]})]})]})]}),e.jsx(he,{isOpen:l,onClose:()=>o(!1)})]})};export{Fe as default};
//# sourceMappingURL=FeedbackAdmin-CauKDcSZ.js.map
