const o={VIEW_VISITOR_ANALYTICS:{id:"view_visitor_analytics",name:"View Visitor Analytics",description:"Access visitor tracking and usage analytics",resource:"analytics",action:"read"},MANAGE_ANALYTICS:{id:"manage_analytics",name:"Manage Analytics",description:"Configure analytics settings and export data",resource:"analytics",action:"write"},VIEW_REALTIME_ANALYTICS:{id:"view_realtime_analytics",name:"View Real-time Analytics",description:"Access live visitor tracking and real-time metrics",resource:"analytics",action:"read"},ADMIN_CONSOLE_ACCESS:{id:"admin_console_access",name:"Admin Console Access",description:"Access administrative dashboard and controls",resource:"admin",action:"read"},MANAGE_USERS:{id:"manage_users",name:"Manage Users",description:"Create, update, and deactivate user accounts",resource:"users",action:"write"},MANAGE_ROLES:{id:"manage_roles",name:"Manage Roles",description:"Create and modify user roles and permissions",resource:"roles",action:"write"},VIEW_AUDIT_LOGS:{id:"view_audit_logs",name:"View Audit Logs",description:"Access system audit logs and compliance reports",resource:"audit",action:"read"},MANAGE_SYSTEM_SETTINGS:{id:"manage_system_settings",name:"Manage System Settings",description:"Configure system-wide settings and preferences",resource:"system",action:"write"},VIEW_PATIENT_DATA:{id:"view_patient_data",name:"View Patient Data",description:"Access patient information and medical records",resource:"patients",action:"read"},EDIT_PATIENT_DATA:{id:"edit_patient_data",name:"Edit Patient Data",description:"Modify patient information and medical records",resource:"patients",action:"write"},PRESCRIBE_MEDICATIONS:{id:"prescribe_medications",name:"Prescribe Medications",description:"Create and modify medication prescriptions",resource:"prescriptions",action:"write"},VIEW_DRUG_INTERACTIONS:{id:"view_drug_interactions",name:"View Drug Interactions",description:"Access drug interaction checking tools",resource:"interactions",action:"read"},ACCESS_PROTOCOLS:{id:"access_protocols",name:"Access Clinical Protocols",description:"View clinical protocols and treatment guidelines",resource:"protocols",action:"read"},MANAGE_PROTOCOLS:{id:"manage_protocols",name:"Manage Clinical Protocols",description:"Create and modify clinical protocols",resource:"protocols",action:"write"},GENERATE_REPORTS:{id:"generate_reports",name:"Generate Reports",description:"Create and export various system reports",resource:"reports",action:"write"},VIEW_COMPLIANCE_REPORTS:{id:"view_compliance_reports",name:"View Compliance Reports",description:"Access regulatory compliance and audit reports",resource:"compliance",action:"read"},MANAGE_FEEDBACK:{id:"manage_feedback",name:"Manage Feedback",description:"Access feedback admin, triage, and integrations",resource:"feedback",action:"write"}},n={SUPER_ADMIN:{id:"super_admin",name:"Super Administrator",description:"Full system access with all privileges",permissions:Object.keys(o),hierarchy:100,isSystemRole:!0},SYSTEM_ADMIN:{id:"system_admin",name:"System Administrator",description:"Administrative access to system management and analytics",permissions:["admin_console_access","view_visitor_analytics","manage_analytics","view_realtime_analytics","manage_users","manage_roles","view_audit_logs","manage_system_settings","generate_reports","view_compliance_reports","manage_feedback"],hierarchy:90,isSystemRole:!0},ANALYTICS_ADMIN:{id:"analytics_admin",name:"Analytics Administrator",description:"Specialized role for analytics and reporting management",permissions:["view_visitor_analytics","manage_analytics","view_realtime_analytics","generate_reports","view_compliance_reports","view_audit_logs"],hierarchy:70,isSystemRole:!0},ONCOLOGIST:{id:"oncologist",name:"Oncologist",description:"Medical oncology specialist with full clinical access",permissions:["view_patient_data","edit_patient_data","prescribe_medications","view_drug_interactions","access_protocols","manage_protocols","generate_reports","admin_console_access","view_visitor_analytics","manage_analytics"],hierarchy:60,isSystemRole:!0},PHARMACIST:{id:"pharmacist",name:"Pharmacist",description:"Pharmaceutical specialist with medication management access",permissions:["view_patient_data","edit_patient_data","prescribe_medications","view_drug_interactions","access_protocols","generate_reports"],hierarchy:50,isSystemRole:!0},NURSE:{id:"nurse",name:"Nurse",description:"Nursing professional with patient care access",permissions:["view_patient_data","edit_patient_data","view_drug_interactions","access_protocols"],hierarchy:40,isSystemRole:!0},RESEARCHER:{id:"researcher",name:"Researcher",description:"Research professional with data analysis access",permissions:["view_patient_data","view_drug_interactions","access_protocols","generate_reports"],hierarchy:30,isSystemRole:!0},STUDENT:{id:"student",name:"Student",description:"Educational access with limited permissions",permissions:["view_drug_interactions","access_protocols"],hierarchy:10,isSystemRole:!0}};class l{hasPermission(e,s){return e.permissions?.includes(s)?!0:e.roles?.some(i=>{const t=n[i.toUpperCase()];return t&&t.permissions.includes(s)})??!1}hasAnyPermission(e,s){return s.some(i=>this.hasPermission(e,i))}hasAllPermissions(e,s){return s.every(i=>this.hasPermission(e,i))}hasRole(e,s){return e.roles?.includes(s)??!1}hasAnyRole(e,s){return s.some(i=>this.hasRole(e,i))}getUserHierarchyLevel(e){if(!e.roles||e.roles.length===0)return 0;const s=e.roles.map(i=>n[i.toUpperCase()]).filter(Boolean);return s.length>0?Math.max(...s.map(i=>i.hierarchy)):0}canAccessAdminConsole(e){return this.hasPermission(e,"admin_console_access")||this.hasAnyRole(e,["super_admin","system_admin","analytics_admin"])}canViewAnalytics(e){return this.hasPermission(e,"view_visitor_analytics")}canManageAnalytics(e){return this.hasPermission(e,"manage_analytics")}getRolePermissions(e){const s=n[e.toUpperCase()];return s?s.permissions.map(i=>o[i.toUpperCase()]).filter(Boolean):[]}getUserPermissions(e){const s=new Set;return e.permissions?.forEach(i=>s.add(i)),e.roles?.forEach(i=>{const t=n[i.toUpperCase()];t&&t.permissions.forEach(c=>s.add(c))}),Array.from(s).map(i=>o[i.toUpperCase()]).filter(Boolean)}canManageUser(e,s){const i=this.getUserHierarchyLevel(e),t=this.getUserHierarchyLevel(s);return i>t&&this.hasPermission(e,"manage_users")}generatePermissionMatrix(e){const s=n[e.toUpperCase()],i={};return Object.keys(o).forEach(t=>{i[t]=s?s.permissions.includes(t):!1}),i}}const r=new l,d=a=>a?{hasPermission:e=>r.hasPermission(a,e),hasRole:e=>r.hasRole(a,e),hasAnyRole:e=>r.hasAnyRole(a,e),canAccessAdminConsole:()=>r.canAccessAdminConsole(a),canViewAnalytics:()=>r.canViewAnalytics(a),canManageAnalytics:()=>r.canManageAnalytics(a),getUserPermissions:()=>r.getUserPermissions(a),getUserHierarchyLevel:()=>r.getUserHierarchyLevel(a)}:{hasPermission:()=>!1,hasRole:()=>!1,canAccessAdminConsole:()=>!1,canViewAnalytics:()=>!1,canManageAnalytics:()=>!1,getUserPermissions:()=>[],getUserHierarchyLevel:()=>0};export{n as R,d as u};
