{"version":3,"mappings":"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","names":["EnhancedDrugSearchBar","onDrugSelect","placeholder","showTooltips","allowMultiple","maxSuggestions","className","selection","useSelection","options","setOptions","useState","loading","setLoading","error","setError","searchHistory","setSearchHistory","FALLBACK_DRUGS","useEffect","history","err","addToHistory","useCallback","drug","newHistory","d","handleSearch","query","historyOptions","drugOptions","drugService","combined","q","fallbackOptions","name","handleDrugSelect","option","metaDrug","rxcui","__vitePreload","analytics","results","getSearchTips","jsxs","jsx","getClinicalTips","AutoComplete","Tooltip","AlertTriangle","Pill","CuratedInteractions","location","useLocation","navigate","useNavigate","setDrug","drugA","setDrugA","drugB","setDrugB","severity","setSeverity","resolveRx","setResolveRx","setResults","sortBy","setSortBy","sortDir","setSortDir","expanded","setExpanded","canEdit","showEditor","setShowEditor","form","setForm","load","data","interactionService","e","params","qDrug","qA","qB","qSev","qResolve","names","exportFile","format","url","apiBaseUrl","Card","Alert","LoadingSpinner","token","__vite_import_meta_env__","payload","s","resp","msg","a","b","aA","aB","bA","bB","rank","r","it","idx","sev","sevClass","Fragment","si","prev"],"ignoreList":[],"sources":["../../src/components/DrugSearch/EnhancedDrugSearchBar.tsx","../../src/pages/CuratedInteractions.tsx"],"sourcesContent":["import React, { useState, useCallback, useEffect } from 'react';\nimport { Pill, AlertTriangle } from 'lucide-react';\nimport AutoComplete, { AutoCompleteOption } from '../UI/AutoComplete';\nimport Tooltip from '../UI/Tooltip';\nimport { drugService } from '../../services/api';\nimport { useSelection } from '../../context/SelectionContext';\nimport { Drug } from '../../types';\n\ninterface EnhancedDrugSearchBarProps {\n  onDrugSelect: (drug: Drug) => void;\n  placeholder?: string;\n  showTooltips?: boolean;\n  allowMultiple?: boolean;\n  maxSuggestions?: number;\n  className?: string;\n}\n\nconst EnhancedDrugSearchBar: React.FC<EnhancedDrugSearchBarProps> = ({\n  onDrugSelect,\n  placeholder = \"Search for medications (e.g., aspirin, warfarin, pembrolizumab)...\",\n  showTooltips = true,\n  allowMultiple = false,\n  maxSuggestions = 10,\n  className = '',\n}) => {\n  const selection = useSelection();\n  const [options, setOptions] = useState<AutoCompleteOption[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [searchHistory, setSearchHistory] = useState<Drug[]>([]);\n\n  // Local fallback drug names when API is unavailable (e.g., offline/dev sandbox)\n  const FALLBACK_DRUGS = [\n    'aspirin', 'ibuprofen', 'acetaminophen', 'warfarin', 'clopidogrel',\n    'pembrolizumab', 'nivolumab', 'fluorouracil', 'capecitabine', 'paclitaxel',\n    'cisplatin', 'carboplatin', 'doxorubicin', 'imatinib', 'tamoxifen',\n    'metformin', 'atorvastatin', 'amlodipine', 'omeprazole', 'hydrochlorothiazide',\n  ];\n\n  // Load search history from localStorage\n  useEffect(() => {\n    try {\n      const history = localStorage.getItem('oncosaferx_search_history');\n      if (history) {\n        setSearchHistory(JSON.parse(history).slice(0, 5)); // Keep last 5 searches\n      }\n    } catch (err) {\n      console.warn('Failed to load search history:', err);\n    }\n  }, []);\n\n  // Save to search history\n  const addToHistory = useCallback((drug: Drug) => {\n    const newHistory = [\n      drug,\n      ...searchHistory.filter(d => d.rxcui !== drug.rxcui)\n    ].slice(0, 5);\n    \n    setSearchHistory(newHistory);\n    \n    try {\n      localStorage.setItem('oncosaferx_search_history', JSON.stringify(newHistory));\n    } catch (err) {\n      console.warn('Failed to save search history:', err);\n    }\n  }, [searchHistory]);\n\n  // Search drugs with debouncing\n  const handleSearch = useCallback(async (query: string) => {\n    if (query.length < 2) {\n      // Show recent searches for short queries\n      const historyOptions: AutoCompleteOption[] = searchHistory.map(drug => ({\n        value: drug.rxcui,\n        label: drug.name,\n        description: `RXCUI: ${drug.rxcui}${drug.tty ? ` • ${drug.tty}` : ''}`,\n        category: 'Recent Searches',\n        metadata: drug,\n      }));\n      setOptions(historyOptions);\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const results = await drugService.searchDrugs(query);\n      \n      const drugOptions: AutoCompleteOption[] = results.results.slice(0, maxSuggestions).map((drug: Drug) => ({\n        value: drug.rxcui,\n        label: drug.name,\n        description: `RXCUI: ${drug.rxcui}${drug.tty ? ` • ${drug.tty}` : ''}`,\n        category: drug.tty || 'Medications',\n        metadata: drug,\n      }));\n\n      // Add history options if query is short\n      const historyOptions: AutoCompleteOption[] = query.length < 4 ? \n        searchHistory\n          .filter((drug: Drug) => drug.name.toLowerCase().includes(query.toLowerCase()))\n          .map((drug: Drug) => ({\n            value: drug.rxcui,\n            label: drug.name,\n            description: `RXCUI: ${drug.rxcui}${drug.tty ? ` • ${drug.tty}` : ''}`,\n            category: 'Recent Searches',\n            metadata: drug,\n          })) : [];\n      const combined = [...historyOptions, ...drugOptions];\n\n      // If no results from API, use a local fallback list filtered by query\n      if (combined.length === 0) {\n        const q = query.toLowerCase();\n        const fallbackOptions: AutoCompleteOption[] = FALLBACK_DRUGS\n          .filter((name) => name.includes(q))\n          .slice(0, maxSuggestions)\n          .map((name) => ({\n            value: name,\n            label: name,\n            description: 'Local suggestion',\n            category: 'Suggestions',\n            metadata: undefined,\n          }));\n        setOptions(fallbackOptions);\n      } else {\n        setOptions(combined);\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to search drugs');\n      // On error, also provide fallback suggestions\n      const q = query.toLowerCase();\n      const fallbackOptions: AutoCompleteOption[] = FALLBACK_DRUGS\n        .filter((name) => name.includes(q))\n        .slice(0, maxSuggestions)\n        .map((name) => ({\n          value: name,\n          label: name,\n          description: 'Local suggestion',\n          category: 'Suggestions',\n          metadata: undefined,\n        }));\n      setOptions(fallbackOptions);\n    } finally {\n      setLoading(false);\n    }\n  }, [searchHistory, maxSuggestions]);\n\n  // Handle drug selection\n  const handleDrugSelect = async (option: AutoCompleteOption) => {\n    const metaDrug = option.metadata as Drug | undefined;\n    if (metaDrug) {\n      addToHistory(metaDrug);\n      selection.addDrug(metaDrug);\n      try { const { rxcui, name } = metaDrug; (await import('../../utils/analytics')).analytics.logSelection(rxcui, name, 'autocomplete'); } catch {}\n      onDrugSelect(metaDrug);\n      return;\n    }\n    // Resolve fallback suggestion via API by full label\n    try {\n      const results = await drugService.searchDrugs(option.label);\n      if (results.count > 0) {\n        const drug = results.results[0] as Drug;\n        addToHistory(drug);\n        selection.addDrug(drug);\n        try { const { rxcui, name } = drug; (await import('../../utils/analytics')).analytics.logSelection(rxcui, name, 'autocomplete'); } catch {}\n        onDrugSelect(drug);\n      }\n    } catch (e) {\n      // ignore resolution failure\n    }\n  };\n\n  // Get search tips for tooltip\n  const getSearchTips = () => (\n    <div className=\"space-y-2 text-xs\">\n      <div className=\"font-semibold\">Search Tips:</div>\n      <ul className=\"space-y-1 list-disc list-inside\">\n        <li>Search by generic name (e.g., \"aspirin\")</li>\n        <li>Search by brand name (e.g., \"Tylenol\")</li>\n        <li>Use partial names (e.g., \"pembro\" for pembrolizumab)</li>\n        <li>Case doesn't matter (e.g., \"WARFARIN\" = \"warfarin\")</li>\n      </ul>\n      <div className=\"mt-2 pt-2 border-t border-gray-200\">\n        <div className=\"font-semibold\">Drug Types Supported:</div>\n        <div className=\"text-gray-600\">Oncology drugs, supportive care, anticoagulants, and more</div>\n      </div>\n    </div>\n  );\n\n  // Get clinical safety tooltip\n  const getClinicalTips = () => (\n    <div className=\"space-y-2 text-xs\">\n      <div className=\"font-semibold text-amber-200\">Clinical Safety:</div>\n      <ul className=\"space-y-1 list-disc list-inside\">\n        <li>Always verify drug selection</li>\n        <li>Check for interaction alerts</li>\n        <li>Consider patient-specific factors</li>\n        <li>Consult clinical guidelines</li>\n      </ul>\n      <div className=\"mt-2 pt-2 border-t border-amber-200\">\n        <div className=\"text-amber-200\">This tool supports clinical decision-making but does not replace professional judgment</div>\n      </div>\n    </div>\n  );\n\n  return (\n    <div className={`relative ${className}`}>\n      <div className=\"flex items-center space-x-2\">\n        <div className=\"flex-1\">\n          <AutoComplete\n            options={options}\n            placeholder={placeholder}\n            onSelect={handleDrugSelect}\n            onSearch={handleSearch}\n            loading={loading}\n            caseSensitive={false}\n            highlightMatches={true}\n            groupByCategory={true}\n            maxResults={maxSuggestions}\n            minChars={2}\n            debounceMs={300}\n            allowCustom={false}\n            noResultsText=\"No medications found. Try a different search term.\"\n            searchKeys={['label', 'description']}\n            className=\"w-full\"\n            dropdownClassName=\"border-2 border-blue-200\"\n            disableFiltering={true}\n          />\n        </div>\n\n        {showTooltips && (\n          <div className=\"flex items-center space-x-1\">\n            <Tooltip\n              content={getSearchTips()}\n              type=\"help\"\n              iconOnly\n              position=\"bottom-right\"\n              maxWidth=\"max-w-sm\"\n            />\n            \n            <Tooltip\n              content={getClinicalTips()}\n              type=\"clinical\"\n              iconOnly\n              position=\"bottom-right\"\n              maxWidth=\"max-w-sm\"\n            >\n              <AlertTriangle className=\"w-4 h-4 text-purple-600\" />\n            </Tooltip>\n          </div>\n        )}\n      </div>\n\n      {error && (\n        <div className=\"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg\">\n          <div className=\"flex items-center space-x-2\">\n            <AlertTriangle className=\"w-4 h-4 text-red-500 flex-shrink-0\" />\n            <span className=\"text-sm text-red-700\">{error}</span>\n          </div>\n        </div>\n      )}\n\n      {/* Recent searches indicator */}\n      {searchHistory.length > 0 && (\n        <div className=\"mt-2 flex items-center text-xs text-gray-500\">\n          <Pill className=\"w-3 h-3 mr-1\" />\n          <span>Recent: {searchHistory.slice(0, 3).map((d: Drug) => d.name).join(', ')}</span>\n          {searchHistory.length > 3 && <span> and {searchHistory.length - 3} more...</span>}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default EnhancedDrugSearchBar;\n","import React, { useEffect, useState } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport { apiBaseUrl } from '../utils/env';\nimport { interactionService } from '../services/api';\nimport Card from '../components/UI/Card';\nimport Alert from '../components/UI/Alert';\nimport LoadingSpinner from '../components/UI/LoadingSpinner';\nimport { useSelection } from '../context/SelectionContext';\nimport EnhancedDrugSearchBar from '../components/DrugSearch/EnhancedDrugSearchBar';\n\ntype KnownInteraction = {\n  drugs: string[];\n  severity: string;\n  mechanism?: string;\n  effect?: string;\n  management?: string;\n  evidence_level?: string;\n  sources?: string[];\n  drug_rxnorm?: { name: string; rxcui: string | null }[];\n};\n\nconst CuratedInteractions: React.FC = () => {\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  const [drug, setDrug] = useState('');\n  const [drugA, setDrugA] = useState('');\n  const [drugB, setDrugB] = useState('');\n  const [severity, setSeverity] = useState('');\n  const [resolveRx, setResolveRx] = useState(true);\n  const [results, setResults] = useState<{ count: number; total: number; interactions: KnownInteraction[] } | null>(null);\n  const [sortBy, setSortBy] = useState<'drugA'|'drugB'|'severity'>('severity');\n  const [sortDir, setSortDir] = useState<'asc'|'desc'>('desc');\n  const [expanded, setExpanded] = useState<Record<number, boolean>>({});\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const selection = useSelection();\n  // Editor visibility without requiring AuthProvider; opt-in via localStorage\n  const canEdit = typeof window !== 'undefined' && (localStorage.getItem('allow_curated_editor') === '1');\n  const [showEditor, setShowEditor] = useState(false);\n  const [form, setForm] = useState({ a: '', b: '', severity: 'moderate', mechanism: '', effect: '', management: '', evidence_level: '', sources: '' });\n\n  const load = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const data = await interactionService.getKnownInteractions({ drug, drugA, drugB, severity, resolveRx: resolveRx ? 'true' : 'false' });\n      setResults({ count: data.count, total: data.total, interactions: data.interactions || [] });\n      \n      // Show info message if using fallback data\n      if (data.message && data.message.includes('cached interaction data')) {\n        console.info('Using fallback interaction data - API not available');\n      }\n    } catch (e) {\n      setError(e instanceof Error ? e.message : 'Failed to load curated interactions');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Parse query params and update state\n  useEffect(() => {\n    const params = new URLSearchParams(location.search);\n    const qDrug = params.get('drug') || '';\n    const qA = params.get('drugA') || '';\n    const qB = params.get('drugB') || '';\n    const qSev = params.get('severity') || '';\n    const qResolve = params.get('resolveRx');\n\n    setDrug(qDrug);\n    setDrugA(qA);\n    setDrugB(qB);\n    setSeverity(qSev);\n    setResolveRx(qResolve ? qResolve === 'true' : true);\n  }, [location.search]);\n\n  // Prefill from global selection if available and no query params\n  useEffect(() => {\n    if (!drug && selection.selectedDrugs.length > 0) {\n      const names = selection.selectedDrugs.map(d => d.name);\n      setDrug(names[0] || '');\n      setDrugA(names[0] || '');\n      setDrugB(names[1] || '');\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Load whenever filters change OR on initial mount\n  useEffect(() => {\n    load();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [drug, drugA, drugB, severity, resolveRx]);\n\n  // Trigger initial load after component mount and state initialization\n  useEffect(() => {\n    // Load data immediately on mount\n    load();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const exportFile = (format: 'csv' | 'tsv') => {\n    const params = new URLSearchParams();\n    if (drug) params.set('drug', drug);\n    if (drugA) params.set('drugA', drugA);\n    if (drugB) params.set('drugB', drugB);\n    if (severity) params.set('severity', severity);\n    if (resolveRx) params.set('resolveRx', 'true');\n    params.set('view', format);\n    const url = `${apiBaseUrl()}/interactions/known?${params.toString()}`;\n    window.open(url, '_blank');\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h1 className=\"text-2xl font-bold text-gray-900\">Curated Drug Interactions</h1>\n        <div className=\"flex items-center space-x-2\">\n          <button onClick={() => exportFile('csv')} className=\"px-3 py-2 bg-primary-600 text-white rounded-md\">Export CSV</button>\n          <button onClick={() => exportFile('tsv')} className=\"px-3 py-2 bg-gray-700 text-white rounded-md\">Export TSV</button>\n          {canEdit && (\n            <button onClick={() => setShowEditor(true)} className=\"px-3 py-2 bg-emerald-600 text-white rounded-md\">Add Curated</button>\n          )}\n        </div>\n      </div>\n\n      <Card>\n        <div className=\"grid md:grid-cols-5 gap-4\">\n          <div>\n            <label className=\"block text-sm text-gray-700 mb-1\">Drug</label>\n            <EnhancedDrugSearchBar\n              onDrugSelect={(d) => setDrug(d.name)}\n              placeholder=\"Search or select a drug (e.g., aspirin)\"\n              showTooltips={false}\n              className=\"w-full\"\n            />\n          </div>\n          <div>\n            <label className=\"block text-sm text-gray-700 mb-1\">Drug A</label>\n            <EnhancedDrugSearchBar\n              onDrugSelect={(d) => setDrugA(d.name)}\n              placeholder=\"Search or select Drug A\"\n              showTooltips={false}\n              className=\"w-full\"\n            />\n          </div>\n          <div>\n            <label className=\"block text-sm text-gray-700 mb-1\">Drug B</label>\n            <EnhancedDrugSearchBar\n              onDrugSelect={(d) => setDrugB(d.name)}\n              placeholder=\"Search or select Drug B\"\n              showTooltips={false}\n              className=\"w-full\"\n            />\n          </div>\n          <div>\n            <label className=\"block text-sm text-gray-700 mb-1\">Severity</label>\n            <select value={severity} onChange={e => setSeverity(e.target.value)} className=\"w-full border rounded-md px-3 py-2\">\n              <option value=\"\">Any</option>\n              <option value=\"major\">Major</option>\n              <option value=\"moderate\">Moderate</option>\n              <option value=\"minor\">Minor</option>\n            </select>\n          </div>\n          <div className=\"flex items-end\">\n            <label className=\"inline-flex items-center space-x-2\">\n              <input type=\"checkbox\" checked={resolveRx} onChange={e => setResolveRx(e.target.checked)} />\n              <span className=\"text-sm text-gray-700\">Resolve RXCUIs</span>\n            </label>\n          </div>\n        </div>\n        <div className=\"mt-4 flex items-center space-x-2\">\n          <button onClick={load} className=\"px-4 py-2 bg-primary-600 text-white rounded-md\">Search</button>\n          <button\n            onClick={() => {\n              const params = new URLSearchParams();\n              if (drug) params.set('drug', drug);\n              if (drugA) params.set('drugA', drugA);\n              if (drugB) params.set('drugB', drugB);\n              if (severity) params.set('severity', severity);\n              if (resolveRx) params.set('resolveRx', 'true');\n              navigate({ pathname: '/curated', search: params.toString() ? `?${params.toString()}` : '' });\n            }}\n            className=\"px-3 py-2 bg-gray-100 text-gray-700 rounded-md\"\n          >\n            Shareable Link\n          </button>\n        </div>\n      </Card>\n\n      {error && <Alert type=\"error\" title=\"Error\">{error}</Alert>}\n      {loading && <div className=\"py-8 flex justify-center\"><LoadingSpinner /></div>}\n\n      {/* Editor Modal */}\n      {showEditor && (\n        <div className=\"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4\">\n          <div className=\"bg-white rounded-lg shadow-lg w-full max-w-2xl p-4\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <h3 className=\"text-lg font-semibold\">Add Curated Interaction</h3>\n              <button onClick={() => setShowEditor(false)} className=\"text-gray-600\">✕</button>\n            </div>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <div>\n                <label className=\"block text-xs text-gray-600 mb-1\">Drug A</label>\n                <input value={form.a} onChange={e => setForm({ ...form, a: e.target.value })} className=\"w-full border rounded px-2 py-1 text-sm\" placeholder=\"e.g., warfarin\" />\n              </div>\n              <div>\n                <label className=\"block text-xs text-gray-600 mb-1\">Drug B</label>\n                <input value={form.b} onChange={e => setForm({ ...form, b: e.target.value })} className=\"w-full border rounded px-2 py-1 text-sm\" placeholder=\"e.g., aspirin\" />\n              </div>\n              <div>\n                <label className=\"block text-xs text-gray-600 mb-1\">Severity</label>\n                <select value={form.severity} onChange={e => setForm({ ...form, severity: e.target.value })} className=\"w-full border rounded px-2 py-1 text-sm\">\n                  <option value=\"major\">major</option>\n                  <option value=\"moderate\">moderate</option>\n                  <option value=\"minor\">minor</option>\n                </select>\n              </div>\n              <div>\n                <label className=\"block text-xs text-gray-600 mb-1\">Evidence level</label>\n                <input value={form.evidence_level} onChange={e => setForm({ ...form, evidence_level: e.target.value })} className=\"w-full border rounded px-2 py-1 text-sm\" placeholder=\"e.g., A/B/C\" />\n              </div>\n              <div className=\"col-span-2\">\n                <label className=\"block text-xs text-gray-600 mb-1\">Mechanism</label>\n                <textarea value={form.mechanism} onChange={e => setForm({ ...form, mechanism: e.target.value })} className=\"w-full border rounded px-2 py-1 text-sm\" rows={2} />\n              </div>\n              <div className=\"col-span-2\">\n                <label className=\"block text-xs text-gray-600 mb-1\">Effect</label>\n                <textarea value={form.effect} onChange={e => setForm({ ...form, effect: e.target.value })} className=\"w-full border rounded px-2 py-1 text-sm\" rows={2} />\n              </div>\n              <div className=\"col-span-2\">\n                <label className=\"block text-xs text-gray-600 mb-1\">Management</label>\n                <textarea value={form.management} onChange={e => setForm({ ...form, management: e.target.value })} className=\"w-full border rounded px-2 py-1 text-sm\" rows={2} />\n              </div>\n              <div className=\"col-span-2\">\n                <label className=\"block text-xs text-gray-600 mb-1\">Sources (comma-separated or URLs)</label>\n                <input value={form.sources} onChange={e => setForm({ ...form, sources: e.target.value })} className=\"w-full border rounded px-2 py-1 text-sm\" />\n              </div>\n            </div>\n            <div className=\"mt-3 flex items-center justify-end gap-2\">\n              <button onClick={() => setShowEditor(false)} className=\"px-3 py-1.5 text-sm bg-gray-100 rounded\">Cancel</button>\n              <button\n                onClick={async () => {\n                  try {\n                    const token = localStorage.getItem('curated_admin_token') || String((import.meta as any)?.env?.VITE_CURATED_EDITOR_TOKEN || '');\n                    if (!token) { alert('Missing admin token. Set localStorage.curated_admin_token or VITE_CURATED_EDITOR_TOKEN.'); return; }\n                    const payload = {\n                      drugs: [form.a, form.b],\n                      severity: form.severity,\n                      mechanism: form.mechanism,\n                      effect: form.effect,\n                      management: form.management,\n                      evidence_level: form.evidence_level,\n                      sources: form.sources.split(',').map(s => s.trim()).filter(Boolean)\n                    };\n                    const resp = await fetch(`/api/interactions/known`, { method: 'POST', headers: { 'Content-Type': 'application/json', 'x-admin-token': token }, body: JSON.stringify(payload) });\n                    if (!resp.ok) {\n                      const msg = await resp.text();\n                      throw new Error(`Failed: ${resp.status} ${msg}`);\n                    }\n                    setShowEditor(false);\n                    load();\n                  } catch (e) {\n                    alert('Failed to add curated interaction');\n                  }\n                }}\n                className=\"px-3 py-1.5 text-sm bg-emerald-600 text-white rounded\"\n              >Save</button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {!loading && results && (\n        <Card>\n          <div className=\"flex items-center justify-between mb-4\">\n            <h2 className=\"text-lg font-semibold\">Results ({results.count}/{results.total})</h2>\n            <div className=\"text-xs text-gray-600 inline-flex items-center gap-2\">\n              <span>Sort:</span>\n              <select className=\"border rounded px-1 py-0.5\" value={sortBy} onChange={e => setSortBy(e.target.value as any)}>\n                <option value=\"severity\">Severity</option>\n                <option value=\"drugA\">Drug A</option>\n                <option value=\"drugB\">Drug B</option>\n              </select>\n              <button className=\"underline\" onClick={() => setSortDir(d => d==='asc'?'desc':'asc')}>{sortDir === 'asc' ? 'Asc' : 'Desc'}</button>\n            </div>\n          </div>\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full text-sm\">\n              <thead>\n                <tr className=\"text-left border-b\">\n                  <th className=\"py-2 pr-4 cursor-pointer\" onClick={() => setSortBy('drugA')}>Drug A</th>\n                  <th className=\"py-2 pr-4 cursor-pointer\" onClick={() => setSortBy('drugB')}>Drug B</th>\n                  <th className=\"py-2 pr-4 cursor-pointer\" onClick={() => setSortBy('severity')}>Severity</th>\n                  <th className=\"py-2 pr-4\">Effect</th>\n                  <th className=\"py-2 pr-4\">Management</th>\n                  <th className=\"py-2 pr-4\">Sources</th>\n                  <th className=\"py-2 pr-4\">Actions</th>\n                </tr>\n              </thead>\n              <tbody>\n                {results.interactions\n                  .slice()\n                  .sort((a, b) => {\n                    const aA = (a.drug_rxnorm?.[0]?.name || a.drugs?.[0] || '').toLowerCase();\n                    const aB = (a.drug_rxnorm?.[1]?.name || a.drugs?.[1] || '').toLowerCase();\n                    const bA = (b.drug_rxnorm?.[0]?.name || b.drugs?.[0] || '').toLowerCase();\n                    const bB = (b.drug_rxnorm?.[1]?.name || b.drugs?.[1] || '').toLowerCase();\n                    if (sortBy === 'drugA') return (sortDir==='asc' ? 1 : -1) * (aA > bA ? 1 : aA < bA ? -1 : 0);\n                    if (sortBy === 'drugB') return (sortDir==='asc' ? 1 : -1) * (aB > bB ? 1 : aB < bB ? -1 : 0);\n                    // severity order major > moderate > minor > unknown\n                    const rank = (s?: string) => ({ major: 3, high:3, moderate:2, minor:1, low:1 }[(s||'').toLowerCase()] || 0);\n                    const r = rank(a.severity) - rank(b.severity);\n                    return (sortDir==='asc' ? 1 : -1) * (r === 0 ? 0 : r);\n                  })\n                  .map((it, idx) => {\n                    const a = it.drug_rxnorm?.[0];\n                    const b = it.drug_rxnorm?.[1];\n                    const sev = (it.severity || '').toLowerCase();\n                    const sevClass = sev==='major'||sev==='high' ? 'bg-red-100 text-red-800' : sev==='moderate' ? 'bg-amber-100 text-amber-800' : 'bg-gray-100 text-gray-700';\n                    return (\n                    <>\n                      <tr key={idx} className=\"border-b align-top\">\n                        <td className=\"py-2 pr-4\">\n                          {a ? `${a.name} ${a.rxcui ? `(RXCUI ${a.rxcui})` : ''}` : it.drugs[0]}\n                        </td>\n                        <td className=\"py-2 pr-4\">\n                          {b ? `${b.name} ${b.rxcui ? `(RXCUI ${b.rxcui})` : ''}` : it.drugs[1]}\n                        </td>\n                        <td className=\"py-2 pr-4 capitalize\">\n                          <span className={`px-2 py-0.5 rounded text-xs ${sevClass}`}>{it.severity || 'unknown'}</span>\n                          {it.evidence_level && (\n                            <span className=\"ml-2 text-[11px] text-gray-500\">Evidence {it.evidence_level}</span>\n                          )}\n                        </td>\n                        <td className=\"py-2 pr-4\">{it.effect || '-'}</td>\n                        <td className=\"py-2 pr-4\">{it.management || '-'}</td>\n                        <td className=\"py-2 pr-4\">\n                          {Array.isArray(it.sources) && it.sources.length > 0 ? (\n                            <div className=\"flex flex-wrap gap-1\">\n                              {it.sources.map((s, si) => {\n                                const isUrl = /^https?:\\/\\//i.test(String(s));\n                                return isUrl ? (\n                                  <a key={si} href={String(s)} target=\"_blank\" rel=\"noreferrer\" className=\"text-blue-700 hover:underline text-xs\">Source</a>\n                                ) : (\n                                  <span key={si} className=\"text-xs text-gray-700 bg-gray-100 rounded px-2 py-0.5\">{s}</span>\n                                );\n                              })}\n                            </div>\n                          ) : '-'}\n                        </td>\n                        <td className=\"py-2 pr-4\">\n                          <div className=\"flex items-center gap-2\">\n                            <button\n                              className=\"text-xs text-primary-700 underline\"\n                              onClick={() => {\n                                if (a?.name) selection.addDrug({ name: a.name, rxcui: a.rxcui || '' } as any);\n                                if (b?.name) selection.addDrug({ name: b.name, rxcui: b.rxcui || '' } as any);\n                              }}\n                            >Add both</button>\n                            <button\n                              className=\"text-xs text-blue-700 underline\"\n                              onClick={() => {\n                                if (a?.name) selection.addDrug({ name: a.name, rxcui: a.rxcui || '' } as any);\n                                if (b?.name) selection.addDrug({ name: b.name, rxcui: b.rxcui || '' } as any);\n                                window.location.href = '/interactions';\n                              }}\n                            >Open checker</button>\n                            <button\n                              className=\"text-xs text-gray-700 underline\"\n                              onClick={() => setExpanded(prev => ({ ...prev, [idx]: !prev[idx] }))}\n                            >{expanded[idx] ? 'Hide' : 'Details'}</button>\n                          </div>\n                        </td>\n                      </tr>\n                      {expanded[idx] && (\n                        <tr className=\"border-b bg-gray-50\">\n                          <td colSpan={7} className=\"p-3\">\n                            <div className=\"grid md:grid-cols-3 gap-3 text-sm\">\n                              <div>\n                                <div className=\"text-gray-500 text-xs\">Mechanism</div>\n                                <div className=\"text-gray-800\">{it.mechanism || '-'}</div>\n                              </div>\n                              <div>\n                                <div className=\"text-gray-500 text-xs\">Effect</div>\n                                <div className=\"text-gray-800\">{it.effect || '-'}</div>\n                              </div>\n                              <div>\n                                <div className=\"text-gray-500 text-xs\">Management</div>\n                                <div className=\"text-gray-800\">{it.management || '-'}</div>\n                              </div>\n                            </div>\n                          </td>\n                        </tr>\n                      )}\n                    </>\n                  );})}\n              </tbody>\n            </table>\n          </div>\n        </Card>\n      )}\n    </div>\n  );\n};\n\nexport default CuratedInteractions;\n"],"file":"assets/CuratedInteractions-B_Y0wDYp.js"}