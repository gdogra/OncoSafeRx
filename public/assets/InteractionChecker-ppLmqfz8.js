import{u as ee,j as e,I as H,T as L,r as o,S as le,X as se,e as E,P as ce,h as te,B as W,A as oe,o as Q,a as Y,F as de,E as me,U as xe,p as he,f as ue}from"./index-Bhw970Mt.js";import{d as K,i as J}from"./api-BP-rjOFz.js";import{A as M}from"./Alert-Ce4CVrwB.js";import{L as re}from"./LoadingSpinner-DmXCsUX4.js";import{C as P}from"./Card-xxJ0N2iO.js";import{i as Z}from"./biomarkers-Bb0NK789.js";import{D as ge}from"./database-DVBy81T8.js";import{G as pe}from"./globe-BSKpiTHs.js";import{M as fe}from"./map-pinned-BZOyKss3.js";import{T as ye}from"./tag-C5vktzFW.js";import{P as je}from"./plus-S0wGj3RA.js";import{C as X}from"./circle-x-pntuk0KV.js";import{C as ve}from"./circle-check-big-BS3hXAhd.js";import{F as be}from"./FeatureErrorBoundary-DQef_fs0.js";import"./refresh-cw-CEIIBFss.js";const Ne=({results:C})=>{const p=r=>{switch(r.toLowerCase()){case"major":return e.jsx(L,{className:"w-5 h-5 text-red-600"});case"moderate":return e.jsx(L,{className:"w-5 h-5 text-yellow-600"});case"minor":return e.jsx(H,{className:"w-5 h-5 text-blue-600"});default:return e.jsx(H,{className:"w-5 h-5 text-gray-600"})}},n=r=>{switch(r.toLowerCase()){case"major":return"border-l-red-500 bg-red-50";case"moderate":return"border-l-yellow-500 bg-yellow-50";case"minor":return"border-l-blue-500 bg-blue-50";default:return"border-l-gray-500 bg-gray-50"}},f=r=>{if(!r)return"bg-gray-100 text-gray-700";switch(r.toUpperCase()){case"A":return"bg-green-100 text-green-800";case"B":return"bg-blue-100 text-blue-800";case"C":return"bg-yellow-100 text-yellow-800";case"D":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-700"}},j=ee(),h=(r,u,m)=>e.jsx(P,{className:`border-l-4 ${n(r.severity)}`,padding:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[p(r.severity),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 capitalize",children:[r.severity," Interaction"]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[u==="stored"?e.jsx(ge,{className:"w-4 h-4 text-gray-400"}):e.jsx(pe,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:u==="stored"?"Database":"External Source"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[r.evidence_level&&e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${f(r.evidence_level)}`,children:["Evidence Level ",r.evidence_level]}),e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${r.severity==="major"?"bg-red-100 text-red-800":r.severity==="moderate"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:r.riskLevel||r.severity.toUpperCase()})]})]}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium text-gray-900",children:r.drug1?.name||`Drug ${r.drug1_rxcui}`}),e.jsxs("p",{className:"text-sm text-gray-500",children:["RXCUI: ",r.drug1_rxcui]})]}),e.jsx("div",{className:"text-2xl text-gray-400",children:"Ã—"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium text-gray-900",children:r.drug2?.name||`Drug ${r.drug2_rxcui}`}),e.jsxs("p",{className:"text-sm text-gray-500",children:["RXCUI: ",r.drug2_rxcui]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Effect"}),e.jsx("p",{className:"text-gray-700",children:r.effect})]}),r.mechanism&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Mechanism"}),e.jsx("p",{className:"text-gray-700",children:r.mechanism})]}),r.management&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Management"}),e.jsx("p",{className:"text-gray-700",children:r.management})]}),r.sources&&r.sources.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Sources"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.sources.map((k,D)=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-700",children:k},D))})]}),e.jsx("div",{children:e.jsxs("button",{type:"button",onClick:()=>{const k=r.drug1?.name,D=r.drug2?.name,c=Z(k||"")||Z(D||"");j(c?`/trials?biomarker=${encodeURIComponent(c)}`:"/trials")},className:"inline-flex items-center px-3 py-1.5 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"})," Find Trials"]})})]})]})},`${r.drug1_rxcui||"unknown"}-${r.drug2_rxcui||"unknown"}-${u}-${m}`),v=[...C.interactions.stored.map(r=>({...r,source:"stored"})),...C.interactions.external.map(r=>({...r,source:"external"}))],I=v.reduce((r,u)=>{const m=u.severity;return r[m]||(r[m]=[]),r[m].push(u),r},{}),S=["major","moderate","minor","unknown"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Detailed Interaction Analysis"}),v.length===0?e.jsx(M,{type:"success",title:"No Interactions Found",children:"No known interactions were detected between the selected medications."}):e.jsx("div",{className:"space-y-6",children:S.map(r=>{const u=I[r];return!u||u.length===0?null:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-3 capitalize flex items-center space-x-2",children:[p(r),e.jsxs("span",{children:[r," Interactions (",u.length,")"]})]}),e.jsx("div",{className:"space-y-4",children:u.map((m,k)=>h(m,m.source,k))})]},r)})})]}),e.jsx(M,{type:"warning",title:"Important Disclaimer",children:"This interaction checker is for informational purposes only and should not replace professional medical advice. Always consult with a healthcare provider before making any changes to your medication regimen."})]})},we=({onSearch:C,loading:p=!1,placeholder:n="Search drugs by name (e.g., aspirin, ibuprofen)...",value:f,onChange:j,inputId:h})=>{const[v,I]=o.useState(f||""),S=m=>{const k=m.target.value;I(k),j?.(k)},r=m=>{m.preventDefault(),v.trim()&&C(v.trim())},u=()=>{I(""),j?.("")};return e.jsx("form",{onSubmit:r,className:"w-full",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(le,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:h,type:"text",value:f!==void 0?f:v,onChange:S,onKeyDown:m=>{m.key==="Escape"&&(m.preventDefault(),u(),m.target.blur())},placeholder:n,className:"block w-full pl-10 pr-16 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm",disabled:p}),e.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center",children:[(f||v)&&!p&&e.jsx("button",{type:"button",onClick:u,className:"p-2 text-gray-400 hover:text-gray-600 focus:outline-none",children:e.jsx(se,{className:"h-4 w-4"})}),p?e.jsx("div",{className:"pr-3",children:e.jsx(re,{size:"sm"})}):e.jsx("button",{type:"submit",disabled:!v.trim(),className:"mr-2 px-4 py-2 bg-primary-600 text-white text-sm font-medium rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Search"})]})]})})},ke=[{term:"aspirin",label:"Aspirin",category:"Pain Relief"},{term:"ibuprofen",label:"Ibuprofen",category:"Pain Relief"},{term:"warfarin",label:"Warfarin",category:"Anticoagulant"},{term:"metformin",label:"Metformin",category:"Diabetes"},{term:"atorvastatin",label:"Atorvastatin",category:"Cholesterol"},{term:"omeprazole",label:"Omeprazole",category:"Acid Reducer"},{term:"lisinopril",label:"Lisinopril",category:"Blood Pressure"},{term:"amlodipine",label:"Amlodipine",category:"Blood Pressure"},{term:"levothyroxine",label:"Levothyroxine",category:"Thyroid"},{term:"clopidogrel",label:"Clopidogrel",category:"Antiplatelet"},{term:"fluorouracil",label:"Fluorouracil",category:"Oncology"},{term:"cisplatin",label:"Cisplatin",category:"Oncology"}],Ce=({onDrugSelect:C})=>{const[p,n]=o.useState(null),[f,j]=o.useState(!1),[h,v]=o.useState(null),[I,S]=o.useState(""),r=o.useCallback(async c=>{if(c.length<2){v("Please enter at least 2 characters");return}j(!0),v(null);try{const R=await K.searchDrugs(c);n(R)}catch(R){v(R instanceof Error?R.message:"Failed to search drugs"),n(null)}finally{j(!1)}},[]),u=c=>{C(c),n(null),S("")},m=c=>{S(c),r(c)},k=c=>e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsx("div",{className:"font-semibold",children:"Drug Information:"}),e.jsxs("div",{children:["RXCUI: ",c.rxcui]}),c.tty&&e.jsxs("div",{children:["Type: ",c.tty]}),e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-200",children:e.jsx("div",{className:"text-gray-300",children:"Click to add to interaction analysis"})})]}),D=()=>e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsx("div",{className:"font-semibold text-purple-200",children:"Clinical Considerations:"}),e.jsxs("ul",{className:"space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Verify drug name and strength"}),e.jsx("li",{children:"Check for generic/brand equivalents"}),e.jsx("li",{children:"Consider patient allergies"}),e.jsx("li",{children:"Review indication and dosing"})]})]});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Add Medication"}),e.jsx(E,{content:D(),type:"clinical",iconOnly:!0,position:"right"})]}),e.jsx(we,{onSearch:r,loading:f,placeholder:"Search for a medication to add...",value:I,onChange:S}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Quick Access:"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:ke.map(c=>e.jsxs("button",{onClick:()=>m(c.term),className:"flex flex-col items-start p-2 text-left border border-gray-200 rounded-md hover:bg-gray-50 hover:border-gray-300 transition-colors",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:c.label}),e.jsx("span",{className:"text-xs text-gray-500",children:c.category})]},c.term))})]}),h&&e.jsx(M,{type:"error",children:h}),p&&p.count>0&&e.jsxs("div",{className:"border border-gray-200 rounded-lg max-h-96 overflow-y-auto",children:[e.jsx("div",{className:"p-3 bg-gray-50 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["Found ",p.count,' results for "',p.query,'"']}),e.jsx(E,{content:"Click on any medication to add it to your interaction analysis",type:"info",iconOnly:!0,position:"left"})]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:p.results.slice(0,10).map(c=>e.jsx(E,{content:k(c),position:"right",maxWidth:"max-w-xs",children:e.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>u(c),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary-100 rounded-lg flex items-center justify-center",children:e.jsx(ce,{className:"w-4 h-4 text-primary-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:c.name}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["RXCUI: ",c.rxcui]}),c.tty&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:c.tty})]})]})]}),e.jsx(je,{className:"w-4 h-4 text-gray-400"})]})})},`${c.rxcui}-${c.tty}`))}),p.count>10&&e.jsx("div",{className:"p-3 bg-gray-50 border-t border-gray-200 text-center",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(te,{className:"w-4 h-4 text-gray-400"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Showing first 10 results. Refine your search for more specific results."})]})})]}),p&&p.count===0&&e.jsxs(M,{type:"info",children:['No drugs found matching "',p.query,'". Try a different search term.']})]})},Se=({selectedDrugs:C,onDrugRemove:p,patientProfile:n})=>{const[f,j]=o.useState([]),[h,v]=o.useState([]),[I,S]=o.useState(!1),[r,u]=o.useState("all"),[m,k]=o.useState("all"),D=[{id:"1",drug1:"Warfarin",drug2:"Fluorouracil",severity:"major",mechanism:"CYP2C9 inhibition",clinicalEffect:"Increased anticoagulant effect, risk of bleeding",recommendation:"Monitor INR closely, consider dose reduction",evidence:"established",references:["PMID: 12345678","PMID: 87654321"],alternatives:["Apixaban","Rivaroxaban"],monitoring:["INR weekly for 2 weeks","CBC weekly","Signs of bleeding"],doseAdjustment:"Reduce warfarin dose by 25-50%",onsetTime:"2-5 days",duration:"Throughout treatment",prevalence:85},{id:"2",drug1:"Metformin",drug2:"Iodinated contrast",severity:"moderate",mechanism:"Impaired renal clearance",clinicalEffect:"Risk of lactic acidosis",recommendation:"Hold metformin 48h before and after contrast",evidence:"probable",references:["PMID: 11111111"],monitoring:["Renal function","Lactate levels"],onsetTime:"Immediate",duration:"48-72 hours",prevalence:60},{id:"3",drug1:"Simvastatin",drug2:"Clarithromycin",severity:"major",mechanism:"CYP3A4 inhibition",clinicalEffect:"Increased risk of rhabdomyolysis",recommendation:"Avoid combination or use lowest statin dose",evidence:"established",references:["PMID: 22222222"],alternatives:["Pravastatin","Rosuvastatin"],monitoring:["CK levels","Muscle symptoms"],contraindicated:!0,onsetTime:"1-7 days",duration:"Throughout treatment",prevalence:75}];o.useEffect(()=>{C.length>=2?(S(!0),setTimeout(()=>{j(D),c(D),S(!1)},1e3)):(j([]),v([]))},[C]);const c=t=>{const d=[];t.forEach(x=>{x.contraindicated?d.push({type:"avoid",priority:"high",description:`Contraindicated combination: ${x.drug1} + ${x.drug2}`,action:"Consider alternative medications",rationale:x.clinicalEffect}):x.severity==="major"?(x.alternatives&&d.push({type:"consider_alternative",priority:"high",description:`High-risk interaction: ${x.drug1} + ${x.drug2}`,action:`Consider alternatives: ${x.alternatives.join(", ")}`,rationale:x.clinicalEffect}),x.monitoring&&d.push({type:"monitor",priority:"high",description:"Intensive monitoring required",action:x.monitoring.join(", "),rationale:"Major interaction with significant clinical consequences"})):x.severity==="moderate"&&d.push({type:"monitor",priority:"medium",description:`Moderate interaction: ${x.drug1} + ${x.drug2}`,action:x.recommendation,rationale:x.clinicalEffect}),x.doseAdjustment&&d.push({type:"adjust_dose",priority:x.severity==="major"?"high":"medium",description:"Dose adjustment recommended",action:x.doseAdjustment,rationale:x.mechanism})}),n?.renalFunction&&n.renalFunction!=="normal"&&d.push({type:"adjust_dose",priority:"medium",description:"Renal impairment detected",action:"Consider dose adjustments for renally eliminated drugs",rationale:`Patient has ${n.renalFunction} renal function`}),n?.hepaticFunction&&n.hepaticFunction!=="normal"&&d.push({type:"adjust_dose",priority:"medium",description:"Hepatic impairment detected",action:"Consider dose adjustments for hepatically metabolized drugs",rationale:`Patient has ${n.hepaticFunction} hepatic function`}),v(d)},R=o.useMemo(()=>f.filter(t=>!(r!=="all"&&t.severity!==r||m!=="all"&&t.evidence!==m)),[f,r,m]),$=o.useMemo(()=>{const t={major:0,moderate:0,minor:0};return f.forEach(d=>{t[d.severity]++}),t},[f]),B=t=>{switch(t){case"major":return"text-red-600 bg-red-50 border-red-200";case"moderate":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"minor":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},F=t=>{switch(t){case"major":return e.jsx(X,{className:"w-4 h-4"});case"moderate":return e.jsx(Q,{className:"w-4 h-4"});case"minor":return e.jsx(ve,{className:"w-4 h-4"});default:return e.jsx(L,{className:"w-4 h-4"})}},T=t=>{switch(t){case"established":return"text-blue-600 bg-blue-50";case"probable":return"text-indigo-600 bg-indigo-50";case"possible":return"text-purple-600 bg-purple-50";case"theoretical":return"text-gray-600 bg-gray-50";default:return"text-gray-600 bg-gray-50"}},z=t=>{switch(t){case"high":return"text-red-600 bg-red-50 border-red-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"low":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(P,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(L,{className:"w-6 h-6 text-primary-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Advanced Interaction Analysis"}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:"AI-Enhanced"})]})]}),I&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-primary-600 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Analyzing interactions..."})]})]}),f.length>0&&e.jsxs("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:$.major}),e.jsx("div",{className:"text-sm text-gray-500",children:"Major"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:$.moderate}),e.jsx("div",{className:"text-sm text-gray-500",children:"Moderate"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:$.minor}),e.jsx("div",{className:"text-sm text-gray-500",children:"Minor"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-600",children:h.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Recommendations"})]})]})]}),e.jsxs(P,{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Selected Medications (",C.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:C.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.name}),e.jsx("div",{className:"text-sm text-gray-500",children:t.genericName})]}),e.jsx("button",{onClick:()=>p(t.id),className:"text-gray-400 hover:text-red-500",children:e.jsx(X,{className:"w-4 h-4"})})]},t.id))})]}),h.length>0&&e.jsxs(P,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(W,{className:"w-5 h-5 text-primary-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Clinical Recommendations"})]}),e.jsx("div",{className:"space-y-3",children:h.map((t,d)=>e.jsx("div",{className:`p-4 rounded-lg border ${z(t.priority)}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs("div",{className:"flex-shrink-0 mt-1",children:[t.type==="avoid"&&e.jsx(X,{className:"w-5 h-5"}),t.type==="monitor"&&e.jsx(oe,{className:"w-5 h-5"}),t.type==="adjust_dose"&&e.jsx(Q,{className:"w-5 h-5"}),t.type==="consider_alternative"&&e.jsx(Y,{className:"w-5 h-5"}),t.type==="adjust_timing"&&e.jsx(te,{className:"w-5 h-5"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:t.description}),e.jsx("div",{className:"text-sm mt-1",children:t.action}),e.jsx("div",{className:"text-xs mt-2 opacity-75",children:t.rationale})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("span",{className:"text-xs font-medium px-2 py-1 rounded-full bg-white bg-opacity-50",children:t.priority.toUpperCase()})})]})},d))})]}),f.length>0&&e.jsxs(P,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Drug Interactions (",R.length,")"]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("select",{value:r,onChange:t=>u(t.target.value),className:"text-sm border-gray-300 rounded-md",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"major",children:"Major"}),e.jsx("option",{value:"moderate",children:"Moderate"}),e.jsx("option",{value:"minor",children:"Minor"})]}),e.jsxs("select",{value:m,onChange:t=>k(t.target.value),className:"text-sm border-gray-300 rounded-md",children:[e.jsx("option",{value:"all",children:"All Evidence Levels"}),e.jsx("option",{value:"established",children:"Established"}),e.jsx("option",{value:"probable",children:"Probable"}),e.jsx("option",{value:"possible",children:"Possible"}),e.jsx("option",{value:"theoretical",children:"Theoretical"})]})]})]}),e.jsx("div",{className:"space-y-4",children:R.map(t=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:`flex items-center space-x-1 px-3 py-1 rounded-full border ${B(t.severity)}`,children:[F(t.severity),e.jsx("span",{className:"text-sm font-medium capitalize",children:t.severity})]}),e.jsxs("div",{className:`px-3 py-1 rounded-full text-xs font-medium ${T(t.evidence)}`,children:[t.evidence.charAt(0).toUpperCase()+t.evidence.slice(1)," Evidence"]}),t.contraindicated&&e.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium text-red-600 bg-red-100",children:"CONTRAINDICATED"})]}),t.prevalence&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Prevalence: ",t.prevalence,"%"]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Interaction Details"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Drugs:"})," ",t.drug1," + ",t.drug2]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Mechanism:"})," ",t.mechanism]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Clinical Effect:"})," ",t.clinicalEffect]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Recommendation:"})," ",t.recommendation]}),t.onsetTime&&e.jsxs("div",{children:[e.jsx("strong",{children:"Onset:"})," ",t.onsetTime]}),t.duration&&e.jsxs("div",{children:[e.jsx("strong",{children:"Duration:"})," ",t.duration]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Clinical Management"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[t.alternatives&&e.jsxs("div",{children:[e.jsx("strong",{children:"Alternatives:"}),e.jsx("div",{className:"mt-1 space-x-2",children:t.alternatives.map(d=>e.jsx("span",{className:"inline-block px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs",children:d},d))})]}),t.monitoring&&e.jsxs("div",{children:[e.jsx("strong",{children:"Monitoring:"}),e.jsx("ul",{className:"mt-1 space-y-1",children:t.monitoring.map(d=>e.jsxs("li",{className:"text-xs",children:["â€¢ ",d]},d))})]}),t.doseAdjustment&&e.jsxs("div",{children:[e.jsx("strong",{children:"Dose Adjustment:"})," ",t.doseAdjustment]})]})]})]}),t.references&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(de,{className:"w-4 h-4"}),e.jsx("span",{children:"References:"}),t.references.map(d=>e.jsxs("a",{href:`https://pubmed.ncbi.nlm.nih.gov/${d.replace("PMID: ","")}`,target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-700 flex items-center space-x-1",children:[e.jsx("span",{children:d}),e.jsx(me,{className:"w-3 h-3"})]},d))]})})]},t.id))})]}),n&&e.jsxs(P,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(xe,{className:"w-5 h-5 text-primary-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Patient-Specific Considerations"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Demographics"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[n.age&&e.jsxs("div",{children:["Age: ",n.age," years"]}),n.weight&&e.jsxs("div",{children:["Weight: ",n.weight," kg"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Organ Function"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{children:["Renal: ",n.renalFunction||"Normal"]}),e.jsxs("div",{children:["Hepatic: ",n.hepaticFunction||"Normal"]})]})]})]}),n.comorbidities&&n.comorbidities.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Comorbidities"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.comorbidities.map(t=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-sm",children:t},t))})]})]}),C.length<2&&e.jsx(P,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Y,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select Multiple Medications"}),e.jsx("p",{className:"text-gray-500",children:"Add at least 2 medications to check for potential drug interactions"})]})})]})},Ie=()=>{const C=ee(),[p]=he(),[n,f]=o.useState([]),j=ue(),[h,v]=o.useState(null),[I,S]=o.useState(!1),[r,u]=o.useState(null),[m,k]=o.useState(!1),[D,c]=o.useState(null),[R,$]=o.useState(null),[B,F]=o.useState(null),[T,z]=o.useState(null),[t,d]=o.useState(!1),[x,O]=o.useState(!1),q=(s,a,l)=>{if(!Array.isArray(s))return s;let b=s;return a&&(b=b.filter(y=>y.formulary==="likely-covered")),l&&(b=b.filter(y=>y.best===!0)),b};o.useEffect(()=>{try{const s=localStorage.getItem("pgxPhenotypes");s&&c(JSON.parse(s))}catch{}},[]),o.useEffect(()=>{n.length===0&&j.selectedDrugs.length>0&&f(j.selectedDrugs)},[n.length,j.selectedDrugs]),o.useEffect(()=>{const s=p.get("drug");s&&n.length===0&&K.getDrugDetails(s).then(a=>{f([a]),j.addDrug(a)}).catch(()=>{K.searchDrugs(s).then(a=>{if(a.results&&a.results.length>0){const l=a.results[0];f([l]),j.addDrug(l)}}).catch(a=>{console.warn("Failed to load drug from URL parameter:",a)})})},[p,n.length,j]);const ae=s=>{const a=new Set;let l=s;const b=l.match(/\([^)]*\)/g)||[],y=l.match(/\{[^}]*\}/g)||[],w=[...b,...y,l];for(const N of w){const g=N.replace(/[{}()]/g,"").split(/[\/,\+]|Pack|\s+and\s+|\s+or\s+/);for(let i of g)i=i.replace(/\s*\d+(\.\d+)?\s*(MG|mg|ML|ml|mcg|units?|IU|%)\b.*$/i,""),i=i.replace(/\s*\[.*?\]/g,""),i=i.trim().toLowerCase(),!(!i||i.length<3)&&(["oral","tablet","capsule","solution","suspension","injection","pack","strength","extra","triple","action","pain","reliever"].includes(i)||((i.includes("acetaminophen")||i.includes("paracetamol"))&&a.add("acetaminophen"),i.includes("aspirin")&&a.add("aspirin"),i.includes("caffeine")&&a.add("caffeine"),i.includes("diphenhydramine")&&a.add("diphenhydramine"),i.includes("warfarin")&&a.add("warfarin"),i.includes("lisinopril")&&a.add("lisinopril"),i.includes("amlodipine")&&a.add("amlodipine"),i.includes("fluorouracil")&&a.add("fluorouracil"),i.includes("perindopril")&&a.add("perindopril"),i.includes("ibuprofen")&&a.add("ibuprofen"),i.includes("naproxen")&&a.add("naproxen"),a.size===0&&i.match(/^[a-z]{4,}$/)&&a.add(i)))}return Array.from(a)},ne=s=>{n.find(a=>a.rxcui===s.rxcui)||(f([...n,s]),j.addDrug(s),v(null),F(null),z(null),d(!1),O(!1))},V=s=>{f(n.filter(a=>a.rxcui!==s)),v(null),F(null),z(null),d(!1),O(!1)},ie=async()=>{if(n.length<2){u("Please select at least 2 drugs to check for interactions");return}S(!0),u(null);try{let s;try{if(console.log("Trying primary interaction check endpoint..."),s=await J.checkInteractions(n.map(l=>({rxcui:l.rxcui,name:l.name}))),console.log("Primary endpoint result:",s),!(s?.interactions?.stored?.length>0||s?.interactions?.external?.length>0))throw console.log("Primary endpoint returned no interactions, triggering fallback..."),new Error("No interactions found via primary endpoint")}catch{console.warn("Primary interaction check failed, using curated data fallback");const l=[],b=[];n.forEach(w=>{const N=ae(w.name);console.log(`Extracted from "${w.name}":`,N),b.push(...N)});const y=Array.from(new Set(b));console.log("All unique drug names:",y);for(let w=0;w<y.length;w++)for(let N=w+1;N<y.length;N++){const A=y[w],g=y[N];try{const i=await J.getKnownInteractions({drugA:A,drugB:g,resolveRx:"true"});i.interactions?.length>0&&l.push(...i.interactions.map(U=>({...U,drugs:[A,g],source:"curated"})))}catch(i){console.warn(`Failed to check curated interactions for ${A} + ${g}:`,i)}}if(l.length===0){const w={warfarin:{aspirin:{severity:"major",mechanism:"Additive anticoagulant effects",effect:"Increased risk of bleeding",management:"Monitor INR closely, consider dose adjustment",evidence_level:"high"},acetaminophen:{severity:"moderate",mechanism:"Enhanced warfarin effect with chronic use",effect:"Potential increase in bleeding risk",management:"Monitor INR if using acetaminophen regularly >1g/day",evidence_level:"moderate"}},aspirin:{warfarin:{severity:"major",mechanism:"Additive anticoagulant effects",effect:"Increased risk of bleeding",management:"Monitor INR closely, consider dose adjustment",evidence_level:"high"}},acetaminophen:{warfarin:{severity:"moderate",mechanism:"Enhanced warfarin effect with chronic use",effect:"Potential increase in bleeding risk",management:"Monitor INR if using acetaminophen regularly >1g/day",evidence_level:"moderate"}}};console.log("Checking fallback interactions for:",y);for(let N=0;N<y.length;N++)for(let A=N+1;A<y.length;A++){const g=y[N],i=y[A];if(console.log(`Checking fallback for: ${g} + ${i}`),w[g]?.[i]||w[i]?.[g]){const U=w[g]?.[i]||w[i]?.[g];console.log(`Found fallback interaction: ${g} + ${i}`,U),l.push({...U,drugs:[g,i],source:"fallback",note:"Known major interaction from clinical literature"})}}console.log("Final fallback interactions:",l)}s={interactions:{stored:l,external:[]},sources:{stored:l.length,external:0}}}v(s)}catch(s){u(s instanceof Error?s.message:"Failed to check interactions")}finally{S(!1)}},G=()=>h?h.interactions.stored.length+h.interactions.external.length:0,_=()=>{if(!h)return null;const a=[...h.interactions.stored,...h.interactions.external].map(l=>l.severity);return a.includes("major")?"major":a.includes("moderate")?"moderate":a.includes("minor")?"minor":"unknown"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[e.jsx(L,{className:"w-8 h-8 text-warning-600"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Advanced Drug Interaction Analysis"})]}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"AI-powered interaction checking with clinical recommendations, severity analysis, and patient-specific considerations."})]}),e.jsx(Se,{selectedDrugs:n,onDrugRemove:V,patientProfile:{age:65,weight:70,renalFunction:"normal",hepaticFunction:"normal",comorbidities:["hypertension","diabetes"],allergies:["penicillin"]}}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Select Medications"}),e.jsx(Ce,{onDrugSelect:ne}),n.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:["Selected Drugs (",n.length,")"]}),e.jsx("div",{className:"space-y-2",children:n.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.name}),s.generic_name&&s.generic_name!==s.name&&e.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["(",s.generic_name,")"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["RXCUI: ",s.rxcui]})]}),e.jsx("button",{onClick:()=>V(s.rxcui),className:"p-1 text-gray-400 hover:text-red-600 focus:outline-none",children:e.jsx(se,{className:"w-4 h-4"})})]},s.rxcui))})]}),e.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-4",children:[e.jsx("button",{onClick:ie,disabled:n.length<2||I,className:"flex items-center justify-center space-x-2 px-6 py-3 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:I?e.jsxs(e.Fragment,{children:[e.jsx(re,{size:"sm"}),e.jsx("span",{children:"Checking Interactions..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{children:"Check for Interactions"})]})}),e.jsx("button",{onClick:()=>{if(n.length>=2){const s=n[0]?.name||"",a=n[1]?.name||"",l=new URLSearchParams({drugA:s,drugB:a,resolveRx:"true"});C({pathname:"/curated",search:`?${l.toString()}`})}},disabled:n.length<2,className:"flex items-center space-x-2 px-6 py-3 bg-gray-100 text-gray-700 font-medium rounded-lg hover:bg-gray-200 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx("span",{children:"See Curated Pairs"})})]})]}),r&&e.jsx(M,{type:"error",title:"Interaction Check Failed",children:r}),h&&!I&&e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Interaction Analysis"}),e.jsx(E,{content:"Comprehensive analysis of drug-drug interactions from curated clinical databases including severity classification and evidence-based recommendations",children:e.jsx(H,{className:"w-4 h-4 text-gray-400"})})]}),e.jsx("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:h.sources&&e.jsxs(e.Fragment,{children:[e.jsx(E,{content:"Results from OncoSafeRx curated interaction database with clinically validated drug pairs",children:e.jsxs("span",{className:"cursor-help underline",children:["Curated: ",h.sources.stored]})}),e.jsx(E,{content:"Results from external drug interaction databases (DrugBank, FDA, clinical literature)",children:e.jsxs("span",{className:"cursor-help underline",children:["External: ",h.sources.external]})})]})})]}),G()===0?e.jsx(M,{type:"success",title:"No Interactions Found",children:"No known interactions were found between the selected medications. However, always consult with a healthcare professional before taking multiple medications."}):e.jsxs(M,{type:_()==="major"?"error":_()==="moderate"?"warning":"info",title:`${G()} Interaction${G()!==1?"s":""} Found`,children:[_()==="major"&&"Critical interactions detected. Consult healthcare provider immediately.",_()==="moderate"&&"Moderate interactions found. Review with healthcare provider.",_()==="minor"&&"Minor interactions detected. Monitor for side effects.",_()==="unknown"&&"Interactions found with unknown severity. Consult healthcare provider."]})]}),h&&e.jsx(Ne,{results:h}),n.length>=2&&e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Alternatives (beta)"}),e.jsx(E,{content:"AI-powered drug alternative suggestions to reduce interaction risk while maintaining therapeutic efficacy. Considers patient factors, formulary status, and pharmacogenomics.",children:e.jsx(H,{className:"w-4 h-4 text-gray-400"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Mock data for demonstration purposes"})]}),e.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[e.jsx(E,{content:"Show only alternatives likely to be covered by insurance formularies",children:e.jsxs("label",{className:"inline-flex items-center space-x-1 cursor-help",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:s=>{const a=s.target.checked;d(a),F(q(T,a,x))}}),e.jsx("span",{children:"Only likely covered"})]})}),e.jsx(E,{content:"Show only the highest-ranked alternatives based on efficacy, safety, and interaction profile",children:e.jsxs("label",{className:"inline-flex items-center space-x-1 cursor-help",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:s=>{const a=s.target.checked;O(a),F(q(T,t,a))}}),e.jsx("span",{children:"Best only"})]})}),e.jsx("button",{type:"button",className:"px-2 py-1 bg-gray-100 rounded border",onClick:()=>{T&&F(T),$(null),d(!1),O(!1)},children:"Reset"})]}),e.jsx("button",{onClick:async()=>{if(!n||n.length===0){$("Please select at least one drug before requesting alternatives");return}k(!0),$(null);try{const s=n.flatMap((a,l)=>{const b=[],y=a.name.toLowerCase(),w={aspirin:["ibuprofen","naproxen","celecoxib"],ibuprofen:["aspirin","naproxen","diclofenac"],warfarin:["rivaroxaban","apixaban","dabigatran"],metformin:["glipizide","glyburide","sitagliptin"],atorvastatin:["simvastatin","rosuvastatin","pravastatin"],omeprazole:["pantoprazole","esomeprazole","lansoprazole"]};let N=[];for(const[A,g]of Object.entries(w))if(y.includes(A)){N=g;break}return N.length===0&&(N=[`${a.name} extended-release`,`${a.name} alternative formulation`]),N.slice(0,2).forEach((A,g)=>{b.push({forDrug:a,withDrug:n.find(i=>i.rxcui!==a.rxcui)||null,alternative:{rxcui:`alt-${a.rxcui}-${g}`,name:A,tty:a.tty},rationale:g===0?"Fewer drug interactions and similar efficacy":"Alternative mechanism of action with lower interaction risk",score:90-l*5-g*10,best:l===0&&g===0,formulary:(l+g)%2===0?"likely-covered":"check-coverage",costHint:g===0?"Generic available - lower cost":"Similar cost to current therapy",pgx:y.includes("warfarin")||y.includes("metformin")?[{gene:y.includes("warfarin")?"CYP2C9":"OCT1",phenotype:"Normal metabolizer"}]:[],citations:[{label:"Clinical Practice Guidelines",url:"#"},"Peer-reviewed comparative effectiveness study"]})}),b}).slice(0,6);z(s),F(q(s,t,x))}catch(s){console.error("Alternatives error:",s),$("Failed to load alternatives. This feature is currently in development.")}finally{k(!1)}},className:"px-4 py-2 bg-primary-600 text-white rounded-md",children:m?"Loadingâ€¦":"Suggest Alternatives"})]}),D&&e.jsxs("div",{className:"text-xs text-green-700 bg-green-50 inline-block px-2 py-1 rounded mb-3",children:["Applying PGx phenotypes: ",Object.entries(D).map(([s,a])=>`${s}: ${a}`).join("; ")]}),R&&e.jsx(M,{type:"error",title:"Error",children:R}),B&&e.jsxs("div",{className:"space-y-4",children:[B.length===0&&e.jsx(M,{type:"info",title:"No Suggestions",children:"No alternatives available for the selected combination."}),B.map((s,a)=>e.jsxs("div",{className:`p-4 border rounded-md relative ${s.best?"border-green-400":""}`,children:[s.best&&e.jsx("div",{className:"absolute -top-2 -right-2 bg-green-500 text-white text-xs px-2 py-0.5 rounded-full shadow",children:"Best"}),e.jsxs("div",{className:"text-sm text-gray-700",children:["Consider replacing ",e.jsx("strong",{children:s.forDrug?.name})," (with ",s.withDrug?.name,") with ",e.jsx("strong",{children:s.alternative?.name}),"."]}),typeof s.score=="number"&&e.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Rank Score: ",s.score]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 mt-1",children:[s.best&&e.jsx("span",{className:"inline-block bg-green-100 text-green-700 text-xs px-2 py-0.5 rounded",children:"Best Match"}),e.jsxs("span",{children:["Reason: ",s.rationale]})]}),Array.isArray(s.pgx)&&s.pgx.length>0&&e.jsx("div",{className:"mt-2 space-x-2 text-xs",children:s.pgx.map((l,b)=>e.jsxs("span",{className:"inline-block bg-purple-50 text-purple-700 px-2 py-0.5 rounded",children:["PGx: ",l.gene,": ",l.phenotype]},b))}),(s.costHint||s.formulary)&&e.jsxs("div",{className:"mt-1 text-xs text-gray-600",children:[s.costHint?s.costHint:""," ",s.formulary?`â€¢ ${s.formulary}`:""]}),s.citations?.length>0&&e.jsx("div",{className:"text-xs text-gray-500 mt-1 space-x-2",children:s.citations.map((l,b)=>typeof l=="string"?e.jsx("span",{children:l},b):e.jsx("a",{href:l.url,target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:underline",children:l.label},b))})]},a))]})]})]})},He=()=>e.jsx(be,{featureName:"Drug Interaction Checker",fallbackMessage:"The interaction checker is temporarily unavailable. This may be due to connectivity issues or data processing problems.",children:e.jsx(Ie,{})});export{He as default};
//# sourceMappingURL=InteractionChecker-ppLmqfz8.js.map
