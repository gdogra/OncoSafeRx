import{c as be,r as b,j as e,X,v as ne,H as ue,A as V,a as le,w as je,e as k,I as F,p as E,x as pe,S as re,h as _,y as G,z as K,P as J,D as ee,b as se,Z as ve,d as H,i as oe,F as te,u as ge,G as Ne,T as de,s as ie,J as we,B as Se,K as Ce,N as De,q as ke,L as me,U as xe}from"./index-4Ly-s4cr.js";import{C as v}from"./Card-DLOVFYwQ.js";import{U as z}from"./user-BBF1fMpu.js";import{S as Te}from"./save-BcthHOQ5.js";import{S as Ae}from"./star-2cVrOGT9.js";import{P as Y}from"./plus-7LXijMKD.js";import{R as Pe}from"./refresh-cw-Da3gWcAr.js";import{A as ae}from"./Alert-D2KfDB-X.js";import{L as Oe}from"./LoadingSpinner-BK8GoEPg.js";import{F as ce}from"./funnel-Di7XuIws.js";import{C as W}from"./circle-check-big-DzqNVPmE.js";import{S as Z}from"./square-pen-CnczSAg3.js";import{H as Q}from"./history-C_Hr60kb.js";import{T as he}from"./trending-down-Bq239_-E.js";import{M as ye}from"./minus-D7GPK9k3.js";import{D as q}from"./download-CEa9LHc5.js";import{S as Me}from"./settings-BG7XI4yB.js";import{S as $e}from"./share-2-CBlfQzTs.js";import{C as Re}from"./copy-CJleH8s8.js";import{P as Ie}from"./printer-GQetqlYD.js";import{M as fe}from"./mail-C7SWvgQs.js";import{C as Fe}from"./calendar-CM498r1t.js";import{E as Le}from"./eye-BNehSfOP.js";import{M as Ee}from"./map-pin-I9dxw0QQ.js";import{S as Be}from"./sparkles-Dy33uKqh.js";import{A as B}from"./arrow-right-Dhrftuj8.js";import"./circle-x-DA35Ia3u.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],ze=be("scissors",He),Ge=({onSubmit:L,onCancel:T})=>{const[x,l]=b.useState("demographics"),[o,h]=b.useState({firstName:"",lastName:"",dateOfBirth:"",sex:"male",allergies:[],medicalHistory:[],familyHistory:[]}),[y,j]=b.useState({allergen:"",reaction:"",severity:"mild"}),[g,R]=b.useState({condition:"",yearDiagnosed:"",status:"active"}),[S,p]=b.useState({relationship:"",condition:"",ageAtDiagnosis:""}),n=[{id:"demographics",label:"Demographics",icon:z},{id:"contact",label:"Contact Info",icon:ne},{id:"clinical",label:"Clinical Info",icon:ue},{id:"vitals",label:"Vitals & Labs",icon:V},{id:"history",label:"Medical History",icon:le},{id:"social",label:"Social History",icon:je},{id:"providers",label:"Care Team",icon:z}],c=(s,r)=>{h(t=>{const m=s.split("."),w={...t};let D=w;for(let O=0;O<m.length-1;O++)D[m[O]]||(D[m[O]]={}),D=D[m[O]];return D[m[m.length-1]]=r,w})},u=()=>{if(y.allergen&&y.reaction){const s={...y,id:`allergy-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,allergenType:"drug",dateReported:new Date().toISOString(),verified:!1};h(r=>({...r,allergies:[...r.allergies||[],s]})),j({allergen:"",reaction:"",severity:"mild"})}},f=()=>{g.condition&&(h(s=>({...s,medicalHistory:[...s.medicalHistory||[],{...g,yearDiagnosed:g.yearDiagnosed?parseInt(g.yearDiagnosed):void 0}]})),R({condition:"",yearDiagnosed:"",status:"active"}))},P=()=>{S.relationship&&S.condition&&(h(s=>({...s,familyHistory:[...s.familyHistory||[],{...S,ageAtDiagnosis:S.ageAtDiagnosis?parseInt(S.ageAtDiagnosis):void 0}]})),p({relationship:"",condition:"",ageAtDiagnosis:""}))},[d,C]=b.useState({}),A=()=>{const s={};return o.firstName?.trim()||(s.firstName="First name is required"),o.lastName?.trim()||(s.lastName="Last name is required"),o.dateOfBirth||(s.dateOfBirth="Date of birth is required"),o.sex||(s.sex="Sex is required"),o.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email)&&(s.email="Please enter a valid email address"),o.phone&&!/^\+?[\d\s\-\(\)]{10,}$/.test(o.phone)&&(s.phone="Please enter a valid phone number"),(o.emergencyContact?.name||o.emergencyContact?.phone||o.emergencyContact?.relationship)&&(o.emergencyContact?.name?.trim()||(s["emergencyContact.name"]="Emergency contact name is required"),o.emergencyContact?.phone?.trim()||(s["emergencyContact.phone"]="Emergency contact phone is required"),o.emergencyContact?.relationship?.trim()||(s["emergencyContact.relationship"]="Emergency contact relationship is required")),C(s),Object.keys(s).length===0},I=()=>o.firstName?.trim()&&o.lastName?.trim()&&o.dateOfBirth&&o.sex,M=s=>{s.preventDefault(),A()?L(o):d.firstName||d.lastName||d.dateOfBirth||d.sex?l("demographics"):(d.email||d.phone)&&l("contact")},a=()=>{switch(x){case"demographics":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:o.firstName,onChange:s=>c("firstName",s.target.value),required:!0,className:`w-full border rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ${d.firstName?"border-red-500":"border-gray-300"}`}),d.firstName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.firstName})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Last Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:o.lastName,onChange:s=>c("lastName",s.target.value),required:!0,className:`w-full border rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ${d.lastName?"border-red-500":"border-gray-300"}`}),d.lastName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.lastName})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date of Birth ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:o.dateOfBirth,onChange:s=>c("dateOfBirth",s.target.value),required:!0,className:`w-full border rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ${d.dateOfBirth?"border-red-500":"border-gray-300"}`}),d.dateOfBirth&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.dateOfBirth})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Biological Sex ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:o.sex,onChange:s=>c("sex",s.target.value),required:!0,className:`w-full border rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ${d.sex?"border-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other/Unknown"})]}),d.sex&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.sex})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Height (cm)"}),e.jsx("input",{type:"number",value:o.heightCm||"",onChange:s=>c("heightCm",s.target.value?parseFloat(s.target.value):void 0),min:"0",max:"300",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight (kg)"}),e.jsx("input",{type:"number",value:o.weightKg||"",onChange:s=>c("weightKg",s.target.value?parseFloat(s.target.value):void 0),min:"0",max:"500",step:"0.1",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["BSA (mÂ²)",e.jsx(k,{content:"Body Surface Area - calculated automatically if height and weight provided",children:e.jsx(F,{className:"w-3 h-3 ml-1 inline"})})]}),e.jsx("input",{type:"number",value:o.bsa||"",onChange:s=>c("bsa",s.target.value?parseFloat(s.target.value):void 0),step:"0.01",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Medical Record Number (MRN)"}),e.jsx("input",{type:"text",value:o.mrn||"",onChange:s=>c("mrn",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]});case"contact":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:o.email||"",onChange:s=>c("email",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:o.phone||"",onChange:s=>c("phone",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Address"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"Street Address",value:o.address?.street||"",onChange:s=>c("address.street",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("input",{type:"text",placeholder:"City",value:o.address?.city||"",onChange:s=>c("address.city",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("input",{type:"text",placeholder:"State",value:o.address?.state||"",onChange:s=>c("address.state",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("input",{type:"text",placeholder:"ZIP Code",value:o.address?.zipCode||"",onChange:s=>c("address.zipCode",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Emergency Contact"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("input",{type:"text",placeholder:"Contact Name",value:o.emergencyContact?.name||"",onChange:s=>c("emergencyContact.name",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("input",{type:"text",placeholder:"Relationship",value:o.emergencyContact?.relationship||"",onChange:s=>c("emergencyContact.relationship",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("input",{type:"tel",placeholder:"Phone Number",value:o.emergencyContact?.phone||"",onChange:s=>c("emergencyContact.phone",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Insurance Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("input",{type:"text",placeholder:"Insurance Provider",value:o.insurance?.provider||"",onChange:s=>c("insurance.provider",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("input",{type:"text",placeholder:"Member ID",value:o.insurance?.memberId||"",onChange:s=>c("insurance.memberId",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("input",{type:"text",placeholder:"Group Number",value:o.insurance?.groupNumber||"",onChange:s=>c("insurance.groupNumber",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]});case"clinical":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Diagnosis"}),e.jsx("input",{type:"text",value:o.primaryDiagnosis||"",onChange:s=>c("primaryDiagnosis",s.target.value),placeholder:"e.g., Breast Cancer, Lung Adenocarcinoma",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stage"}),e.jsx("input",{type:"text",value:o.stage||"",onChange:s=>c("stage",s.target.value),placeholder:"e.g., Stage IIIA, T2N1M0",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Diagnosis"}),e.jsx("input",{type:"date",value:o.dateOfDiagnosis||"",onChange:s=>c("dateOfDiagnosis",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Site"}),e.jsx("input",{type:"text",value:o.primarySite||"",onChange:s=>c("primarySite",s.target.value),placeholder:"e.g., Left breast, Right upper lobe",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Histology"}),e.jsx("input",{type:"text",value:o.histology||"",onChange:s=>c("histology",s.target.value),placeholder:"e.g., Invasive ductal carcinoma, Adenocarcinoma",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["ECOG Performance Status",e.jsx(k,{content:"0=Fully active, 1=Restricted strenuous activity, 2=Ambulatory >50% of time, 3=Limited self-care, 4=Completely disabled",children:e.jsx(F,{className:"w-3 h-3 ml-1 inline"})})]}),e.jsxs("select",{value:o.ecogPerformanceStatus||"",onChange:s=>c("ecogPerformanceStatus",s.target.value?parseInt(s.target.value):void 0),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Select ECOG Score"}),e.jsx("option",{value:"0",children:"0 - Fully active"}),e.jsx("option",{value:"1",children:"1 - Restricted strenuous activity"}),e.jsx("option",{value:"2",children:"2 - Ambulatory, self-care"}),e.jsx("option",{value:"3",children:"3 - Limited self-care"}),e.jsx("option",{value:"4",children:"4 - Completely disabled"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Karnofsky Score",e.jsx(k,{content:"Performance status scale 0-100, where 100 = normal activity",children:e.jsx(F,{className:"w-3 h-3 ml-1 inline"})})]}),e.jsx("input",{type:"number",value:o.karnofskyScore||"",onChange:s=>c("karnofskyScore",s.target.value?parseInt(s.target.value):void 0),min:"0",max:"100",step:"10",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]});case"vitals":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Vital Signs"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"BP Systolic"}),e.jsx("input",{type:"number",value:o.vitals?.bloodPressureSystolic||"",onChange:s=>c("vitals.bloodPressureSystolic",s.target.value?parseInt(s.target.value):void 0),placeholder:"mmHg",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"BP Diastolic"}),e.jsx("input",{type:"number",value:o.vitals?.bloodPressureDiastolic||"",onChange:s=>c("vitals.bloodPressureDiastolic",s.target.value?parseInt(s.target.value):void 0),placeholder:"mmHg",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heart Rate"}),e.jsx("input",{type:"number",value:o.vitals?.heartRate||"",onChange:s=>c("vitals.heartRate",s.target.value?parseInt(s.target.value):void 0),placeholder:"bpm",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Laboratory Values"}),e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hemoglobin"}),e.jsx("input",{type:"number",value:o.labValues?.hemoglobin||"",onChange:s=>c("labValues.hemoglobin",s.target.value?parseFloat(s.target.value):void 0),placeholder:"g/dL",step:"0.1",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"WBC"}),e.jsx("input",{type:"number",value:o.labValues?.wbc||"",onChange:s=>c("labValues.wbc",s.target.value?parseFloat(s.target.value):void 0),placeholder:"K/Î¼L",step:"0.1",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Platelets"}),e.jsx("input",{type:"number",value:o.labValues?.platelets||"",onChange:s=>c("labValues.platelets",s.target.value?parseFloat(s.target.value):void 0),placeholder:"K/Î¼L",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Creatinine"}),e.jsx("input",{type:"number",value:o.labValues?.creatinine||"",onChange:s=>c("labValues.creatinine",s.target.value?parseFloat(s.target.value):void 0),placeholder:"mg/dL",step:"0.01",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]})]});case"history":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Allergies"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsx("input",{type:"text",placeholder:"Allergen",value:y.allergen,onChange:s=>j(r=>({...r,allergen:s.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("input",{type:"text",placeholder:"Reaction",value:y.reaction,onChange:s=>j(r=>({...r,reaction:s.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsxs("select",{value:y.severity,onChange:s=>j(r=>({...r,severity:s.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"mild",children:"Mild"}),e.jsx("option",{value:"moderate",children:"Moderate"}),e.jsx("option",{value:"severe",children:"Severe"})]}),e.jsx("button",{type:"button",onClick:u,className:"px-3 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Add"})]}),o.allergies&&o.allergies.length>0&&e.jsx("div",{className:"space-y-2",children:o.allergies.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-red-50 rounded-md",children:[e.jsxs("span",{children:[s.allergen," - ",s.reaction," (",s.severity,")"]}),e.jsx("button",{type:"button",onClick:()=>h(t=>({...t,allergies:t.allergies?.filter((m,w)=>w!==r)})),className:"text-red-600 hover:text-red-800",children:e.jsx(X,{className:"w-4 h-4"})})]},r))})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Medical History"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsx("input",{type:"text",placeholder:"Condition",value:g.condition,onChange:s=>R(r=>({...r,condition:s.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("input",{type:"number",placeholder:"Year Diagnosed",value:g.yearDiagnosed,onChange:s=>R(r=>({...r,yearDiagnosed:s.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsxs("select",{value:g.status,onChange:s=>R(r=>({...r,status:s.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"chronic",children:"Chronic"}),e.jsx("option",{value:"resolved",children:"Resolved"})]}),e.jsx("button",{type:"button",onClick:f,className:"px-3 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Add"})]}),o.medicalHistory&&o.medicalHistory.length>0&&e.jsx("div",{className:"space-y-2",children:o.medicalHistory.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-blue-50 rounded-md",children:[e.jsxs("span",{children:[s.condition," ",s.yearDiagnosed&&`(${s.yearDiagnosed})`," - ",s.status]}),e.jsx("button",{type:"button",onClick:()=>h(t=>({...t,medicalHistory:t.medicalHistory?.filter((m,w)=>w!==r)})),className:"text-red-600 hover:text-red-800",children:e.jsx(X,{className:"w-4 h-4"})})]},r))})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Family History"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsx("input",{type:"text",placeholder:"Relationship",value:S.relationship,onChange:s=>p(r=>({...r,relationship:s.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("input",{type:"text",placeholder:"Condition",value:S.condition,onChange:s=>p(r=>({...r,condition:s.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("input",{type:"number",placeholder:"Age at Diagnosis",value:S.ageAtDiagnosis,onChange:s=>p(r=>({...r,ageAtDiagnosis:s.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("button",{type:"button",onClick:P,className:"px-3 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Add"})]}),o.familyHistory&&o.familyHistory.length>0&&e.jsx("div",{className:"space-y-2",children:o.familyHistory.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-green-50 rounded-md",children:[e.jsxs("span",{children:[s.relationship," - ",s.condition," ",s.ageAtDiagnosis&&`(age ${s.ageAtDiagnosis})`]}),e.jsx("button",{type:"button",onClick:()=>h(t=>({...t,familyHistory:t.familyHistory?.filter((m,w)=>w!==r)})),className:"text-red-600 hover:text-red-800",children:e.jsx(X,{className:"w-4 h-4"})})]},r))})]})]})]});case"social":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Smoking Status"}),e.jsxs("select",{value:o.socialHistory?.smokingStatus||"",onChange:s=>c("socialHistory.smokingStatus",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Select status"}),e.jsx("option",{value:"never",children:"Never smoker"}),e.jsx("option",{value:"former",children:"Former smoker"}),e.jsx("option",{value:"current",children:"Current smoker"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pack Years (if applicable)"}),e.jsx("input",{type:"number",value:o.socialHistory?.smokingPackYears||"",onChange:s=>c("socialHistory.smokingPackYears",s.target.value?parseFloat(s.target.value):void 0),step:"0.5",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Alcohol Use"}),e.jsxs("select",{value:o.socialHistory?.alcoholUse||"",onChange:s=>c("socialHistory.alcoholUse",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Select usage"}),e.jsx("option",{value:"none",children:"None"}),e.jsx("option",{value:"occasional",children:"Occasional"}),e.jsx("option",{value:"moderate",children:"Moderate"}),e.jsx("option",{value:"heavy",children:"Heavy"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Marital Status"}),e.jsxs("select",{value:o.socialHistory?.maritalStatus||"",onChange:s=>c("socialHistory.maritalStatus",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Select status"}),e.jsx("option",{value:"single",children:"Single"}),e.jsx("option",{value:"married",children:"Married"}),e.jsx("option",{value:"divorced",children:"Divorced"}),e.jsx("option",{value:"widowed",children:"Widowed"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Occupation"}),e.jsx("input",{type:"text",value:o.socialHistory?.occupation||"",onChange:s=>c("socialHistory.occupation",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]});case"providers":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Oncologist"}),e.jsx("input",{type:"text",value:o.primaryOncologist||"",onChange:s=>c("primaryOncologist",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Referring Physician"}),e.jsx("input",{type:"text",value:o.referringPhysician||"",onChange:s=>c("referringPhysician",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Treatment Center/Hospital"}),e.jsx("input",{type:"text",value:o.treatmentCenter||"",onChange:s=>c("treatmentCenter",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]});default:return null}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Create New Patient"}),e.jsx("button",{onClick:T,className:"text-gray-400 hover:text-gray-600",children:e.jsx(X,{className:"w-6 h-6"})})]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Complete patient information for comprehensive clinical management"})]}),e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:e.jsx("div",{className:"flex space-x-1 overflow-x-auto",children:n.map(({id:s,label:r,icon:t})=>e.jsxs("button",{onClick:()=>l(s),className:`flex items-center space-x-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${x===s?"bg-primary-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:[e.jsx(t,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:r})]},s))})}),e.jsxs("form",{onSubmit:M,className:"flex-1 overflow-y-auto",children:[e.jsx("div",{className:"p-6",children:a()}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{type:"button",onClick:T,className:"px-6 py-2 border border-gray-300 text-gray-700 bg-white rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{const s=n.findIndex(r=>r.id===x);s>0&&l(n[s-1].id)},disabled:n.findIndex(s=>s.id===x)===0,className:"px-6 py-2 border border-gray-300 text-gray-700 bg-white rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{type:"button",onClick:()=>{const s=n.findIndex(r=>r.id===x);s<n.length-1&&l(n[s+1].id)},disabled:n.findIndex(s=>s.id===x)===n.length-1,className:"px-6 py-2 border border-gray-300 text-gray-700 bg-white rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"}),e.jsxs("button",{type:"submit",disabled:!I(),className:`flex items-center space-x-2 px-6 py-2 rounded-md transition-colors ${I()?"bg-primary-600 text-white hover:bg-primary-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,title:I()?"":"Please fill in all required fields (First Name, Last Name, Date of Birth, Sex)",children:[e.jsx(Te,{className:"w-4 h-4"}),e.jsx("span",{children:"Create Patient"})]})]})]})})]})]})})},Ue=()=>{const{state:L,actions:T}=E(),{showToast:x}=pe(),{currentPatient:l,recentPatients:o}=L,[h,y]=b.useState(""),[j,g]=b.useState(!1),R=async a=>{if(!a.trim())return[];try{const{data:r}=await K.auth.getSession(),t=r?.session?.access_token;if(t){const m=new URLSearchParams({q:a,page:"1",pageSize:"10"}),w=await fetch(`/api/patients?${m.toString()}`,{headers:{Authorization:`Bearer ${t}`}});if(w.ok){const D=await w.json();return(Array.isArray(D?.patients)?D.patients:[]).map(i=>i.data||i)}}}catch{}const s=a.toLowerCase();return o.filter(r=>`${r.demographics.firstName} ${r.demographics.lastName}`.toLowerCase().includes(s)||(r.demographics.mrn||"").toLowerCase().includes(s))},[S,p]=b.useState([]),[n,c]=b.useState(!1),[u,f]=b.useState(!1),P=async a=>{if(y(a),a.trim().length===0){p([]);return}c(!0);try{const s=await R(a);p(s)}catch(s){console.error("Search failed:",s)}finally{c(!1)}},d=a=>{T.setCurrentPatient(a),y(""),p([]),f(!1)},C=()=>{h.trim()===""&&(f(!0),p(o))},A=()=>{setTimeout(()=>{f(!1),h.trim()===""&&p([])},200)},I=async a=>{try{const s={firstName:a.firstName||"Unknown",lastName:a.lastName||"Patient",dateOfBirth:a.dateOfBirth||"1980-01-01",sex:a.sex||"unknown",mrn:a.mrn||`MRN${Date.now()}`,heightCm:a.heightCm||170,weightKg:a.weightKg||70};let r="guest";try{const{data:m}=await K.auth.getSession();r=m?.session?.user?.id||r}catch(m){console.warn("Auth session check failed:",m)}const t={id:`patient-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,demographics:s,allergies:a.allergies||[],medications:[],conditions:a.medicalConditions||[],labValues:a.labValues?[a.labValues]:[],genetics:[],vitals:a.vitals?[a.vitals]:[],treatmentHistory:[],notes:[],preferences:{},lastUpdated:new Date().toISOString(),createdBy:r,isActive:!0};T.setCurrentPatient(t);try{const{data:m}=await K.auth.getSession(),w=m?.session?.access_token,D={"Content-Type":"application/json"};w&&(D.Authorization=`Bearer ${w}`);const O=await fetch("/api/patients",{method:"POST",headers:D,body:JSON.stringify({patient:t})});if(O.ok)x("success","Patient created successfully");else{const i=await O.text().catch(()=>"Unknown error");console.warn("Server patient creation failed:",O.status,i),x("warning","Patient saved locally (server unavailable)")}}catch(m){console.error("Network error creating patient:",m),x("warning","Patient saved locally (network error)")}g(!1)}catch(s){console.error("Failed to create patient:",s),x("error","Failed to create patient")}},M=a=>{const s=new Date,r=new Date(a);let t=s.getFullYear()-r.getFullYear();const m=s.getMonth()-r.getMonth();return(m<0||m===0&&s.getDate()<r.getDate())&&t--,t};return e.jsxs("div",{className:"space-y-6",children:[l&&e.jsx(v,{className:"bg-primary-50 border-primary-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx(z,{className:"w-6 h-6 text-primary-600"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-primary-900",children:[l.demographics.firstName," ",l.demographics.lastName]}),e.jsxs("div",{className:"flex items-center space-x-3 text-sm text-primary-700",children:[e.jsxs("span",{children:[M(l.demographics.dateOfBirth)," years old"]}),e.jsx("span",{className:"capitalize",children:l.demographics.sex}),l.demographics.mrn&&e.jsxs("span",{children:["MRN: ",l.demographics.mrn]})]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(k,{content:"Currently selected patient",children:e.jsx(Ae,{className:"w-5 h-5 text-primary-600 fill-current"})})})]})}),e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(re,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Patient Search"}),e.jsx(k,{content:"Search for existing patients by name or MRN, or create a new patient profile. Focus on the search field to see all available patients.",type:"help",position:"bottom",children:e.jsx(F,{className:"w-4 h-4 text-gray-400 hover:text-blue-600 cursor-help transition-colors"})})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:h,onChange:a=>P(a.target.value),onFocus:C,onBlur:A,placeholder:"Search by patient name or MRN...",className:"block w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),n&&e.jsx("div",{className:"absolute right-3 top-2.5",children:e.jsx("div",{className:"w-4 h-4 border-2 border-primary-600 border-t-transparent rounded-full animate-spin"})})]}),e.jsx(k,{content:"Create a new patient profile with comprehensive clinical information",position:"bottom",children:e.jsxs("button",{onClick:()=>g(!0),className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white text-sm font-medium rounded-md hover:bg-primary-700",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("span",{children:"New Patient"})]})}),e.jsx(k,{content:"Sync patients from server",position:"bottom",children:e.jsxs("button",{onClick:()=>T.syncFromServer(),className:"flex items-center space-x-2 px-3 py-2 bg-white border text-sm font-medium rounded-md hover:bg-gray-50",children:[e.jsx(Pe,{className:"w-4 h-4"}),e.jsx("span",{children:"Sync"})]})})]}),S.length>0&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:u?"Available Patients:":"Search Results:"}),S.map(a=>e.jsx("div",{onClick:()=>d(a),className:"p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[a.demographics.firstName," ",a.demographics.lastName]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[M(a.demographics.dateOfBirth)," years â¢ ",a.demographics.sex," â¢ MRN: ",a.demographics.mrn]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date(a.lastUpdated).toLocaleDateString()]})]})},a.id))]}),h.length>=1&&S.length===0&&!n&&e.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:['No patients found matching "',h,'"']})]}),o.length>0&&e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(_,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Patients"}),e.jsx(k,{content:"Recently accessed patient profiles for quick selection",children:e.jsx(F,{className:"w-4 h-4 text-gray-400"})})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:o.slice(0,6).map(a=>e.jsx("div",{onClick:()=>d(a),className:`p-3 border rounded-lg cursor-pointer transition-colors ${l?.id===a.id?"border-primary-300 bg-primary-50":"border-gray-200 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(z,{className:"w-4 h-4 text-gray-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"font-medium text-gray-900 truncate",children:[a.demographics.firstName," ",a.demographics.lastName]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[M(a.demographics.dateOfBirth)," years â¢ MRN: ",a.demographics.mrn]})]}),e.jsx("button",{className:"p-1 text-gray-400 hover:text-red-600",onClick:async s=>{if(s.stopPropagation(),!confirm("Delete this patient?"))return;const r=a;T.removePatient(a.id),x("success","Patient deleted",5e3,{label:"Undo",onClick:async()=>{T.setCurrentPatient(r);try{const{data:t}=await K.auth.getSession(),m=t?.session?.access_token;m&&await fetch("/api/patients",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`},body:JSON.stringify({patient:r})})}catch{}}})},title:"Delete patient",children:e.jsx(G,{className:"w-4 h-4"})})]})},a.id))})]}),j&&e.jsx(Ge,{onSubmit:I,onCancel:()=>g(!1)})]})},qe=({patientId:L})=>{const{state:T,actions:x}=E(),{currentPatient:l}=T,[o,h]=b.useState(!1),[y,j]=b.useState(null),[g,R]=b.useState("all"),[S,p]=b.useState(""),[n,c]=b.useState({drugName:"",dosage:"",frequency:"",route:"Oral",startDate:new Date().toISOString().split("T")[0],indication:"",prescribedBy:"",isActive:!0,adherence:"good"});if(!l)return e.jsx(v,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(J,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Patient Selected"}),e.jsx("p",{className:"text-gray-400",children:"Select a patient to manage their medications"})]})});const u=()=>{let a=l.medications||[];return g==="active"?a=a.filter(s=>s.isActive):g==="inactive"&&(a=a.filter(s=>!s.isActive)),S.trim()&&(a=a.filter(s=>s.drugName?.toLowerCase().includes(S.toLowerCase())||s.indication?.toLowerCase().includes(S.toLowerCase())||s.prescribedBy?.toLowerCase().includes(S.toLowerCase()))),a},f=()=>{if(!n.drugName||!n.dosage||!n.frequency){alert("Please fill in all required fields");return}const a={id:`med-${Date.now()}`,drugName:n.drugName,dosage:n.dosage,frequency:n.frequency,route:n.route||"Oral",startDate:n.startDate||new Date().toISOString().split("T")[0],endDate:n.endDate,indication:n.indication||"",prescribedBy:n.prescribedBy||"",isActive:n.isActive!==!1,adherence:n.adherence||"good",sideEffects:n.sideEffects||[]},s=[...l.medications||[],a];x.updatePatientData({medications:s}),c({drugName:"",dosage:"",frequency:"",route:"Oral",startDate:new Date().toISOString().split("T")[0],indication:"",prescribedBy:"",isActive:!0,adherence:"good"}),h(!1)},P=a=>{j(a),c(a),h(!0)},d=()=>{if(!y||!n.drugName||!n.dosage||!n.frequency){alert("Please fill in all required fields");return}const a=l.medications.map(s=>s.id===y.id?{...n,id:y.id}:s);x.updatePatientData({medications:a}),c({drugName:"",dosage:"",frequency:"",route:"Oral",startDate:new Date().toISOString().split("T")[0],indication:"",prescribedBy:"",isActive:!0,adherence:"good"}),j(null),h(!1)},C=a=>{if(confirm("Are you sure you want to remove this medication?")){const s=l.medications.filter(r=>r.id!==a);x.updatePatientData({medications:s})}},A=a=>{const s=l.medications.map(r=>r.id===a?{...r,isActive:!r.isActive,endDate:r.isActive?new Date().toISOString().split("T")[0]:void 0}:r);x.updatePatientData({medications:s})},I=a=>{switch(a){case"excellent":return"bg-green-100 text-green-800";case"good":return"bg-blue-100 text-blue-800";case"fair":return"bg-yellow-100 text-yellow-800";case"poor":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},M=u();return e.jsxs("div",{className:"space-y-6",children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(J,{className:"w-6 h-6 text-primary-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Medication Management"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[l.demographics.firstName," ",l.demographics.lastName," - Current medications and history"]})]})]}),e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Medication"})]})]})}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"w-4 h-4 text-gray-400"}),e.jsxs("select",{value:g,onChange:a=>R(a.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"all",children:"All Medications"}),e.jsx("option",{value:"active",children:"Active Only"}),e.jsx("option",{value:"inactive",children:"Inactive Only"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{className:"w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search medications...",value:S,onChange:a=>p(a.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[M.length," medication",M.length!==1?"s":""," found"]})]})}),e.jsx("div",{className:"space-y-4",children:M.length===0?e.jsx(v,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(J,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Medications Found"}),e.jsx("p",{className:"text-gray-400",children:S||g!=="all"?"Try adjusting your search or filter criteria":"Add the first medication to get started"})]})}):M.map(a=>e.jsx(v,{className:`${a.isActive?"":"bg-gray-50 border-gray-200"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.drugName}),e.jsxs("div",{className:"flex items-center space-x-2",children:[a.isActive?e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(W,{className:"w-3 h-3 mr-1"}),"Active"]}):e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[e.jsx(_,{className:"w-3 h-3 mr-1"}),"Inactive"]}),a.adherence&&e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${I(a.adherence)}`,children:[a.adherence," adherence"]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Dosage & Frequency:"}),e.jsxs("p",{className:"text-gray-900",children:[a.dosage," ",a.frequency]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Route:"}),e.jsx("p",{className:"text-gray-900",children:a.route})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Start Date:"}),e.jsx("p",{className:"text-gray-900",children:new Date(a.startDate).toLocaleDateString()})]})]}),a.indication&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Indication:"}),e.jsx("p",{className:"text-gray-900",children:a.indication})]}),a.prescribedBy&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Prescribed by:"}),e.jsx("p",{className:"text-gray-900",children:a.prescribedBy})]}),a.endDate&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"End Date:"}),e.jsx("p",{className:"text-gray-900",children:new Date(a.endDate).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(k,{content:a.isActive?"Mark as inactive":"Mark as active",children:e.jsx("button",{onClick:()=>A(a.id),className:`p-2 rounded-lg ${a.isActive?"text-green-600 hover:bg-green-50":"text-gray-400 hover:bg-gray-50"}`,children:a.isActive?e.jsx(W,{className:"w-4 h-4"}):e.jsx(_,{className:"w-4 h-4"})})}),e.jsx(k,{content:"Edit medication",children:e.jsx("button",{onClick:()=>P(a),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",children:e.jsx(Z,{className:"w-4 h-4"})})}),e.jsx(k,{content:"Remove medication",children:e.jsx("button",{onClick:()=>C(a.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:e.jsx(G,{className:"w-4 h-4"})})})]})]})},a.id))}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:y?"Edit Medication":"Add New Medication"})}),e.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto max-h-[60vh]",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Drug Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:n.drugName||"",onChange:a=>c({...n,drugName:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Tamoxifen"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Dosage ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:n.dosage||"",onChange:a=>c({...n,dosage:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., 20 mg"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Frequency ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:n.frequency||"",onChange:a=>c({...n,frequency:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Select frequency"}),e.jsx("option",{value:"Once daily",children:"Once daily"}),e.jsx("option",{value:"Twice daily",children:"Twice daily"}),e.jsx("option",{value:"Three times daily",children:"Three times daily"}),e.jsx("option",{value:"Four times daily",children:"Four times daily"}),e.jsx("option",{value:"Every other day",children:"Every other day"}),e.jsx("option",{value:"Weekly",children:"Weekly"}),e.jsx("option",{value:"Every 3 weeks",children:"Every 3 weeks"}),e.jsx("option",{value:"Monthly",children:"Monthly"}),e.jsx("option",{value:"As needed",children:"As needed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Route"}),e.jsxs("select",{value:n.route||"Oral",onChange:a=>c({...n,route:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"Oral",children:"Oral"}),e.jsx("option",{value:"IV",children:"Intravenous (IV)"}),e.jsx("option",{value:"IM",children:"Intramuscular (IM)"}),e.jsx("option",{value:"SC",children:"Subcutaneous (SC)"}),e.jsx("option",{value:"Topical",children:"Topical"}),e.jsx("option",{value:"Inhalation",children:"Inhalation"}),e.jsx("option",{value:"Other",children:"Other"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:n.startDate||"",onChange:a=>c({...n,startDate:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:n.endDate||"",onChange:a=>c({...n,endDate:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Indication"}),e.jsx("input",{type:"text",value:n.indication||"",onChange:a=>c({...n,indication:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Breast cancer adjuvant therapy"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prescribed By"}),e.jsx("input",{type:"text",value:n.prescribedBy||"",onChange:a=>c({...n,prescribedBy:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Dr. Smith"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adherence"}),e.jsxs("select",{value:n.adherence||"good",onChange:a=>c({...n,adherence:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"excellent",children:"Excellent"}),e.jsx("option",{value:"good",children:"Good"}),e.jsx("option",{value:"fair",children:"Fair"}),e.jsx("option",{value:"poor",children:"Poor"})]})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:n.isActive!==!1,onChange:a=>c({...n,isActive:a.target.checked}),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Active medication"})]})})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-between",children:[e.jsx("button",{onClick:()=>{h(!1),j(null),c({drugName:"",dosage:"",frequency:"",route:"Oral",startDate:new Date().toISOString().split("T")[0],indication:"",prescribedBy:"",isActive:!0,adherence:"good"})},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:y?d:f,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:y?"Update Medication":"Add Medication"})]})]})})]})},Ve=({patientId:L})=>{const{state:T,actions:x}=E(),{currentPatient:l}=T,[o,h]=b.useState(!1),[y,j]=b.useState(null),[g,R]=b.useState(""),[S,p]=b.useState("all"),[n,c]=b.useState({geneSymbol:"",alleles:["",""],phenotype:"",metabolizerStatus:"normal",testDate:new Date().toISOString().split("T")[0],testMethod:"",clinicalSignificance:"",notes:""});if(!l)return e.jsx(v,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ee,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Patient Selected"}),e.jsx("p",{className:"text-gray-400",children:"Select a patient to manage their genomic data"})]})});const u=()=>{let s=l.genetics||[];const r=["CYP2D6","CYP2C19","CYP2C9","CYP3A4","TPMT","UGT1A1","DPYD","NUDT15"];return S==="pharmacogenomic"?s=s.filter(t=>r.includes(t.geneSymbol.toUpperCase())):S==="oncologic"&&(s=s.filter(t=>!r.includes(t.geneSymbol.toUpperCase()))),g.trim()&&(s=s.filter(t=>t.geneSymbol.toLowerCase().includes(g.toLowerCase())||t.phenotype.toLowerCase().includes(g.toLowerCase())||t.clinicalSignificance?.toLowerCase().includes(g.toLowerCase()))),s},f=()=>{if(!n.geneSymbol||!n.phenotype){alert("Please fill in gene symbol and phenotype");return}const s={geneSymbol:n.geneSymbol,alleles:n.alleles.filter(t=>t.trim()!==""),phenotype:n.phenotype,metabolizerStatus:n.metabolizerStatus,testDate:n.testDate||new Date().toISOString().split("T")[0],testMethod:n.testMethod,clinicalSignificance:n.clinicalSignificance,notes:n.notes},r=[...l.genetics||[],s];x.updatePatientData({genetics:r}),c({geneSymbol:"",alleles:["",""],phenotype:"",metabolizerStatus:"normal",testDate:new Date().toISOString().split("T")[0],testMethod:"",clinicalSignificance:"",notes:""}),h(!1)},P=s=>{j(s),c({...s,alleles:s.alleles.length<2?[...s.alleles,"",""]:s.alleles}),h(!0)},d=()=>{if(!y||!n.geneSymbol||!n.phenotype){alert("Please fill in gene symbol and phenotype");return}const s=l.genetics.map(r=>r.geneSymbol===y.geneSymbol&&r.testDate===y.testDate?{...n,geneSymbol:n.geneSymbol,alleles:n.alleles.filter(t=>t.trim()!==""),phenotype:n.phenotype}:r);x.updatePatientData({genetics:s}),c({geneSymbol:"",alleles:["",""],phenotype:"",metabolizerStatus:"normal",testDate:new Date().toISOString().split("T")[0],testMethod:"",clinicalSignificance:"",notes:""}),j(null),h(!1)},C=s=>{if(confirm("Are you sure you want to remove this genetic data?")){const r=l.genetics.filter(t=>!(t.geneSymbol===s.geneSymbol&&t.testDate===s.testDate));x.updatePatientData({genetics:r})}},A=s=>{switch(s){case"poor":return"bg-red-100 text-red-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"normal":return"bg-green-100 text-green-800";case"rapid":return"bg-blue-100 text-blue-800";case"ultra-rapid":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},I=s=>{if(!s)return"bg-gray-100 text-gray-800";const r=s.toLowerCase();return r.includes("high")||r.includes("pathogenic")?"bg-red-100 text-red-800":r.includes("moderate")||r.includes("likely")?"bg-yellow-100 text-yellow-800":r.includes("low")||r.includes("benign")?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"},M=()=>[{gene:"CYP2D6",description:"Metabolizes many antidepressants, antipsychotics, and opioids"},{gene:"CYP2C19",description:"Metabolizes proton pump inhibitors, clopidogrel, and some antidepressants"},{gene:"CYP2C9",description:"Metabolizes warfarin, phenytoin, and NSAIDs"},{gene:"CYP3A4",description:"Metabolizes many medications including some chemotherapy drugs"},{gene:"TPMT",description:"Metabolizes thiopurine drugs (azathioprine, mercaptopurine)"},{gene:"UGT1A1",description:"Metabolizes irinotecan and affects bilirubin levels"},{gene:"DPYD",description:"Metabolizes fluoropyrimidines (5-FU, capecitabine)"},{gene:"NUDT15",description:"Affects thiopurine metabolism, important in Asian populations"}],a=u();return e.jsxs("div",{className:"space-y-6",children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ee,{className:"w-6 h-6 text-primary-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Genomic Profile"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[l.demographics.firstName," ",l.demographics.lastName," - Genetic testing results and pharmacogenomics"]})]})]}),e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Genetic Data"})]})]})}),a.some(s=>s.metabolizerStatus==="poor"||s.metabolizerStatus==="ultra-rapid")&&e.jsx(ae,{type:"warning",title:"Pharmacogenomic Considerations",children:e.jsx("p",{className:"text-sm",children:"This patient has genetic variants that may affect drug metabolism. Review medication dosing and selection based on pharmacogenomic guidance."})}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"w-4 h-4 text-gray-400"}),e.jsxs("select",{value:S,onChange:s=>p(s.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"all",children:"All Genetic Data"}),e.jsx("option",{value:"pharmacogenomic",children:"Pharmacogenomic"}),e.jsx("option",{value:"oncologic",children:"Oncologic"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{className:"w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search genes...",value:g,onChange:s=>R(s.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[a.length," result",a.length!==1?"s":""," found"]})]})}),e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(F,{className:"w-5 h-5 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Common Pharmacogenes"}),e.jsx(k,{content:"These genes are commonly tested for drug metabolism and dosing guidance",children:e.jsx(F,{className:"w-4 h-4 text-gray-400"})})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-3",children:M().map(({gene:s,description:r})=>{const t=a.some(m=>m.geneSymbol.toUpperCase()===s);return e.jsxs("div",{className:`p-3 rounded-lg border ${t?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s}),t&&e.jsx(W,{className:"w-4 h-4 text-green-600"})]}),e.jsx("p",{className:"text-xs text-gray-600",children:r})]},s)})})]}),e.jsx("div",{className:"space-y-4",children:a.length===0?e.jsx(v,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ee,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Genetic Data Found"}),e.jsx("p",{className:"text-gray-400",children:g||S!=="all"?"Try adjusting your search or filter criteria":"Add genetic testing results to enable pharmacogenomic guidance"})]})}):a.map((s,r)=>e.jsx(v,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.geneSymbol}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.metabolizerStatus&&e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${A(s.metabolizerStatus)}`,children:[s.metabolizerStatus," metabolizer"]}),s.clinicalSignificance&&e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${I(s.clinicalSignificance)}`,children:s.clinicalSignificance})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Alleles:"}),e.jsx("p",{className:"text-gray-900",children:s.alleles.join(" / ")||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Phenotype:"}),e.jsx("p",{className:"text-gray-900",children:s.phenotype})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Test Date:"}),e.jsx("p",{className:"text-gray-900",children:new Date(s.testDate).toLocaleDateString()})]})]}),s.testMethod&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Test Method:"}),e.jsx("p",{className:"text-gray-900",children:s.testMethod})]}),s.geneFunction&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Gene Function:"}),e.jsx("p",{className:"text-gray-900",children:s.geneFunction})]}),s.notes&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Notes:"}),e.jsx("p",{className:"text-gray-900",children:s.notes})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(k,{content:"Edit genetic data",children:e.jsx("button",{onClick:()=>P(s),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",children:e.jsx(Z,{className:"w-4 h-4"})})}),e.jsx(k,{content:"Remove genetic data",children:e.jsx("button",{onClick:()=>C(s),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:e.jsx(G,{className:"w-4 h-4"})})})]})]})},`${s.geneSymbol}-${s.testDate}-${r}`))}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:y?"Edit Genetic Data":"Add Genetic Data"})}),e.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto max-h-[60vh]",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Gene Symbol ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:n.geneSymbol||"",onChange:s=>c({...n,geneSymbol:s.target.value.toUpperCase()}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., CYP2D6"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Phenotype ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:n.phenotype||"",onChange:s=>c({...n,phenotype:s.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Intermediate Metabolizer"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Allele 1"}),e.jsx("input",{type:"text",value:n.alleles&&n.alleles[0]||"",onChange:s=>{const r=[...n.alleles||["",""]];r[0]=s.target.value,c({...n,alleles:r})},className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., *1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Allele 2"}),e.jsx("input",{type:"text",value:n.alleles&&n.alleles[1]||"",onChange:s=>{const r=[...n.alleles||["",""]];r[1]=s.target.value,c({...n,alleles:r})},className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., *4"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Metabolizer Status"}),e.jsxs("select",{value:n.metabolizerStatus||"normal",onChange:s=>c({...n,metabolizerStatus:s.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"poor",children:"Poor Metabolizer"}),e.jsx("option",{value:"intermediate",children:"Intermediate Metabolizer"}),e.jsx("option",{value:"normal",children:"Normal Metabolizer"}),e.jsx("option",{value:"rapid",children:"Rapid Metabolizer"}),e.jsx("option",{value:"ultra-rapid",children:"Ultra-Rapid Metabolizer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Date"}),e.jsx("input",{type:"date",value:n.testDate||"",onChange:s=>c({...n,testDate:s.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Method"}),e.jsx("input",{type:"text",value:n.testMethod||"",onChange:s=>c({...n,testMethod:s.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., PCR-RFLP, Sequencing, Array"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clinical Significance"}),e.jsx("input",{type:"text",value:n.clinicalSignificance||"",onChange:s=>c({...n,clinicalSignificance:s.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Reduced enzyme activity"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:n.notes||"",onChange:s=>c({...n,notes:s.target.value}),rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Additional clinical notes..."})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-between",children:[e.jsx("button",{onClick:()=>{h(!1),j(null),c({geneSymbol:"",alleles:["",""],phenotype:"",metabolizerStatus:"normal",testDate:new Date().toISOString().split("T")[0],testMethod:"",clinicalSignificance:"",notes:""})},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:y?d:f,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:y?"Update Genetic Data":"Add Genetic Data"})]})]})})]})},_e=({patientId:L})=>{const{state:T,actions:x}=E(),{currentPatient:l}=T,[o,h]=b.useState(!1),[y,j]=b.useState(null),[g,R]=b.useState(""),[S,p]=b.useState("all"),[n,c]=b.useState("all"),[u,f]=b.useState({treatmentType:"chemotherapy",regimen:"",drugs:[],startDate:new Date().toISOString().split("T")[0],endDate:"",cycles:1,response:"stable",toxicities:[],notes:""}),[P,d]=b.useState({grade:1,description:"",action:""});if(!l)return e.jsx(v,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Q,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Patient Selected"}),e.jsx("p",{className:"text-gray-400",children:"Select a patient to view their treatment history"})]})});const C=()=>{let i=l.treatmentHistory||[];return S==="active"?i=i.filter(N=>!N.endDate):S==="completed"&&(i=i.filter(N=>N.endDate)),n!=="all"&&(i=i.filter(N=>N.treatmentType===n)),g.trim()&&(i=i.filter(N=>N.regimen?.toLowerCase().includes(g.toLowerCase())||N.drugs?.some($=>$.toLowerCase().includes(g.toLowerCase()))||N.notes?.toLowerCase().includes(g.toLowerCase()))),i.sort((N,$)=>new Date($.startDate).getTime()-new Date(N.startDate).getTime())},A=b.useMemo(()=>(l.treatmentHistory||[]).sort((N,$)=>new Date(N.startDate).getTime()-new Date($.startDate).getTime()).map((N,$)=>({...N,order:$+1})),[l.treatmentHistory]),I=()=>{if(!u.treatmentType||!u.startDate){alert("Please fill in treatment type and start date");return}const i={id:`treatment-${Date.now()}`,treatmentType:u.treatmentType,regimen:u.regimen||"",drugs:u.drugs||[],startDate:u.startDate,endDate:u.endDate,cycles:u.cycles,response:u.response,toxicities:u.toxicities||[],notes:u.notes},N=[...l.treatmentHistory||[],i];x.updatePatientData({treatmentHistory:N}),f({treatmentType:"chemotherapy",regimen:"",drugs:[],startDate:new Date().toISOString().split("T")[0],endDate:"",cycles:1,response:"stable",toxicities:[],notes:""}),h(!1)},M=i=>{j(i),f(i),h(!0)},a=()=>{if(!y||!u.treatmentType||!u.startDate){alert("Please fill in treatment type and start date");return}const i=l.treatmentHistory.map(N=>N.id===y.id?{...u,id:y.id}:N);x.updatePatientData({treatmentHistory:i}),f({treatmentType:"chemotherapy",regimen:"",drugs:[],startDate:new Date().toISOString().split("T")[0],endDate:"",cycles:1,response:"stable",toxicities:[],notes:""}),j(null),h(!1)},s=i=>{if(confirm("Are you sure you want to remove this treatment?")){const N=l.treatmentHistory.filter($=>$.id!==i);x.updatePatientData({treatmentHistory:N})}},r=i=>{switch(i){case"complete":return"bg-green-100 text-green-800";case"partial":return"bg-blue-100 text-blue-800";case"stable":return"bg-yellow-100 text-yellow-800";case"progression":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},t=i=>{switch(i){case"complete":return e.jsx(W,{className:"w-4 h-4"});case"partial":return e.jsx(H,{className:"w-4 h-4"});case"stable":return e.jsx(ye,{className:"w-4 h-4"});case"progression":return e.jsx(he,{className:"w-4 h-4"});default:return e.jsx(_,{className:"w-4 h-4"})}},m=i=>{switch(i){case"chemotherapy":return e.jsx(ve,{className:"w-5 h-5"});case"radiation":return e.jsx(se,{className:"w-5 h-5"});case"surgery":return e.jsx(ze,{className:"w-5 h-5"});case"immunotherapy":return e.jsx(V,{className:"w-5 h-5"});case"targeted":return e.jsx(se,{className:"w-5 h-5"});default:return e.jsx(Q,{className:"w-5 h-5"})}},w=i=>{switch(i){case 1:return"bg-green-100 text-green-800";case 2:return"bg-yellow-100 text-yellow-800";case 3:return"bg-orange-100 text-orange-800";case 4:return"bg-red-100 text-red-800";case 5:return"bg-red-200 text-red-900";default:return"bg-gray-100 text-gray-800"}},D=()=>{P.description&&P.action&&(f({...u,toxicities:[...u.toxicities||[],{...P,grade:P.grade}]}),d({grade:1,description:"",action:""}))},O=C();return e.jsxs("div",{className:"space-y-6",children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Q,{className:"w-6 h-6 text-primary-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Treatment History"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[l.demographics.firstName," ",l.demographics.lastName," - Complete treatment timeline and outcomes"]})]})]}),e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Treatment"})]})]})}),A.length>0&&e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(V,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Treatment Summary"}),e.jsx(k,{content:"Overview of all treatments and their outcomes",children:e.jsx(F,{className:"w-4 h-4 text-gray-400"})})]}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Total Treatments"}),e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:A.length})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Complete/Partial Response"}),e.jsx("div",{className:"text-2xl font-bold text-green-900",children:A.filter(i=>i.response==="complete"||i.response==="partial").length})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-yellow-600 font-medium",children:"Active Treatments"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-900",children:A.filter(i=>!i.endDate).length})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-red-600 font-medium",children:"Grade 3+ Toxicities"}),e.jsx("div",{className:"text-2xl font-bold text-red-900",children:A.reduce((i,N)=>i+(N.toxicities?.filter($=>$.grade>=3).length||0),0)})]})]})]}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"w-4 h-4 text-gray-400"}),e.jsxs("select",{value:S,onChange:i=>p(i.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"all",children:"All Treatments"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("select",{value:n,onChange:i=>c(i.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"chemotherapy",children:"Chemotherapy"}),e.jsx("option",{value:"radiation",children:"Radiation"}),e.jsx("option",{value:"surgery",children:"Surgery"}),e.jsx("option",{value:"immunotherapy",children:"Immunotherapy"}),e.jsx("option",{value:"targeted",children:"Targeted"}),e.jsx("option",{value:"other",children:"Other"})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{className:"w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search treatments...",value:g,onChange:i=>R(i.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[O.length," treatment",O.length!==1?"s":""," found"]})]})}),e.jsx("div",{className:"space-y-4",children:O.length===0?e.jsx(v,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Q,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Treatments Found"}),e.jsx("p",{className:"text-gray-400",children:g||S!=="all"||n!=="all"?"Try adjusting your search or filter criteria":"Add the first treatment to start building the treatment history"})]})}):O.map((i,N)=>e.jsxs(v,{className:"relative",children:[N<O.length-1&&e.jsx("div",{className:"absolute left-8 top-16 w-0.5 h-full bg-gray-200 -z-10"}),e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center ${i.endDate?"bg-gray-100 text-gray-600":"bg-primary-100 text-primary-600"}`,children:m(i.treatmentType)}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 capitalize",children:[i.treatmentType," ",i.regimen&&`- ${i.regimen}`]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[!i.endDate&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(_,{className:"w-3 h-3 mr-1"}),"Active"]}),i.response&&e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${r(i.response)}`,children:[t(i.response),e.jsxs("span",{className:"ml-1 capitalize",children:[i.response," response"]})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Start Date:"}),e.jsx("p",{className:"text-gray-900",children:new Date(i.startDate).toLocaleDateString()})]}),i.endDate&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"End Date:"}),e.jsx("p",{className:"text-gray-900",children:new Date(i.endDate).toLocaleDateString()})]}),i.cycles&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Cycles:"}),e.jsx("p",{className:"text-gray-900",children:i.cycles})]})]}),i.drugs&&i.drugs.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"font-medium text-gray-700 text-sm",children:"Drugs:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:i.drugs.map(($,U)=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-50 text-blue-800",children:$},U))})]}),i.toxicities&&i.toxicities.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"font-medium text-gray-700 text-sm",children:"Toxicities:"}),e.jsx("div",{className:"space-y-1 mt-1",children:i.toxicities.map(($,U)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${w($.grade)}`,children:["Grade ",$.grade]}),e.jsx("span",{className:"text-sm text-gray-900",children:$.description}),e.jsxs("span",{className:"text-xs text-gray-600",children:["(",$.action,")"]})]},U))})]}),i.notes&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Notes:"}),e.jsx("p",{className:"text-gray-900 mt-1",children:i.notes})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(k,{content:"Edit treatment",children:e.jsx("button",{onClick:()=>M(i),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",children:e.jsx(Z,{className:"w-4 h-4"})})}),e.jsx(k,{content:"Remove treatment",children:e.jsx("button",{onClick:()=>s(i.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:e.jsx(G,{className:"w-4 h-4"})})})]})]})})]})]},i.id))}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:y?"Edit Treatment":"Add Treatment"})}),e.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto max-h-[70vh]",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Treatment Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:u.treatmentType||"chemotherapy",onChange:i=>f({...u,treatmentType:i.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"chemotherapy",children:"Chemotherapy"}),e.jsx("option",{value:"radiation",children:"Radiation"}),e.jsx("option",{value:"surgery",children:"Surgery"}),e.jsx("option",{value:"immunotherapy",children:"Immunotherapy"}),e.jsx("option",{value:"targeted",children:"Targeted Therapy"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Regimen/Protocol"}),e.jsx("input",{type:"text",value:u.regimen||"",onChange:i=>f({...u,regimen:i.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., FOLFOX, AC-T"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Drugs (comma-separated)"}),e.jsx("input",{type:"text",value:u.drugs?.join(", ")||"",onChange:i=>f({...u,drugs:i.target.value.split(",").map(N=>N.trim()).filter(N=>N)}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Doxorubicin, Cyclophosphamide"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Start Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:u.startDate||"",onChange:i=>f({...u,startDate:i.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:u.endDate||"",onChange:i=>f({...u,endDate:i.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cycles"}),e.jsx("input",{type:"number",value:u.cycles||"",onChange:i=>f({...u,cycles:i.target.value?parseInt(i.target.value):void 0}),min:"1",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Response"}),e.jsxs("select",{value:u.response||"stable",onChange:i=>f({...u,response:i.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"complete",children:"Complete Response"}),e.jsx("option",{value:"partial",children:"Partial Response"}),e.jsx("option",{value:"stable",children:"Stable Disease"}),e.jsx("option",{value:"progression",children:"Disease Progression"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Toxicities"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[e.jsx("div",{className:"col-span-2",children:e.jsxs("select",{value:P.grade,onChange:i=>d({...P,grade:parseInt(i.target.value)}),className:"w-full border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:1,children:"Grade 1"}),e.jsx("option",{value:2,children:"Grade 2"}),e.jsx("option",{value:3,children:"Grade 3"}),e.jsx("option",{value:4,children:"Grade 4"}),e.jsx("option",{value:5,children:"Grade 5"})]})}),e.jsx("div",{className:"col-span-5",children:e.jsx("input",{type:"text",placeholder:"Toxicity description",value:P.description,onChange:i=>d({...P,description:i.target.value}),className:"w-full border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})}),e.jsx("div",{className:"col-span-4",children:e.jsx("input",{type:"text",placeholder:"Action taken",value:P.action,onChange:i=>d({...P,action:i.target.value}),className:"w-full border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("button",{type:"button",onClick:D,className:"w-full h-8 bg-primary-600 text-white rounded-md hover:bg-primary-700 text-sm",children:"+"})})]}),u.toxicities&&u.toxicities.length>0&&e.jsx("div",{className:"space-y-1",children:u.toxicities.map((i,N)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${w(i.grade)}`,children:["Grade ",i.grade]}),e.jsx("span",{className:"text-sm",children:i.description}),e.jsxs("span",{className:"text-xs text-gray-600",children:["(",i.action,")"]})]}),e.jsx("button",{type:"button",onClick:()=>f({...u,toxicities:u.toxicities?.filter(($,U)=>U!==N)}),className:"text-red-600 hover:text-red-800",children:e.jsx(G,{className:"w-4 h-4"})})]},N))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:u.notes||"",onChange:i=>f({...u,notes:i.target.value}),rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Additional treatment notes..."})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-between",children:[e.jsx("button",{onClick:()=>{h(!1),j(null),f({treatmentType:"chemotherapy",regimen:"",drugs:[],startDate:new Date().toISOString().split("T")[0],endDate:"",cycles:1,response:"stable",toxicities:[],notes:""})},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:y?a:I,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:y?"Update Treatment":"Add Treatment"})]})]})})]})},Ye=({patientId:L})=>{const{state:T,actions:x}=E(),{currentPatient:l}=T,[o,h]=b.useState(!1),[y,j]=b.useState(null),[g,R]=b.useState("all"),S=()=>{if(!l)return[];const t=l.notes?.filter(m=>m.type==="clinical"&&m.content.startsWith("OUTCOME_DATA:"));return t?t.map(m=>{try{return{...JSON.parse(m.content.replace("OUTCOME_DATA:","")),id:m.id}}catch{return null}}).filter(Boolean):[]},[p,n]=b.useState({type:"response",measurement:"",value:"",unit:"",date:new Date().toISOString().split("T")[0],notes:"",treatmentRelated:""});if(!l)return e.jsx(v,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(H,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Patient Selected"}),e.jsx("p",{className:"text-gray-400",children:"Select a patient to track their outcomes"})]})});const c=S(),u=g==="all"?c:c.filter(t=>t.type===g),f=()=>{if(!p.measurement||!p.value||!p.date){alert("Please fill in measurement, value, and date");return}const t={id:`outcome-${Date.now()}`,type:p.type,measurement:p.measurement,value:p.value,unit:p.unit,date:p.date,notes:p.notes,treatmentRelated:p.treatmentRelated},m=`OUTCOME_DATA:${JSON.stringify(t)}`,w=[...l.notes||[],{id:t.id,timestamp:new Date().toISOString(),author:"current-user",type:"clinical",content:m}];x.updatePatientData({notes:w}),n({type:"response",measurement:"",value:"",unit:"",date:new Date().toISOString().split("T")[0],notes:"",treatmentRelated:""}),h(!1)},P=t=>{j(t),n(t),h(!0)},d=()=>{if(!y||!p.measurement||!p.value||!p.date){alert("Please fill in measurement, value, and date");return}const t={...p,id:y.id},m=`OUTCOME_DATA:${JSON.stringify(t)}`,w=l.notes?.map(D=>D.id===y.id?{...D,content:m}:D)||[];x.updatePatientData({notes:w}),n({type:"response",measurement:"",value:"",unit:"",date:new Date().toISOString().split("T")[0],notes:"",treatmentRelated:""}),j(null),h(!1)},C=t=>{if(confirm("Are you sure you want to remove this outcome data?")){const m=l.notes?.filter(w=>w.id!==t)||[];x.updatePatientData({notes:m})}},A=t=>{switch(t){case"survival":return e.jsx(ue,{className:"w-4 h-4"});case"response":return e.jsx(se,{className:"w-4 h-4"});case"quality_of_life":return e.jsx(V,{className:"w-4 h-4"});case"biomarker":return e.jsx(oe,{className:"w-4 h-4"});case"functional_status":return e.jsx(H,{className:"w-4 h-4"});default:return e.jsx(F,{className:"w-4 h-4"})}},I=t=>{switch(t){case"survival":return"bg-red-100 text-red-800";case"response":return"bg-green-100 text-green-800";case"quality_of_life":return"bg-blue-100 text-blue-800";case"biomarker":return"bg-purple-100 text-purple-800";case"functional_status":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},M=(t,m)=>{const w=typeof t=="number"?t:parseFloat(t.toString());if(isNaN(w))return null;const D=m.toLowerCase();return D.includes("tumor")||D.includes("lesion")||D.includes("mass")?w<20?"improving":w>50?"worsening":"stable":D.includes("quality")||D.includes("karnofsky")||D.includes("ecog")?w>80?"improving":w<40?"worsening":"stable":null},a=t=>{switch(t){case"improving":return e.jsx(H,{className:"w-4 h-4 text-green-600"});case"worsening":return e.jsx(he,{className:"w-4 h-4 text-red-600"});case"stable":return e.jsx(ye,{className:"w-4 h-4 text-yellow-600"});default:return null}},s=b.useMemo(()=>{const m=c.filter(i=>i.type==="response").sort((i,N)=>new Date(N.date).getTime()-new Date(i.date).getTime())[0],w=c.filter(i=>i.type==="survival"),D=c.filter(i=>i.type==="quality_of_life"),O=c.filter(i=>i.type==="biomarker");return{totalOutcomes:c.length,latestResponse:m?.value||"Not assessed",survivalData:w.length>0,qolTracked:D.length>0,biomarkersTracked:O.length>0}},[c]),r={survival:["Overall Survival (months)","Disease-Free Survival (months)","Progression-Free Survival (months)"],response:["RECIST Response","Tumor Size (cm)","Target Lesion Sum (cm)","Response Rate (%)"],quality_of_life:["EORTC QLQ-C30 Score","Karnofsky Performance Score","ECOG Performance Status","Pain Score (0-10)"],biomarker:["PSA (ng/mL)","CA 19-9 (U/mL)","CEA (ng/mL)","CA-125 (U/mL)","AFP (ng/mL)"],functional_status:["Activities of Daily Living","Mobility Score","Cognitive Function","Social Function"]};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(H,{className:"w-6 h-6 text-primary-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Outcome Tracking"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[l.demographics.firstName," ",l.demographics.lastName," - Treatment outcomes and response monitoring"]})]})]}),e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Outcome"})]})]})}),e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(oe,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Outcome Summary"}),e.jsx(k,{content:"Overview of tracked outcomes and current status",children:e.jsx(F,{className:"w-4 h-4 text-gray-400"})})]}),e.jsxs("div",{className:"grid md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Total Outcomes"}),e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:s.totalOutcomes})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Latest Response"}),e.jsx("div",{className:"text-lg font-bold text-green-900 truncate",children:s.latestResponse})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-red-600 font-medium",children:"Survival Data"}),e.jsx("div",{className:"text-2xl font-bold text-red-900",children:s.survivalData?"â":"â"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"QoL Tracked"}),e.jsx("div",{className:"text-2xl font-bold text-purple-900",children:s.qolTracked?"â":"â"})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-orange-600 font-medium",children:"Biomarkers"}),e.jsx("div",{className:"text-2xl font-bold text-orange-900",children:s.biomarkersTracked?"â":"â"})]})]})]}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("select",{value:g,onChange:t=>R(t.target.value),className:"border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"all",children:"All Outcome Types"}),e.jsx("option",{value:"survival",children:"Survival Outcomes"}),e.jsx("option",{value:"response",children:"Response Assessment"}),e.jsx("option",{value:"quality_of_life",children:"Quality of Life"}),e.jsx("option",{value:"biomarker",children:"Biomarkers"}),e.jsx("option",{value:"functional_status",children:"Functional Status"})]})}),e.jsxs("div",{className:"text-sm text-gray-600",children:[u.length," outcome",u.length!==1?"s":""," found"]})]})}),e.jsx("div",{className:"space-y-4",children:u.length===0?e.jsx(v,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(H,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Outcomes Found"}),e.jsx("p",{className:"text-gray-400",children:g!=="all"?`No ${g.replace("_"," ")} outcomes recorded yet`:"Start tracking treatment outcomes and patient responses"})]})}):u.sort((t,m)=>new Date(m.date).getTime()-new Date(t.date).getTime()).map(t=>{const m=M(t.value,t.measurement);return e.jsx(v,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${I(t.type)}`,children:[A(t.type),e.jsx("span",{className:"ml-1 capitalize",children:t.type.replace("_"," ")})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.measurement}),a(m)]}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Value:"}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:[t.value," ",t.unit&&t.unit]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Date:"}),e.jsx("p",{className:"text-gray-900",children:new Date(t.date).toLocaleDateString()})]}),t.treatmentRelated&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Related Treatment:"}),e.jsx("p",{className:"text-gray-900",children:t.treatmentRelated})]}),m&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Trend:"}),e.jsx("p",{className:`font-medium capitalize ${m==="improving"?"text-green-600":m==="worsening"?"text-red-600":"text-yellow-600"}`,children:m})]})]}),t.notes&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Notes:"}),e.jsx("p",{className:"text-gray-900",children:t.notes})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(k,{content:"Edit outcome",children:e.jsx("button",{onClick:()=>P(t),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",children:e.jsx(Z,{className:"w-4 h-4"})})}),e.jsx(k,{content:"Remove outcome",children:e.jsx("button",{onClick:()=>C(t.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:e.jsx(G,{className:"w-4 h-4"})})})]})]})},t.id)})}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:y?"Edit Outcome":"Add Outcome"})}),e.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto max-h-[60vh]",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Outcome Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:p.type||"response",onChange:t=>n({...p,type:t.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"response",children:"Response Assessment"}),e.jsx("option",{value:"survival",children:"Survival Outcome"}),e.jsx("option",{value:"quality_of_life",children:"Quality of Life"}),e.jsx("option",{value:"biomarker",children:"Biomarker"}),e.jsx("option",{value:"functional_status",children:"Functional Status"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Measurement ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:p.measurement||"",onChange:t=>n({...p,measurement:t.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Tumor Size, ECOG Score",list:"measurement-suggestions"}),e.jsx("datalist",{id:"measurement-suggestions",children:p.type&&r[p.type]?.map((t,m)=>e.jsx("option",{value:t},m))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Value ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:p.value||"",onChange:t=>n({...p,value:t.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., 5.2, Complete Response"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit"}),e.jsx("input",{type:"text",value:p.unit||"",onChange:t=>n({...p,unit:t.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., cm, %, ng/mL"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:p.date||"",onChange:t=>n({...p,date:t.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Treatment"}),e.jsxs("select",{value:p.treatmentRelated||"",onChange:t=>n({...p,treatmentRelated:t.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Select treatment (optional)"}),l.treatmentHistory?.map(t=>e.jsxs("option",{value:t.regimen||t.treatmentType,children:[t.regimen||t.treatmentType," (",new Date(t.startDate).toLocaleDateString(),")"]},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:p.notes||"",onChange:t=>n({...p,notes:t.target.value}),rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Additional notes about this outcome..."})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-between",children:[e.jsx("button",{onClick:()=>{h(!1),j(null),n({type:"response",measurement:"",value:"",unit:"",date:new Date().toISOString().split("T")[0],notes:"",treatmentRelated:""})},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:y?d:f,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:y?"Update Outcome":"Add Outcome"})]})]})})]})},Ke=({patientId:L})=>{const{state:T}=E(),{currentPatient:x}=T,[l,o]=b.useState({demographics:!0,medications:!0,allergies:!0,conditions:!0,vitals:!0,labValues:!0,genetics:!1,treatmentHistory:!0,notes:!1}),[h,y]=b.useState("summary"),[j,g]=b.useState("download"),[R,S]=b.useState(""),[p,n]=b.useState(!0),[c,u]=b.useState(!1);if(!x)return e.jsx(v,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(q,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No Patient Selected"}),e.jsx("p",{className:"text-gray-400",children:"Select a patient to export their data"})]})});const f=()=>{const s={patientInfo:{id:x.id,name:`${x.demographics.firstName} ${x.demographics.lastName}`,mrn:x.demographics.mrn,exportDate:new Date().toISOString(),exportedBy:"current-user"}};return l.demographics&&(s.demographics=x.demographics),l.medications&&(s.medications=x.medications),l.allergies&&(s.allergies=x.allergies),l.conditions&&(s.conditions=x.conditions),l.vitals&&(s.vitals=x.vitals),l.labValues&&(s.labValues=x.labValues),l.genetics&&(s.genetics=x.genetics),l.treatmentHistory&&(s.treatmentHistory=x.treatmentHistory),l.notes&&(s.notes=x.notes),s},P=()=>{const s=f(),r=p?new Date().toLocaleString():"";return`
PATIENT SUMMARY REPORT
${r?`Generated: ${r}`:""}
${"-".repeat(50)}

PATIENT INFORMATION
Name: ${s.patientInfo.name}
MRN: ${s.patientInfo.mrn||"Not specified"}
Date of Birth: ${s.demographics?.dateOfBirth||"Not specified"}
Sex: ${s.demographics?.sex||"Not specified"}
${s.demographics?.heightCm?`Height: ${s.demographics.heightCm} cm`:""}
${s.demographics?.weightKg?`Weight: ${s.demographics.weightKg} kg`:""}

${s.allergies?.length>0?`
ALLERGIES
${s.allergies.map(t=>`â¢ ${t.allergen} (${t.severity}) - ${t.reaction}`).join(`
`)}
`:""}

${s.conditions?.length>0?`
MEDICAL CONDITIONS
${s.conditions.map(t=>`â¢ ${t.name} (${t.status}) - Diagnosed: ${new Date(t.dateOfDiagnosis).toLocaleDateString()}`).join(`
`)}
`:""}

${s.medications?.length>0?`
CURRENT MEDICATIONS
${s.medications.filter(t=>t.isActive).map(t=>`â¢ ${t.drugName} ${t.dosage} ${t.frequency} (${t.route})`).join(`
`)}
`:""}

${s.treatmentHistory?.length>0?`
TREATMENT HISTORY
${s.treatmentHistory.map(t=>`â¢ ${t.treatmentType}${t.regimen?` - ${t.regimen}`:""} (${new Date(t.startDate).toLocaleDateString()}${t.endDate?` to ${new Date(t.endDate).toLocaleDateString()}`:" - ongoing"})`).join(`
`)}
`:""}

${s.vitals?.length>0?`
RECENT VITALS (${new Date(s.vitals[s.vitals.length-1].timestamp).toLocaleDateString()})
${s.vitals[s.vitals.length-1].bloodPressureSystolic?`Blood Pressure: ${s.vitals[s.vitals.length-1].bloodPressureSystolic}/${s.vitals[s.vitals.length-1].bloodPressureDiastolic} mmHg`:""}
${s.vitals[s.vitals.length-1].heartRate?`Heart Rate: ${s.vitals[s.vitals.length-1].heartRate} bpm`:""}
${s.vitals[s.vitals.length-1].temperature?`Temperature: ${s.vitals[s.vitals.length-1].temperature}Â°C`:""}
${s.vitals[s.vitals.length-1].performanceStatus!==void 0?`ECOG Performance Status: ${s.vitals[s.vitals.length-1].performanceStatus}`:""}
`:""}

${s.labValues?.length>0?`
RECENT LAB VALUES
${s.labValues.slice(-5).map(t=>`â¢ ${t.labType}: ${t.value} ${t.unit} (${new Date(t.timestamp).toLocaleDateString()})${t.isAbnormal?" [ABNORMAL]":""}`).join(`
`)}
`:""}

${s.genetics?.length>0?`
GENETIC INFORMATION
${s.genetics.map(t=>`â¢ ${t.geneSymbol}: ${t.phenotype}${t.metabolizerStatus?` (${t.metabolizerStatus} metabolizer)`:""}`).join(`
`)}
`:""}

${"-".repeat(50)}
This report was generated by OncoSafeRx
CONFIDENTIAL MEDICAL INFORMATION
    `.trim()},d=s=>{if(s.medications){const r=["Drug Name","Dosage","Frequency","Route","Start Date","Status"],t=s.medications.map(m=>[m.drugName||"",m.dosage||"",m.frequency||"",m.route||"",m.startDate||"",m.isActive?"Active":"Inactive"]);return[r,...t].map(m=>m.map(w=>`"${w}"`).join(",")).join(`
`)}return"No data selected for CSV export"},C=async()=>{const s=f();let r,t,m;switch(h){case"json":r=JSON.stringify(s,null,2),t=`patient-${x.demographics.firstName}-${x.demographics.lastName}-${Date.now()}.json`,m="application/json";break;case"csv":r=d(s),t=`patient-medications-${Date.now()}.csv`,m="text/csv";break;case"summary":r=P(),t=`patient-summary-${Date.now()}.txt`,m="text/plain";break;default:return}switch(j){case"download":const w=new Blob([r],{type:m}),D=URL.createObjectURL(w),O=document.createElement("a");O.href=D,O.download=t,document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(D);break;case"copy":try{await navigator.clipboard.writeText(r),u(!0),setTimeout(()=>u(!1),2e3)}catch{alert("Failed to copy to clipboard")}break;case"print":const i=window.open("","_blank");i&&(i.document.write(`
            <html>
              <head>
                <title>Patient Report - ${x.demographics.firstName} ${x.demographics.lastName}</title>
                <style>
                  body { font-family: monospace; white-space: pre-wrap; padding: 20px; }
                  @media print { body { margin: 0; } }
                </style>
              </head>
              <body>${r}</body>
            </html>
          `),i.document.close(),i.print());break;case"email":if(!R){alert("Please enter an email address");return}const N=encodeURIComponent(`Patient Report - ${x.demographics.firstName} ${x.demographics.lastName}`),$=encodeURIComponent(r);window.open(`mailto:${R}?subject=${N}&body=${$}`);break}},A=s=>{o(r=>({...r,[s]:!r[s]}))},I=()=>{const s=Object.values(l).every(Boolean),r=Object.keys(l).reduce((t,m)=>({...t,[m]:!s}),{});o(r)},M=()=>{const s=f(),r=JSON.stringify(s),t=new Blob([r]).size;return t<1024?`${t} bytes`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(1)} MB`},a=s=>{if(!x)return 0;switch(s){case"medications":return x.medications?.length||0;case"allergies":return x.allergies?.length||0;case"conditions":return x.conditions?.length||0;case"vitals":return x.vitals?.length||0;case"labValues":return x.labValues?.length||0;case"genetics":return x.genetics?.length||0;case"treatmentHistory":return x.treatmentHistory?.length||0;case"notes":return x.notes?.length||0;case"demographics":return 1;default:return 0}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(q,{className:"w-6 h-6 text-primary-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Data Export & Sharing"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Export ",x.demographics.firstName," ",x.demographics.lastName,"'s data for reporting, backup, or sharing"]})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Export size: ",M()]})]})}),e.jsx(ae,{type:"warning",title:"Privacy & Security Notice",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"mb-2",children:"Patient data contains sensitive health information. Please ensure compliance with HIPAA and institutional policies when sharing or exporting data."}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Only share data with authorized healthcare providers"}),e.jsx("li",{children:"Use secure channels for transmission"}),e.jsx("li",{children:"Remove or de-identify data when possible"}),e.jsx("li",{children:"Delete exported files after use"})]})]})}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Me,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Select Data to Export"})]}),e.jsx("button",{onClick:I,className:"text-sm text-primary-600 hover:text-primary-700",children:Object.values(l).every(Boolean)?"Deselect All":"Select All"})]}),e.jsx("div",{className:"space-y-3",children:Object.entries(l).map(([s,r])=>e.jsxs("label",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:r,onChange:()=>A(s),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-900 capitalize",children:s.replace(/([A-Z])/g," $1").trim()}),e.jsxs("div",{className:"text-sm text-gray-600",children:[a(s)," item",a(s)!==1?"s":""]})]})]}),s==="genetics"&&e.jsx(k,{content:"Genetic data requires special handling and may have additional privacy considerations",children:e.jsx(le,{className:"w-4 h-4 text-yellow-500"})})]},s))})]}),e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx($e,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Export Options"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Export Format"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{value:"summary",label:"Summary Report",icon:te},{value:"json",label:"JSON Data",icon:q},{value:"csv",label:"CSV (Medications)",icon:q},{value:"pdf",label:"PDF Report",icon:te,disabled:!0}].map(({value:s,label:r,icon:t,disabled:m})=>e.jsxs("button",{onClick:()=>!m&&y(s),disabled:m,className:`flex items-center space-x-2 p-3 border rounded-lg text-left transition-colors ${h===s&&!m?"border-primary-500 bg-primary-50 text-primary-700":m?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(t,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:r}),m&&e.jsx("span",{className:"text-xs",children:"(Coming Soon)"})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sharing Method"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{value:"download",label:"Download File",icon:q},{value:"copy",label:"Copy to Clipboard",icon:Re},{value:"print",label:"Print Report",icon:Ie},{value:"email",label:"Email Report",icon:fe}].map(({value:s,label:r,icon:t})=>e.jsxs("button",{onClick:()=>g(s),className:`flex items-center space-x-2 p-3 border rounded-lg text-left transition-colors ${j===s?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(t,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:r})]},s))})]}),j==="email"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:R,onChange:s=>S(s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"recipient@hospital.org"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:p,onChange:s=>n(s.target.checked),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Include timestamp in export"})]})})]})]})]}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ready to Export"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[Object.values(l).filter(Boolean).length," section",Object.values(l).filter(Boolean).length!==1?"s":""," selected â¢ ",h.toUpperCase()," format â¢ ",j," method"]})]}),e.jsxs("button",{onClick:C,disabled:!Object.values(l).some(Boolean),className:"flex items-center space-x-2 px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:[c?e.jsx(W,{className:"w-4 h-4"}):e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{children:c?"Copied!":j==="copy"?"Copy Data":j==="email"?"Send Email":j==="print"?"Print Report":"Download"})]})]})})]})},Qe=()=>{const{state:L,actions:T}=E(),{showToast:x}=pe(),{currentPatient:l,alerts:o,isLoading:h,error:y}=L,j=ge(),[g,R]=b.useState("overview");if(h)return e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Oe,{size:"lg"})});if(!l)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx(z,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium text-gray-500",children:"No Patient Selected"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Select a patient to view their clinical profile"})]});const S=d=>{const C=new Date,A=new Date(d);let I=C.getFullYear()-A.getFullYear();const M=C.getMonth()-A.getMonth();return(M<0||M===0&&C.getDate()<A.getDate())&&I--,I},p=(d,C)=>!d||!C?null:Math.sqrt(d*C/3600),n=()=>o.filter(d=>d.patientId===l.id&&!d.isAcknowledged),c=()=>(l.labValues||[]).sort((d,C)=>new Date(C.timestamp).getTime()-new Date(d.timestamp).getTime()).slice(0,5),u=()=>(l.medications||[]).filter(d=>d.isActive),f=()=>{const d=l.vitals||[];return d.length>0?d.sort((C,A)=>new Date(A.timestamp).getTime()-new Date(C.timestamp).getTime())[0]:null},P=[{id:"overview",label:"Overview",icon:Le},{id:"medications",label:"Medications",icon:J},{id:"labs",label:"Lab Values",icon:ie},{id:"genetics",label:"Genomics",icon:ee},{id:"history",label:"History",icon:Q},{id:"outcomes",label:"Outcomes",icon:V},{id:"export",label:"Export",icon:te}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-end",children:e.jsxs("button",{onClick:async()=>{if(!l||!confirm("Delete this patient?"))return;const d=l;T.removePatient(l.id),x("success","Patient deleted",5e3,{label:"Undo",onClick:async()=>{T.setCurrentPatient(d);try{const{data:C}=await K.auth.getSession(),A=C?.session?.access_token;A&&await fetch("/api/patients",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A}`},body:JSON.stringify({patient:d})})}catch{}}})},className:"inline-flex items-center px-3 py-1.5 text-sm bg-red-600 text-white rounded hover:bg-red-700",children:[e.jsx(G,{className:"w-4 h-4 mr-1"})," Delete Patient"]})}),y&&e.jsx(ae,{type:"error",title:"Error",children:y}),n().length>0&&e.jsx("div",{className:"space-y-2",children:n().map((d,C)=>e.jsx(ae,{type:d.severity==="critical"?"error":d.severity==="high"?"warning":"info",title:d.message,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[d.details&&e.jsx("p",{className:"text-sm mt-1",children:d.details}),d.recommendedAction&&e.jsxs("p",{className:"text-sm mt-2 font-medium",children:["Recommended: ",d.recommendedAction]})]}),e.jsx("button",{onClick:()=>T.acknowledgeAlert(d.id),className:"ml-4 px-3 py-1 text-xs bg-white bg-opacity-20 rounded hover:bg-opacity-30",children:"Acknowledge"})]})},d.id||`alert-${C}`))}),e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx(z,{className:"w-8 h-8 text-primary-600"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[l.demographics.firstName," ",l.demographics.lastName]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mt-1",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Fe,{className:"w-4 h-4"}),e.jsxs("span",{children:[S(l.demographics.dateOfBirth)," years old"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{className:"capitalize",children:l.demographics.sex})]}),l.demographics.mrn&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsxs("span",{children:["MRN: ",l.demographics.mrn]})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{content:"Edit patient information",children:e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:e.jsx(Z,{className:"w-4 h-4"})})}),e.jsx(k,{content:"View clinical alerts",children:e.jsxs("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 relative",children:[e.jsx(Ne,{className:"w-4 h-4"}),n().length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"})]})})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsx("span",{children:"Height/Weight"})]}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900 mt-1",children:[l.demographics.heightCm?`${l.demographics.heightCm} cm`:"N/A"," / "," ",l.demographics.weightKg?`${l.demographics.weightKg} kg`:"N/A"]}),l.demographics.heightCm&&l.demographics.weightKg&&e.jsxs("div",{className:"text-xs text-gray-500",children:["BSA: ",p(l.demographics.heightCm,l.demographics.weightKg)?.toFixed(2)," mÂ²"]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:"Active Medications"})]}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 mt-1",children:u().length})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(de,{className:"w-4 h-4"}),e.jsx("span",{children:"Allergies"})]}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 mt-1",children:(l.allergies||[]).length})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(_,{className:"w-4 h-4"}),e.jsx("span",{children:"Last Updated"})]}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 mt-1",children:new Date(l.lastUpdated).toLocaleDateString()})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:P.map(d=>{const C=d.icon;return e.jsxs("button",{onClick:()=>R(d.id),className:`group inline-flex items-center space-x-2 py-4 px-6 border-b-2 font-medium text-sm ${g===d.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(C,{className:"w-4 h-4"}),e.jsx("span",{children:d.label})]},d.id)})})}),e.jsxs("div",{className:"p-6",children:[g==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(ne,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Contact Information"})]}),e.jsxs("div",{className:"space-y-3",children:[l.demographics.contact?.phone&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ne,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:l.demographics.contact.phone})]}),l.demographics.contact?.email&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(fe,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:l.demographics.contact.email})]}),l.demographics.contact?.address&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ee,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:l.demographics.contact.address})]})]})]}),e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(we,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Vitals"}),e.jsx(k,{content:"Most recent vital signs and performance status",children:e.jsx(F,{className:"w-4 h-4 text-gray-400"})})]}),f()?e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[f().bloodPressureSystolic&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"BP:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[f().bloodPressureSystolic,"/",f().bloodPressureDiastolic]})]},"blood-pressure"),f().heartRate&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"HR:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[f().heartRate," bpm"]})]},"heart-rate"),f().temperature&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Temp:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[f().temperature,"Â°C"]})]},"temperature"),f().performanceStatus!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ECOG:"}),e.jsx("span",{className:"ml-1 font-medium",children:f().performanceStatus})]},"performance-status")]}):e.jsx("p",{className:"text-sm text-gray-500",children:"No recent vitals recorded"})]})]}),e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(de,{className:"w-5 h-5 text-red-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Allergies"}),e.jsx(k,{content:"Known drug and environmental allergies with severity levels",children:e.jsx(F,{className:"w-4 h-4 text-gray-400"})})]}),e.jsx("button",{className:"p-1 text-gray-400 hover:text-gray-600",children:e.jsx(Y,{className:"w-4 h-4"})})]}),(l.allergies||[]).length>0?e.jsx("div",{className:"space-y-2",children:(l.allergies||[]).map((d,C)=>e.jsxs("div",{className:`p-3 rounded-lg border-l-4 ${d.severity==="life-threatening"?"border-red-500 bg-red-50":d.severity==="severe"?"border-orange-500 bg-orange-50":d.severity==="moderate"?"border-yellow-500 bg-yellow-50":"border-gray-500 bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-900",children:d.allergen}),e.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["(",d.allergenType,")"]})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${d.severity==="life-threatening"?"bg-red-100 text-red-800":d.severity==="severe"?"bg-orange-100 text-orange-800":d.severity==="moderate"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:d.severity})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:d.reaction})]},d.id||`allergy-${C}`))}):e.jsx("p",{className:"text-sm text-gray-500",children:"No known allergies"})]}),e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(ie,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Lab Values"}),e.jsx(k,{content:"Most recent laboratory test results with reference ranges",children:e.jsx(F,{className:"w-4 h-4 text-gray-400"})})]}),c().length>0?e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Test"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Value"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Reference"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:c().map((d,C)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 text-sm font-medium text-gray-900",children:d.labType}),e.jsxs("td",{className:`px-3 py-2 text-sm ${d.isAbnormal?"text-red-600 font-medium":"text-gray-900"}`,children:[d.value," ",d.unit,d.criticalFlag&&e.jsx("span",{className:"ml-1 text-red-500",children:"â "})]}),e.jsx("td",{className:"px-3 py-2 text-sm text-gray-600",children:d.referenceRange}),e.jsx("td",{className:"px-3 py-2 text-sm text-gray-600",children:new Date(d.timestamp).toLocaleDateString()})]},`${d.labType}-${d.timestamp}-${C}`))})]})}):e.jsx("p",{className:"text-sm text-gray-500",children:"No recent lab values"})]}),e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[e.jsx(Be,{className:"w-5 h-5 text-purple-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"AI & Advanced Features"}),e.jsx(k,{content:"Access powerful AI and analytics tools for this patient",children:e.jsx(F,{className:"w-4 h-4 text-gray-400"})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"group bg-gradient-to-br from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4 hover:shadow-md transition-all cursor-pointer",onClick:()=>setTimeout(()=>j("/ai-decision-engine"),100),children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Se,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"AI Decision Engine"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Clinical decision support"})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Get AI-powered clinical recommendations and drug interaction analysis"}),e.jsxs("div",{className:"flex items-center text-blue-600 text-sm font-medium group-hover:text-blue-700",children:[e.jsx("span",{children:"Launch AI Analysis"}),e.jsx(B,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})]})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4 hover:shadow-md transition-all cursor-pointer",onClick:()=>setTimeout(()=>j("/safety-alerts"),100),children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(le,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Safety Alerts"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Real-time monitoring"})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Monitor drug safety alerts and potential adverse events"}),e.jsxs("div",{className:"flex items-center text-green-600 text-sm font-medium group-hover:text-green-700",children:[e.jsx("span",{children:"View Safety Dashboard"}),e.jsx(B,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})]})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-orange-50 to-red-50 border border-orange-200 rounded-lg p-4 hover:shadow-md transition-all cursor-pointer",onClick:()=>setTimeout(()=>j("/ml-analytics"),100),children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(H,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"ML Analytics"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Advanced insights"})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Access machine learning analytics and predictive models"}),e.jsxs("div",{className:"flex items-center text-orange-600 text-sm font-medium group-hover:text-orange-700",children:[e.jsx("span",{children:"Open Analytics"}),e.jsx(B,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})]})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-purple-50 to-pink-50 border border-purple-200 rounded-lg p-4 hover:shadow-md transition-all cursor-pointer",onClick:()=>setTimeout(()=>j("/predictive-outcomes"),100),children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(se,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Predictive Outcomes"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Treatment predictions"})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Generate AI-powered treatment outcome predictions"}),e.jsxs("div",{className:"flex items-center text-purple-600 text-sm font-medium group-hover:text-purple-700",children:[e.jsx("span",{children:"Generate Predictions"}),e.jsx(B,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})]})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-teal-50 to-cyan-50 border border-teal-200 rounded-lg p-4 hover:shadow-md transition-all cursor-pointer",onClick:()=>setTimeout(()=>j("/clinical-communication"),100),children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-teal-100 rounded-lg flex items-center justify-center",children:e.jsx(Ce,{className:"w-5 h-5 text-teal-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Team Communication"}),e.jsx("p",{className:"text-xs text-gray-600",children:"HIPAA-compliant messaging"})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Secure team communication and collaboration"}),e.jsxs("div",{className:"flex items-center text-teal-600 text-sm font-medium group-hover:text-teal-700",children:[e.jsx("span",{children:"Open Messenger"}),e.jsx(B,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})]})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-indigo-50 to-blue-50 border border-indigo-200 rounded-lg p-4 hover:shadow-md transition-all cursor-pointer",onClick:()=>setTimeout(()=>j("/iot-monitoring"),100),children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center",children:e.jsx(De,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"IoT Monitoring"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Connected devices"})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Monitor connected health devices and sensors"}),e.jsxs("div",{className:"flex items-center text-indigo-600 text-sm font-medium group-hover:text-indigo-700",children:[e.jsx("span",{children:"View Devices"}),e.jsx(B,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})]})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-red-50 to-pink-50 border border-red-200 rounded-lg p-4 hover:shadow-md transition-all cursor-pointer",onClick:()=>setTimeout(()=>j("/opioid-risk-report"),100),children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(ke,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Opioid Risk Report"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Addiction risk assessment"})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Comprehensive addiction risk and pharmacogenomic analysis"}),e.jsxs("div",{className:"flex items-center text-red-600 text-sm font-medium group-hover:text-red-700",children:[e.jsx("span",{children:"View Risk Assessment"}),e.jsx(B,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})]})]})]})]})]}),g==="medications"&&e.jsx(qe,{}),g==="genetics"&&e.jsx(Ve,{}),g==="history"&&e.jsx(_e,{}),g==="outcomes"&&e.jsx(Ye,{}),g==="export"&&e.jsx(Ke,{}),g==="labs"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx(ie,{className:"w-12 h-12 mx-auto"})}),e.jsx("p",{className:"text-lg font-medium text-gray-500",children:"Lab Management"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Coming soon in Phase 2"})]})]})]})]})},ws=()=>{const L=ge(),{state:T,dispatch:x}=E(),{currentPatient:l}=T,o=()=>{try{sessionStorage.setItem("oncosaferx:offline_banner_dismissed","1")}catch{}x({type:"DISMISS_OFFLINE_BANNER"})},h=()=>{l&&setTimeout(()=>L("/interactions?patient="+l.id),100)},y=()=>{l&&setTimeout(()=>L("/genomics?patient="+l.id),100)},j=()=>{l&&setTimeout(()=>L("/regimens?patient="+l.id),100)};return e.jsxs("div",{className:"space-y-6",children:[T.lastSaveOffline&&T.showOfflineBanner&&e.jsx("div",{className:"rounded-md border border-yellow-200 bg-yellow-50 p-3 text-sm text-yellow-800",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Saved locally â not persisted"}),e.jsx("div",{children:T.offlineNote||"The server is not configured for persistence. Data was saved locally only."})]}),e.jsxs("div",{className:"text-xs flex items-center gap-3",children:[e.jsx(me,{to:"/auth-diagnostics",className:"text-blue-700 hover:underline",children:"Auth Diagnostics"}),e.jsx("button",{onClick:o,className:"px-2 py-1 border rounded bg-white text-yellow-800 hover:bg-yellow-100",children:"Dismiss"})]})]})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[e.jsx(xe,{className:"w-8 h-8 text-primary-600"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Patient Management"}),e.jsx(k,{content:"Comprehensive patient profile management with clinical data, medication history, and safety alerts",children:e.jsx(F,{className:"w-5 h-5 text-gray-400"})})]}),e.jsx("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto",children:"Search for existing patients or create new patient profiles to access comprehensive clinical information and decision support tools."}),e.jsx("div",{className:"mt-3",children:e.jsx(me,{to:"/patients/all",className:"text-sm text-blue-600 hover:underline",children:"View all patients"})})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(Ue,{})}),e.jsx("div",{className:"lg:col-span-2",children:l?e.jsx(Qe,{}):e.jsx(v,{className:"h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(xe,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-500 mb-2",children:"No Patient Selected"}),e.jsx("p",{className:"text-gray-400 max-w-md mx-auto",children:"Search for an existing patient or create a new patient profile to begin accessing clinical information and decision support tools."})]})})})]}),l&&e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Quick Actions"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Common clinical workflows for this patient"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:h,className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700",children:"Check Interactions"}),e.jsx("button",{onClick:y,className:"px-4 py-2 bg-purple-600 text-white text-sm font-medium rounded-md hover:bg-purple-700",children:"Genomic Analysis"}),e.jsx("button",{onClick:j,className:"px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700",children:"Plan Regimen"})]})]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Patient Safety Features"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Allergy Checking"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Automatic cross-referencing of patient allergies with drug selections to prevent adverse reactions and ensure safe prescribing practices."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Clinical Alerts"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Real-time alerts for drug interactions, contraindications, dosing concerns, and monitoring requirements based on patient-specific factors."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Genomic Integration"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Integration of pharmacogenomic data to personalize drug selection and dosing based on individual genetic variants and metabolizer status."})]})]})]})})]})};export{ws as default};
//# sourceMappingURL=Patients-C2Rul6nh.js.map
