import{c as nt,u as Te,f as Ge,j as e,P as ye,e as ee,T as De,C as it,A as be,D as lt,r,d as Ee,h as qe,_ as ct,i as Ue,b as ge,a as He,k as Ke,l as Pe,X as Be,S as ie,B as pe,Z as Ie,U as Ve,H as Me,m as Je,I as ot}from"./index-4Ly-s4cr.js";import{d as ze}from"./api-BfpE7lHs.js";import{C as $}from"./Card-DLOVFYwQ.js";import{analytics as we}from"./analytics-DcoOYTyl.js";import{i as dt}from"./biomarkers-Bb0NK789.js";import{S as ae}from"./star-2cVrOGT9.js";import{T as mt}from"./tag-COrFYHX4.js";import{M as ut}from"./map-pinned-CcKcCQ3T.js";import{S as We}from"./share-2-CBlfQzTs.js";import{A as Le}from"./Alert-D2KfDB-X.js";import{D as he}from"./database-CjiuAixY.js";import{G as Oe}from"./globe-DjaafeDq.js";import{F as Re}from"./funnel-Di7XuIws.js";import{G as xt,L as pt}from"./list-rHB2U6Hb.js";import{D as Xe}from"./download-CEa9LHc5.js";import{C as ke}from"./circle-check-big-DzqNVPmE.js";import{D as ht}from"./dollar-sign-Cb6UT82z.js";import{B as Fe}from"./bookmark-BoSGn08p.js";import{P as gt}from"./plus-7LXijMKD.js";import{E as ft}from"./eye-BNehSfOP.js";import{C as yt}from"./check-pB4liXIF.js";import{S as Ze}from"./sparkles-Dy33uKqh.js";import{M as Qe}from"./microscope-DmJYfpH_.js";import{F as bt}from"./FeatureErrorBoundary-t7nlP-3W.js";import{H as vt}from"./history-C_Hr60kb.js";import"./circle-x-DA35Ia3u.js";import"./refresh-cw-Da3gWcAr.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Nt=nt("loader-circle",jt),_e="oncosaferx_pins";function fe(){try{const t=localStorage.getItem(_e);return t?JSON.parse(t):{}}catch{return{}}}function wt(t){return t?!!fe()[t]:!1}function Se(t,i){const c=fe();c[t]?delete c[t]:c[t]={name:i,t:Date.now()};try{localStorage.setItem(_e,JSON.stringify(c))}catch{}return c}function St(){try{localStorage.removeItem(_e)}catch{}}function Ct(t){const i=fe(),c={};let s=Date.now();for(const d of t){const b=i[d];b&&(c[d]={name:b.name,t:s--})}Object.entries(i).forEach(([d,b])=>{c[d]||(c[d]=b)});try{localStorage.setItem(_e,JSON.stringify(c))}catch{}}const Ce=({drug:t,onClick:i,showDetails:c=!1,showTooltips:s=!0,className:d=""})=>{const b=Te(),k=Ge(),f=()=>{i?.(t)},x=n=>{if(!n)return"bg-gray-100 text-gray-700";switch(n.toLowerCase()){case"scd":case"sbd":return"bg-primary-100 text-primary-700";case"gpck":case"bpck":return"bg-warning-100 text-warning-700";default:return"bg-gray-100 text-gray-700"}},A=n=>n?{SCD:"Clinical Drug",SBD:"Branded Drug",GPCK:"Generic Pack",BPCK:"Branded Pack"}[n.toUpperCase()]||n:"Unknown",j=()=>e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsx("div",{className:"font-semibold",children:"Drug Information:"}),e.jsxs("div",{children:["Name: ",t.name]}),e.jsxs("div",{children:["RXCUI: ",t.rxcui]}),t.tty&&e.jsxs("div",{children:["Type: ",A(t.tty)]}),t.generic_name&&e.jsxs("div",{children:["Generic: ",t.generic_name]}),t.therapeutic_class&&e.jsxs("div",{children:["Class: ",t.therapeutic_class]}),e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-200",children:e.jsx("div",{className:"text-gray-300",children:i?"Click for more details":"Drug details"})})]}),C=n=>{const m={SCD:"Semantic Clinical Drug - A clinical drug with specific ingredient(s), strength(s), and dose form",SBD:"Semantic Branded Drug - A branded drug with specific ingredient(s), strength(s), and dose form",GPCK:"Generic Pack - A collection of generic drugs in a package",BPCK:"Branded Pack - A collection of branded drugs in a package"};return n?m[n.toUpperCase()]||`${n} - Drug type classification`:"Drug type classification from RxNorm terminology"},D=()=>e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsx("div",{className:"font-semibold text-amber-200",children:"Clinical Safety:"}),e.jsxs("ul",{className:"space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Always verify drug name and strength"}),e.jsx("li",{children:"Check for patient allergies"}),e.jsx("li",{children:"Review contraindications"}),e.jsx("li",{children:"Consider drug interactions"})]}),e.jsx("div",{className:"mt-2 pt-2 border-t border-amber-200",children:e.jsx("div",{className:"text-amber-200",children:"Consult clinical guidelines and patient-specific factors"})})]}),N=wt(t.rxcui);return e.jsxs($,{className:`transition-all duration-200 ${i?"cursor-pointer hover:shadow-md hover:border-primary-300":""} ${d}`,padding:"md",children:[e.jsxs("div",{className:"flex items-start justify-between",onClick:i?f:void 0,children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center",children:e.jsx(ye,{className:"w-5 h-5 text-primary-600"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:t.name}),N&&e.jsx(ee,{content:"Pinned",children:e.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-[10px] font-medium bg-yellow-100 text-yellow-800 border border-yellow-200",children:[e.jsx(ae,{className:"w-3 h-3 mr-1"})," Pinned"]})}),s&&e.jsx(ee,{content:j(),type:"info",iconOnly:!0,position:"top",maxWidth:"max-w-xs"})]}),t.synonym&&t.synonym!==t.name&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Also known as: ",t.synonym]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(mt,{className:"w-3 h-3 text-gray-400"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["RXCUI: ",t.rxcui]}),s&&e.jsx(ee,{content:"RxNorm Concept Unique Identifier - A unique identifier for this medication in the RxNorm database",type:"help",iconOnly:!0,position:"top",maxWidth:"max-w-xs"})]}),t.tty&&e.jsx(ee,{content:C(t.tty),type:"help",disabled:!s,maxWidth:"max-w-sm",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${x(t.tty)}`,children:A(t.tty)})}),s&&e.jsx(ee,{content:D(),type:"warning",iconOnly:!0,position:"top",maxWidth:"max-w-xs",children:e.jsx(De,{className:"w-4 h-4 text-amber-500"})})]}),c&&e.jsxs("div",{className:"mt-3 space-y-2",children:[t.generic_name&&t.generic_name!==t.name&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Generic: "}),e.jsx("span",{className:"text-sm text-gray-600",children:t.generic_name})]}),t.therapeutic_class&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Class: "}),e.jsx("span",{className:"text-sm text-gray-600",children:t.therapeutic_class})]}),t.indication&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Indication: "}),e.jsx("span",{className:"text-sm text-gray-600",children:t.indication})]}),t.brand_names&&t.brand_names.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Brand Names: "}),e.jsx("span",{className:"text-sm text-gray-600",children:t.brand_names.join(", ")})]})]})]})]}),i&&e.jsx("div",{className:"flex-shrink-0 ml-4",children:e.jsx(it,{className:"w-5 h-5 text-gray-400"})})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.jsx(ee,{content:N?"Unpin this drug":"Pin this drug",children:e.jsxs("button",{type:"button",onClick:()=>{Se(t.rxcui,t.name)},className:`inline-flex items-center px-3 py-1.5 text-xs rounded ${N?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-700"} hover:bg-gray-200`,"aria-pressed":N,"aria-label":N?"Unpin drug":"Pin drug",children:[e.jsx(ae,{className:`w-3 h-3 mr-1 ${N?"":"opacity-70"}`})," ",N?"Pinned":"Pin"]})}),e.jsxs("button",{type:"button",onClick:()=>{k.addDrug(t);try{we.logSelection(t.rxcui,t.name,"card_action_interactions")}catch{}setTimeout(()=>b("/interactions"),100)},className:"inline-flex items-center px-3 py-1.5 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:[e.jsx(be,{className:"w-3 h-3 mr-1"})," Use in Interactions"]}),e.jsxs("button",{type:"button",onClick:()=>{k.addDrug(t);try{we.logSelection(t.rxcui,t.name,"card_action_genomics")}catch{}setTimeout(()=>b("/genomics"),100)},className:"inline-flex items-center px-3 py-1.5 text-xs bg-purple-100 text-purple-700 rounded hover:bg-purple-200",children:[e.jsx(lt,{className:"w-3 h-3 mr-1"})," Analyze Genomics"]}),e.jsxs("button",{type:"button",onClick:()=>{k.addDrug(t);const n=dt(t.name);try{we.logSelection(t.rxcui,t.name,"card_action_trials")}catch{}setTimeout(()=>{b(n?`/trials?biomarker=${encodeURIComponent(n)}`:"/trials")},100)},className:"inline-flex items-center px-3 py-1.5 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200",children:[e.jsx(ut,{className:"w-3 h-3 mr-1"})," Find Trials"]}),i&&e.jsxs("button",{type:"button",onClick:f,onMouseDown:()=>{try{we.logSelection(t.rxcui,t.name,"card_action_details")}catch{}},className:"inline-flex items-center px-3 py-1.5 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:[e.jsx(We,{className:"w-3 h-3 mr-1"})," View Details"]})]})]})};function kt(t,i){const c=(i||"").toLowerCase(),s=(t.name||"").toLowerCase();if(!c)return 0;if(s===c)return 100;if(s.startsWith(c))return 80;if(s.includes(c))return 60;const d=At(s,c);return Math.floor(d*40)}function At(t,i){const c=t.length>i.length?t:i,s=t.length>i.length?i:t;if(c.length===0)return 1;const d=Tt(c,s);return(c.length-d)/c.length}function Tt(t,i){const c=Array(i.length+1).fill(null).map(()=>Array(t.length+1).fill(null));for(let s=0;s<=t.length;s++)c[0][s]=s;for(let s=0;s<=i.length;s++)c[s][0]=s;for(let s=1;s<=i.length;s++)for(let d=1;d<=t.length;d++){const b=t[d-1]===i[s-1]?0:1;c[s][d]=Math.min(c[s][d-1]+1,c[s-1][d]+1,c[s-1][d-1]+b)}return c[i.length][t.length]}const Dt=({results:t,loading:i,error:c,onDrugSelect:s,filters:d})=>{let b={};try{b=JSON.parse(localStorage.getItem("oncosaferx_popularity")||"{}")}catch{}const k=r.useMemo(()=>{if(!t||!t.results.length)return null;const n={"Brand Names":[],"Generic Names":[],Ingredients:[],Combinations:[],Other:[]},m=["aspirin","ibuprofen","acetaminophen","warfarin","metformin","atorvastatin"],O=["pembrolizumab","nivolumab","fluorouracil","cisplatin","doxorubicin","paclitaxel"];return t.results.filter(h=>{const _=!d?.tty||d.tty.size===0||(h.tty?d.tty.has(h.tty):!1),P=["pembrolizumab","nivolumab","fluorouracil","cisplatin","doxorubicin","paclitaxel","tamoxifen","imatinib"].some(T=>(h.name||"").toLowerCase().includes(T)),B=!d?.onlyOncology||P;return _&&B}).forEach(h=>{const _=m.some(B=>h.name.toLowerCase().includes(B.toLowerCase())),v=O.some(B=>h.name.toLowerCase().includes(B.toLowerCase())),P={...h,isPopular:_,isOncology:v,relevanceScore:kt(h,t.query||""),popularityScore:Number(b[h.rxcui]||0)};switch(h.tty){case"BN":n["Brand Names"].push(P);break;case"IN":case"PIN":n.Ingredients.push(P);break;case"MIN":n.Combinations.push(P);break;case"SCD":case"SBD":n["Generic Names"].push(P);break;default:n.Other.push(P);break}}),Object.keys(n).forEach(h=>{n[h].sort((_,v)=>_.isPopular&&!v.isPopular?-1:!_.isPopular&&v.isPopular?1:_.isOncology&&!v.isOncology?-1:!_.isOncology&&v.isOncology?1:_.popularityScore!==v.popularityScore?v.popularityScore-_.popularityScore:v.relevanceScore-_.relevanceScore)}),n},[t]),f=r.useMemo(()=>fe(),[t]),x=r.useMemo(()=>!t||!t.results.length?[]:k?Object.values(k).flat():t.results,[t,k]),[A,j]=r.useState(-1),C=r.useRef(null);r.useEffect(()=>{j(-1)},[t,d]);const D=n=>{x.length!==0&&j(m=>m<0?n>0?0:x.length-1:(m+n+x.length)%x.length)},N=n=>{if(n.key==="ArrowDown"||n.key.toLowerCase()==="j")n.preventDefault(),D(1);else if(n.key==="ArrowUp"||n.key.toLowerCase()==="k")n.preventDefault(),D(-1);else if(n.key==="Enter"&&A>=0&&x[A]){n.preventDefault();const m=x[A];s?.(m);try{const{rxcui:O,name:M}=m;(async()=>(await ct(async()=>{const{analytics:h}=await import("./analytics-DcoOYTyl.js");return{analytics:h}},[])).analytics.logSelection(O,M,"search_results"))()}catch{}}else if(n.key.toLowerCase()==="p"&&A>=0&&x[A]){n.preventDefault();const m=x[A];try{togglePin(m.rxcui,m.name),setPinTick(O=>O+1)}catch{}}};return i?e.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((n,m)=>e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-lg"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]})]})})},m))}):c?e.jsx(Le,{type:"error",title:"Search Error",children:c}):t?t.count===0?e.jsxs(Le,{type:"info",title:"No Results Found",children:['No drugs found matching your search query "',t.query,'". Please try a different search term.']}):e.jsxs("div",{className:"space-y-6 outline-none",tabIndex:0,onKeyDown:N,ref:C,role:"listbox","aria-label":"Drug search results","aria-activedescendant":A>=0&&x[A]?`drug-option-${x[A].rxcui}`:void 0,children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[e.jsx(Ee,{className:"w-5 h-5 text-blue-600"}),e.jsxs("span",{children:['Search Results for "',t.query,'"']})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Found ",t.count," drug",t.count!==1?"s":""," • Ranked by relevance and popularity"]})]}),t.sources&&e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsx(ee,{content:"Results from local OncoSafeRx database",children:e.jsxs("div",{className:"flex items-center space-x-1 cursor-help",children:[e.jsx(he,{className:"w-4 h-4"}),e.jsxs("span",{children:["Local: ",t.sources.local]})]})}),e.jsx(ee,{content:"Results from RxNorm (National Library of Medicine) database",children:e.jsxs("div",{className:"flex items-center space-x-1 cursor-help",children:[e.jsx(Oe,{className:"w-4 h-4"}),e.jsxs("span",{children:["RxNorm: ",t.sources.rxnorm]})]})})]})]}),k&&e.jsx("div",{className:"flex flex-wrap gap-3 pt-3 border-t border-gray-100",children:Object.entries(k).map(([n,m])=>{if(m.length===0)return null;const O=h=>{switch(h){case"Brand Names":return e.jsx(ae,{className:"w-3 h-3"});case"Generic Names":return e.jsx(ye,{className:"w-3 h-3"});case"Ingredients":return e.jsx(Re,{className:"w-3 h-3"});case"Combinations":return e.jsx(he,{className:"w-3 h-3"});default:return e.jsx(Oe,{className:"w-3 h-3"})}},M=h=>{switch(h){case"Brand Names":return"Proprietary/commercial drug names (e.g., Tylenol, Advil)";case"Generic Names":return"Scientific/chemical drug names (e.g., acetaminophen, ibuprofen)";case"Ingredients":return"Active pharmaceutical ingredients and components";case"Combinations":return"Multi-ingredient formulations and combination products";default:return"Other drug terminology types"}};return e.jsx(ee,{content:M(n),children:e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-gray-100 rounded-full text-xs text-gray-600 cursor-help",children:[O(n),e.jsxs("span",{children:[n,": ",m.length]})]})},n)})})]}),Object.keys(f).length>0&&t&&t.results.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"inline-flex items-center space-x-2 px-3 py-2 rounded-lg border text-yellow-700 bg-yellow-50 border-yellow-200",children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsx("h4",{className:"font-medium",children:"Pinned"}),e.jsxs("span",{className:"text-sm",children:["(",Object.keys(f).filter(n=>t.results.find(m=>m.rxcui===n)).length,")"]})]}),e.jsx("div",{className:"space-y-3",children:t.results.filter(n=>!!f[n.rxcui]).map(n=>e.jsx("div",{className:"relative",children:e.jsx(Ce,{drug:n,onClick:s,className:"ring-2 ring-yellow-200"})},`${n.rxcui}-${n.tty}`))})]}),k?e.jsx("div",{className:"space-y-6",children:Object.entries(k).map(([n,m])=>{if(m.length===0)return null;const O=h=>{switch(h){case"Brand Names":return"text-purple-600 bg-purple-50 border-purple-200";case"Generic Names":return"text-blue-600 bg-blue-50 border-blue-200";case"Ingredients":return"text-green-600 bg-green-50 border-green-200";case"Combinations":return"text-orange-600 bg-orange-50 border-orange-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},M=h=>{switch(h){case"Brand Names":return e.jsx(ae,{className:"w-4 h-4"});case"Generic Names":return e.jsx(ye,{className:"w-4 h-4"});case"Ingredients":return e.jsx(Re,{className:"w-4 h-4"});case"Combinations":return e.jsx(he,{className:"w-4 h-4"});default:return e.jsx(Oe,{className:"w-4 h-4"})}};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`inline-flex items-center space-x-2 px-3 py-2 rounded-lg border ${O(n)}`,children:[M(n),e.jsx("h4",{className:"font-medium",children:n}),e.jsxs("span",{className:"text-sm",children:["(",m.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:m.map(h=>e.jsxs("div",{id:`drug-option-${h.rxcui}`,className:"relative",role:"option","aria-selected":A>=0&&x[A]?.rxcui===h.rxcui,children:[e.jsx(ee,{content:f[h.rxcui]?"Unpin this drug":"Pin this drug",children:e.jsx("button",{type:"button",onClick:_=>{_.stopPropagation(),togglePin(h.rxcui,h.name),setPinTick(v=>v+1)},className:`absolute top-2 left-2 z-10 inline-flex items-center justify-center w-6 h-6 rounded-full border ${f[h.rxcui]?"bg-yellow-100 border-yellow-300 text-yellow-800":"bg-white border-gray-200 text-gray-500"} hover:bg-yellow-50`,"aria-label":f[h.rxcui]?"Unpin":"Pin",children:e.jsx(ae,{className:"w-3 h-3"})})}),e.jsx(Ce,{drug:h,onClick:s,className:`${h.isPopular?"ring-2 ring-yellow-200":""} ${h.isOncology?"ring-2 ring-purple-200":""} ${A>=0&&x[A]?.rxcui===h.rxcui?"ring-2 ring-blue-300":""}`}),e.jsxs("div",{className:"absolute top-2 right-2 flex items-center space-x-1",children:[h.isPopular&&e.jsx(ee,{content:"Commonly prescribed medication with high usage frequency",children:e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium cursor-help",children:[e.jsx(Ee,{className:"w-3 h-3"}),e.jsx("span",{children:"Popular"})]})}),h.isOncology&&e.jsx(ee,{content:"Oncology/cancer treatment medication - requires specialized handling and monitoring",children:e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs font-medium cursor-help",children:[e.jsx(ae,{className:"w-3 h-3"}),e.jsx("span",{children:"Oncology"})]})}),h.relevanceScore>=80&&e.jsx(ee,{content:"High relevance match based on search query similarity",children:e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium cursor-help",children:[e.jsx(qe,{className:"w-3 h-3"}),e.jsxs("span",{children:[h.relevanceScore,"% match"]})]})})]})]},`${h.rxcui}-${h.tty}`))})]},n)})}):e.jsx("div",{className:"space-y-4",children:t.results.map(n=>e.jsxs("div",{className:"relative",children:[e.jsx(ee,{content:f[n.rxcui]?"Unpin this drug":"Pin this drug",children:e.jsx("button",{type:"button",onClick:m=>{m.stopPropagation(),togglePin(n.rxcui,n.name),setPinTick(O=>O+1)},className:`absolute top-2 left-2 z-10 inline-flex items-center justify-center w-6 h-6 rounded-full border ${f[n.rxcui]?"bg-yellow-100 border-yellow-300 text-yellow-800":"bg-white border-gray-200 text-gray-500"} hover:bg-yellow-50`,"aria-label":f[n.rxcui]?"Unpin":"Pin",children:e.jsx(ae,{className:"w-3 h-3"})})}),e.jsx(Ce,{drug:n,onClick:s,className:f[n.rxcui]?"ring-2 ring-yellow-200":""})]},`${n.rxcui}-${n.tty}`))}),t.count>t.results.length&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"px-6 py-2 bg-primary-600 text-white text-sm font-medium rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 flex items-center space-x-2 mx-auto",children:[e.jsx(he,{className:"w-4 h-4"}),e.jsxs("span",{children:["Load More Results (",t.count-t.results.length," remaining)"]})]})})]}):e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"text-gray-500",children:[e.jsx(he,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium",children:"Search for drugs"}),e.jsx("p",{className:"text-sm",children:"Enter a drug name to search our database and external sources"})]})})},Ot=({drugs:t,loading:i,error:c,onDrugSelect:s,onCompare:d,viewMode:b="grid",sortBy:k="relevance",filterBy:f={},onPin:x,onAddToInteractions:A})=>{const[j,C]=r.useState([]),[D,N]=r.useState(b),[n,m]=r.useState(k),[O,M]=r.useState(!1),[h,_]=r.useState([]),v=l=>{C(u=>u.includes(l)?u.filter(y=>y!==l):[...u,l])},P=l=>{_(u=>u.includes(l)?u.filter(y=>y!==l):[...u,l])},B=r.useMemo(()=>{let l=[...t];switch(f.fdaApproved!==void 0&&(l=l.filter(u=>u.fdaApproved===f.fdaApproved)),f.isOncologyDrug!==void 0&&(l=l.filter(u=>u.isOncologyDrug===f.isOncologyDrug)),f.therapeuticClass&&(l=l.filter(u=>u.therapeuticClass===f.therapeuticClass)),f.evidenceLevel&&(l=l.filter(u=>u.evidenceLevel===f.evidenceLevel)),n){case"name":l.sort((u,y)=>u.name.localeCompare(y.name));break;case"safety":l.sort((u,y)=>y.safetyScore-u.safetyScore);break;case"efficacy":l.sort((u,y)=>y.efficacyScore-u.efficacyScore);break;case"approval_date":l.sort((u,y)=>u.approvalDate?y.approvalDate?new Date(y.approvalDate).getTime()-new Date(u.approvalDate).getTime():-1:1);break;case"clinical_trials":l.sort((u,y)=>y.clinicalTrials-u.clinicalTrials);break}return l},[t,f,n]),T=l=>{const u={high:"bg-green-100 text-green-800",moderate:"bg-yellow-100 text-yellow-800",low:"bg-red-100 text-red-800"};return u[l]||u.moderate},F=l=>{const u={low:"bg-green-100 text-green-800",moderate:"bg-yellow-100 text-yellow-800",high:"bg-orange-100 text-orange-800",specialty:"bg-purple-100 text-purple-800"};return u[l]||u.moderate},se=l=>{try{const u="osrx_pinned_drugs",y=JSON.parse(localStorage.getItem(u)||"[]");y.find(q=>q.id===l.id)||(y.unshift({id:l.id,name:l.name}),localStorage.setItem(u,JSON.stringify(y.slice(0,20))))}catch{}},G=l=>{try{const u="osrx_interaction_basket",y=JSON.parse(localStorage.getItem(u)||"[]");y.find(q=>q.id===l.id)||(y.push({id:l.id,name:l.name}),localStorage.setItem(u,JSON.stringify(y.slice(-10))))}catch{}},Z=(l,u=!1)=>e.jsxs($,{className:`transition-all duration-200 hover:shadow-lg ${j.includes(l.id)?"ring-2 ring-violet-500":""}`,children:[e.jsx(CardHeader,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("input",{type:"checkbox",checked:j.includes(l.id),onChange:()=>v(l.id),className:"rounded border-gray-300 text-violet-600 focus:ring-violet-500"}),e.jsx(CardTitle,{className:"text-lg font-semibold text-gray-900",children:l.name}),l.blackBoxWarning&&e.jsxs(Badge,{className:"bg-red-100 text-red-800",children:[e.jsx(De,{className:"h-3 w-3 mr-1"}),"Black Box"]})]}),l.genericName&&l.genericName!==l.name&&e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Generic: ",l.genericName]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx(Badge,{variant:"outline",className:"text-xs",children:l.therapeuticClass}),e.jsxs(Badge,{className:T(l.evidenceLevel),children:[l.evidenceLevel," evidence"]}),l.fdaApproved&&e.jsxs(Badge,{className:"bg-blue-100 text-blue-800",children:[e.jsx(ke,{className:"h-3 w-3 mr-1"}),"FDA Approved"]}),l.isOncologyDrug&&e.jsxs(Badge,{className:"bg-purple-100 text-purple-800",children:[e.jsx(ge,{className:"h-3 w-3 mr-1"}),"Oncology"]})]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ae,{className:"h-4 w-4 text-yellow-500"}),e.jsxs("span",{className:"text-sm font-medium",children:[l.efficacyScore,"/100"]})]}),e.jsxs(Badge,{className:F(l.costTier),children:[e.jsx(ht,{className:"h-3 w-3 mr-1"}),l.costTier]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{title:"Pin",onClick:()=>x?x(l):se(l),className:"text-gray-500 hover:text-violet-700",children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx("button",{title:"Add to interactions",onClick:()=>A?A(l):G(l),className:"text-gray-500 hover:text-violet-700",children:e.jsx(gt,{className:"h-4 w-4"})})]})]})]})}),e.jsxs(CardContent,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Mechanism & Indications"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:l.mechanismOfAction}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[l.indication.slice(0,3).map((y,q)=>e.jsx(Badge,{variant:"outline",className:"text-xs",children:y},q)),l.indication.length>3&&e.jsxs(Badge,{variant:"outline",className:"text-xs",children:["+",l.indication.length-3," more"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-1 mb-1",children:[e.jsx(He,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Safety"})]}),e.jsxs("div",{className:"text-lg font-bold text-green-800",children:[l.safetyScore,"/100"]})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-1 mb-1",children:[e.jsx(Ee,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Efficacy"})]}),e.jsxs("div",{className:"text-lg font-bold text-blue-800",children:[l.efficacyScore,"/100"]})]})]}),l.biomarkers&&l.biomarkers.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2 flex items-center space-x-1",children:[e.jsx(be,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{children:"Biomarker Targets"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:l.biomarkers.map((y,q)=>e.jsx(Badge,{className:"bg-purple-100 text-purple-800 text-xs",children:y},q))})]}),u&&e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium text-green-800 mb-2 flex items-center space-x-1",children:[e.jsx(ke,{className:"h-4 w-4"}),e.jsx("span",{children:"Key Benefits"})]}),e.jsx("ul",{className:"text-xs text-gray-600 space-y-1",children:l.keyBenefits.slice(0,3).map((y,q)=>e.jsxs("li",{children:["• ",y]},q))})]}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium text-red-800 mb-2 flex items-center space-x-1",children:[e.jsx(De,{className:"h-4 w-4"}),e.jsx("span",{children:"Key Risks"})]}),e.jsx("ul",{className:"text-xs text-gray-600 space-y-1",children:l.keyRisks.slice(0,3).map((y,q)=>e.jsxs("li",{children:["• ",y]},q))})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",children:l.clinicalTrials}),e.jsx("div",{className:"text-xs text-gray-600",children:"Clinical Trials"})]}),e.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",children:l.publications}),e.jsx("div",{className:"text-xs text-gray-600",children:"Publications"})]}),e.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",children:l.approvalDate?new Date(l.approvalDate).getFullYear():"N/A"}),e.jsx("div",{className:"text-xs text-gray-600",children:"FDA Approval"})]})]}),l.monitoringRequirements.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium text-orange-800 mb-2 flex items-center space-x-1",children:[e.jsx(qe,{className:"h-4 w-4"}),e.jsx("span",{children:"Monitoring Required"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:l.monitoringRequirements.slice(0,3).map((y,q)=>e.jsx(Badge,{variant:"outline",className:"text-xs",children:y},q))})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(Button,{variant:"outline",size:"sm",onClick:()=>P(l.id),children:[u?e.jsx(Ke,{className:"h-4 w-4"}):e.jsx(Pe,{className:"h-4 w-4"}),u?"Less":"More"]}),e.jsxs(Button,{variant:"outline",size:"sm",onClick:()=>s(l),children:[e.jsx(ft,{className:"h-4 w-4 mr-1"}),"View Details"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Button,{variant:"ghost",size:"sm",children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx(Button,{variant:"ghost",size:"sm",children:e.jsx(We,{className:"h-4 w-4"})})]})]})]})]},l.id);return i?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-violet-600"})}):c?e.jsx($,{className:"border-red-200",children:e.jsx(CardContent,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-2 text-red-600",children:[e.jsx(De,{className:"h-5 w-5"}),e.jsx("span",{children:c})]})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Search Results"}),e.jsxs("p",{className:"text-gray-600",children:["Found ",B.length," drug",B.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(Select,{value:n,onValueChange:m,children:[e.jsx(SelectTrigger,{className:"w-48",children:e.jsx(SelectValue,{placeholder:"Sort by..."})}),e.jsxs(SelectContent,{children:[e.jsx(SelectItem,{value:"relevance",children:"Relevance"}),e.jsx(SelectItem,{value:"name",children:"Name (A-Z)"}),e.jsx(SelectItem,{value:"safety",children:"Safety Score"}),e.jsx(SelectItem,{value:"efficacy",children:"Efficacy Score"}),e.jsx(SelectItem,{value:"approval_date",children:"Approval Date"}),e.jsx(SelectItem,{value:"clinical_trials",children:"Clinical Trials"})]})]}),e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[e.jsx(Button,{variant:D==="grid"?"default":"ghost",size:"sm",onClick:()=>N("grid"),children:e.jsx(xt,{className:"h-4 w-4"})}),e.jsx(Button,{variant:D==="list"?"default":"ghost",size:"sm",onClick:()=>N("list"),children:e.jsx(pt,{className:"h-4 w-4"})})]})]})]}),j.length>0&&e.jsx($,{className:"border-violet-200 bg-violet-50",children:e.jsx(CardContent,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium text-violet-800",children:[j.length," drug",j.length!==1?"s":""," selected"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(Button,{variant:"outline",size:"sm",onClick:()=>d?.(t.filter(l=>j.includes(l.id))),disabled:j.length<2,children:[e.jsx(Ue,{className:"h-4 w-4 mr-1"}),"Compare"]}),e.jsxs(Button,{variant:"outline",size:"sm",children:[e.jsx(Xe,{className:"h-4 w-4 mr-1"}),"Export"]}),e.jsx(Button,{variant:"outline",size:"sm",onClick:()=>C([]),children:"Clear Selection"})]})]})})}),e.jsx("div",{className:D==="grid"?"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6":"space-y-4",children:B.map(l=>Z(l,h.includes(l.id)))}),B.length===0&&e.jsx($,{className:"border-gray-200",children:e.jsxs(CardContent,{className:"p-12 text-center",children:[e.jsx(ye,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No drugs found"}),e.jsx("p",{className:"text-gray-600",children:"Try adjusting your search criteria or filters to find more results."})]})})]})},It=[{name:"aspirin",type:"drug"},{name:"acetaminophen",type:"drug"},{name:"ibuprofen",type:"drug"},{name:"clopidogrel",type:"drug"},{name:"warfarin",type:"drug"},{name:"omeprazole",type:"drug"},{name:"simvastatin",type:"drug"},{name:"levodopa",type:"drug"}];function Rt({placeholder:t,value:i,onChange:c,onSelect:s,maxResults:d=12,onOfflineChange:b,onAutoResolve:k}){const[f,x]=r.useState(!1),[A,j]=r.useState(!1),[C,D]=r.useState(!1),[N,n]=r.useState([]),[m,O]=r.useState(-1),M=r.useRef(null),h=r.useRef(null),_=r.useRef("");r.useEffect(()=>{const T=F=>{M.current&&(M.current.contains(F.target)||x(!1))};return document.addEventListener("mousedown",T),()=>document.removeEventListener("mousedown",T)},[]),r.useEffect(()=>{let T=!1;const F=i.trim();if(F.length<2){n([]),D(!1),b?.(!1);return}j(!0);const se=setTimeout(async()=>{try{const G=await fetch(`/api/drugs/suggestions?q=${encodeURIComponent(F)}&limit=${d}`);if(!G.ok)throw new Error("HTTP "+G.status);const Z=await G.json();if(T)return;const l=(Z.suggestions||[]).map(q=>({rxcui:q.rxcui,name:q.name,type:"drug"}));n(l),D(!!Z.offline),b?.(!!Z.offline);const u=F.toLowerCase(),y=l.find(q=>q.name.toLowerCase()===u);if(y&&_.current!==u&&(_.current=u,k?.({rxcui:y.rxcui||null,name:y.name})),!y&&l.length===1){const q=l[0];q.name.toLowerCase().startsWith(u)&&_.current!==u&&(_.current=u,k?.({rxcui:q.rxcui||null,name:q.name}))}}catch{if(!T){const G=F.toLowerCase(),Z=It.filter(u=>u.name.includes(G)).slice(0,d);n(Z),D(!0),b?.(!0);const l=Z.find(u=>u.name.toLowerCase()===G);l&&_.current!==G&&(_.current=G,k?.({rxcui:l.rxcui||null,name:l.name}))}}finally{T||j(!1)}},200);return()=>{T=!0,clearTimeout(se)}},[i,d,b]);const v=T=>{f&&(T.key==="ArrowDown"?(T.preventDefault(),O(F=>Math.min(F+1,N.length-1))):T.key==="ArrowUp"?(T.preventDefault(),O(F=>Math.max(F-1,0))):T.key==="Enter"?(T.preventDefault(),m>=0&&N[m]?P(N[m]):N.length===1&&P(N[0])):T.key==="Escape"&&(x(!1),O(-1)))},P=T=>{c(T.name),s({rxcui:T.rxcui||null,name:T.name}),x(!1),O(-1),h.current?.blur()},B=r.useMemo(()=>N.slice(0,d),[N,d]);return e.jsxs("div",{ref:M,className:"relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:h,type:"text",value:i,onChange:T=>{c(T.target.value),x(!0)},onFocus:()=>x(!0),onKeyDown:v,placeholder:t,className:"w-full pl-3 pr-10 py-3 text-lg border border-gray-300 rounded-xl focus:ring-2 focus:ring-violet-500 focus:border-violet-500 bg-white","aria-autocomplete":"list","aria-expanded":f,"aria-haspopup":"listbox",role:"combobox"}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400",children:A?"...":C?"offline":""})]}),f&&B.length>0&&e.jsx("ul",{role:"listbox",className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-80 overflow-auto",children:B.map((T,F)=>e.jsx("li",{children:e.jsxs("button",{type:"button",onMouseDown:se=>se.preventDefault(),onMouseEnter:()=>O(F),onClick:()=>P(T),className:`w-full flex items-center justify-between px-4 py-3 text-left transition-all duration-150 ${F===m?"bg-violet-50 border-l-4 border-violet-500 shadow-sm":"hover:bg-gray-50 border-l-4 border-transparent"}`,role:"option","aria-selected":F===m,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"font-medium text-gray-900 block truncate",children:T.name}),T.type&&e.jsx("span",{className:"text-xs text-gray-500 capitalize",children:T.type})]}),T.rxcui&&e.jsx("div",{className:"flex-shrink-0 ml-3",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-700",children:T.rxcui})})]})},`${T.rxcui||T.name}-${F}`))})]})}const Pt=[{value:"antineoplastic",label:"Antineoplastic Agents",description:"Drugs that inhibit or prevent cancer growth",count:1247,popular:!0},{value:"immunotherapy",label:"Immunotherapy",description:"Treatments that use the immune system",count:324,popular:!0},{value:"targeted_therapy",label:"Targeted Therapy",description:"Drugs targeting specific cancer mechanisms",count:456,popular:!0},{value:"chemotherapy",label:"Chemotherapy",description:"Traditional cytotoxic agents",count:892,popular:!0},{value:"hormone_therapy",label:"Hormone Therapy",description:"Treatments that block hormones",count:156},{value:"supportive_care",label:"Supportive Care",description:"Drugs for managing side effects",count:234},{value:"pain_management",label:"Pain Management",description:"Analgesics and pain control",count:187},{value:"antiemetic",label:"Antiemetic",description:"Anti-nausea medications",count:89},{value:"growth_factor",label:"Growth Factor",description:"Stimulate blood cell production",count:67},{value:"bisphosphonate",label:"Bisphosphonate",description:"Bone strengthening agents",count:45},{value:"radioprotective",label:"Radioprotective",description:"Protect from radiation damage",count:23},{value:"differentiation_agent",label:"Differentiation Agent",description:"Promote cell maturation",count:34}],_t=[{value:"kinase_inhibitor",label:"Kinase Inhibitor",description:"Blocks protein kinase enzymes",count:234,popular:!0},{value:"monoclonal_antibody",label:"Monoclonal Antibody",description:"Engineered antibodies",count:187,popular:!0},{value:"checkpoint_inhibitor",label:"Checkpoint Inhibitor",description:"Immune checkpoint blockade",count:45,popular:!0},{value:"alkylating_agent",label:"Alkylating Agent",description:"DNA crosslinking compounds",count:156},{value:"antimetabolite",label:"Antimetabolite",description:"Interferes with DNA/RNA synthesis",count:123},{value:"topoisomerase_inhibitor",label:"Topoisomerase Inhibitor",description:"Prevents DNA unwinding",count:98},{value:"proteasome_inhibitor",label:"Proteasome Inhibitor",description:"Blocks protein degradation",count:34},{value:"angiogenesis_inhibitor",label:"Angiogenesis Inhibitor",description:"Prevents blood vessel formation",count:67},{value:"histone_deacetylase_inhibitor",label:"HDAC Inhibitor",description:"Epigenetic modifier",count:29},{value:"mtor_inhibitor",label:"mTOR Inhibitor",description:"Blocks mTOR pathway",count:23},{value:"cyclin_dependent_kinase_inhibitor",label:"CDK Inhibitor",description:"Cell cycle inhibitor",count:18},{value:"poly_adp_ribose_polymerase_inhibitor",label:"PARP Inhibitor",description:"DNA repair inhibitor",count:12}],Et=[{value:"breast_cancer",label:"Breast Cancer",description:"Malignant breast tumors",count:456,popular:!0},{value:"lung_cancer",label:"Lung Cancer",description:"Non-small cell and small cell",count:423,popular:!0},{value:"colorectal_cancer",label:"Colorectal Cancer",description:"Colon and rectal cancers",count:234,popular:!0},{value:"melanoma",label:"Melanoma",description:"Malignant skin cancer",count:156,popular:!0},{value:"leukemia",label:"Leukemia",description:"Blood cancer varieties",count:189},{value:"lymphoma",label:"Lymphoma",description:"Lymphatic system cancers",count:167},{value:"prostate_cancer",label:"Prostate Cancer",description:"Male reproductive cancer",count:145},{value:"ovarian_cancer",label:"Ovarian Cancer",description:"Female reproductive cancer",count:123},{value:"pancreatic_cancer",label:"Pancreatic Cancer",description:"Digestive system cancer",count:98},{value:"renal_cell_carcinoma",label:"Renal Cell Carcinoma",description:"Kidney cancer",count:87},{value:"hepatocellular_carcinoma",label:"Hepatocellular Carcinoma",description:"Liver cancer",count:76},{value:"glioblastoma",label:"Glioblastoma",description:"Aggressive brain tumor",count:65},{value:"sarcoma",label:"Sarcoma",description:"Connective tissue cancer",count:54},{value:"multiple_myeloma",label:"Multiple Myeloma",description:"Plasma cell cancer",count:43},{value:"bladder_cancer",label:"Bladder Cancer",description:"Urinary system cancer",count:32}],Lt=[{value:"her2_positive",label:"HER2 Positive",description:"HER2 protein overexpression",count:234,popular:!0},{value:"er_pr_positive",label:"ER/PR Positive",description:"Hormone receptor positive",count:198,popular:!0},{value:"triple_negative",label:"Triple Negative",description:"ER-, PR-, HER2- breast cancer",count:123,popular:!0},{value:"egfr_mutation",label:"EGFR Mutation",description:"EGFR gene alterations",count:187,popular:!0},{value:"kras_mutation",label:"KRAS Mutation",description:"KRAS oncogene mutations",count:156},{value:"brca_mutation",label:"BRCA Mutation",description:"BRCA1/2 gene mutations",count:89},{value:"pd_l1_positive",label:"PD-L1 Positive",description:"PD-L1 expression ≥1%",count:167},{value:"msi_high",label:"MSI-High",description:"Microsatellite instability",count:78},{value:"tmb_high",label:"TMB-High",description:"High tumor mutation burden",count:67},{value:"braf_mutation",label:"BRAF Mutation",description:"BRAF V600E mutations",count:98},{value:"alk_fusion",label:"ALK Fusion",description:"ALK gene rearrangements",count:45},{value:"ros1_fusion",label:"ROS1 Fusion",description:"ROS1 gene fusions",count:23},{value:"ntrk_fusion",label:"NTRK Fusion",description:"NTRK gene fusions",count:18},{value:"ret_fusion",label:"RET Fusion",description:"RET gene rearrangements",count:34},{value:"met_amplification",label:"MET Amplification",description:"MET gene amplification",count:29}],qt=[{value:"fda_approved",label:"FDA Approved",description:"Full FDA approval",count:1456,popular:!0},{value:"accelerated_approval",label:"Accelerated Approval",description:"FDA accelerated pathway",count:89},{value:"breakthrough_therapy",label:"Breakthrough Therapy",description:"FDA breakthrough designation",count:67},{value:"fast_track",label:"Fast Track",description:"FDA fast track status",count:123},{value:"orphan_drug",label:"Orphan Drug",description:"Rare disease designation",count:234},{value:"priority_review",label:"Priority Review",description:"Expedited FDA review",count:156},{value:"ema_approved",label:"EMA Approved",description:"European approval",count:1234},{value:"conditional_approval",label:"Conditional Approval",description:"Conditional marketing authorization",count:45},{value:"investigational",label:"Investigational",description:"In clinical trials",count:567}],Bt=[{value:"approved",label:"FDA Approved",description:"Marketed drugs",count:1456,popular:!0},{value:"phase_4",label:"Phase IV",description:"Post-marketing surveillance",count:234},{value:"phase_3",label:"Phase III",description:"Large-scale efficacy trials",count:345,popular:!0},{value:"phase_2",label:"Phase II",description:"Dose-finding and efficacy",count:567},{value:"phase_1",label:"Phase I",description:"First-in-human safety",count:789},{value:"phase_1_2",label:"Phase I/II",description:"Combined early phases",count:123},{value:"phase_2_3",label:"Phase II/III",description:"Combined late phases",count:89},{value:"investigational",label:"Investigational",description:"All trial phases",count:1234}],Mt=({options:t,selectedValues:i,onSelectionChange:c,placeholder:s="Select options...",label:d,maxSelection:b,searchable:k=!0,showCounts:f=!0,className:x=""})=>{const[A,j]=r.useState(!1),[C,D]=r.useState(""),[N,n]=r.useState(t),m=r.useRef(null),O=r.useRef(null);r.useEffect(()=>{if(C.trim()){const v=t.filter(P=>P.label.toLowerCase().includes(C.toLowerCase())||P.description?.toLowerCase().includes(C.toLowerCase())||P.value.toLowerCase().includes(C.toLowerCase()));n(v)}else{const v=[...t].sort((P,B)=>P.popular&&!B.popular?-1:!P.popular&&B.popular?1:(B.count||0)-(P.count||0));n(v)}},[C,t]),r.useEffect(()=>{const v=P=>{m.current&&!m.current.contains(P.target)&&j(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const M=v=>{const P=i.includes(v);let B;if(P)B=i.filter(T=>T!==v);else{if(b&&i.length>=b)return;B=[...i,v]}c(B)},h=v=>{c(i.filter(P=>P!==v))},_=()=>{c([])};return e.jsxs("div",{ref:m,className:`relative ${x}`,children:[d&&e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:d}),i.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-2",children:[i.map(v=>{const P=t.find(B=>B.value===v);return e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-violet-100 text-violet-800",children:[P?.label||v,e.jsx("button",{onClick:()=>h(v),className:"ml-1 text-violet-600 hover:text-violet-800",children:e.jsx(Be,{className:"h-3 w-3"})})]},v)}),i.length>1&&e.jsx("button",{onClick:_,className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-600 hover:bg-gray-200",children:"Clear all"})]}),e.jsxs("button",{onClick:()=>j(!A),className:"w-full flex items-center justify-between px-3 py-2 border border-gray-300 rounded-lg bg-white hover:bg-gray-50 focus:ring-2 focus:ring-violet-500 focus:border-violet-500",children:[e.jsx("span",{className:`text-sm ${i.length===0?"text-gray-500":"text-gray-900"}`,children:i.length===0?s:`${i.length} selected`}),e.jsx(Pe,{className:`h-4 w-4 text-gray-400 transition-transform ${A?"rotate-180":""}`})]}),A&&e.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-80 overflow-hidden",children:[k&&e.jsx("div",{className:"p-3 border-b",children:e.jsxs("div",{className:"relative",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{ref:O,type:"text",value:C,onChange:v=>D(v.target.value),placeholder:"Search options...",className:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-500 focus:border-violet-500"})]})}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:N.length>0?N.map(v=>e.jsxs("button",{onMouseDown:P=>{P.preventDefault()},onClick:()=>M(v.value),className:"w-full flex items-center justify-between px-3 py-2 text-left hover:bg-gray-50 focus:bg-gray-50",disabled:b&&i.length>=b&&!i.includes(v.value),children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`text-sm font-medium ${i.includes(v.value)?"text-violet-700":"text-gray-900"}`,children:v.label}),v.popular&&e.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-yellow-100 text-yellow-800 rounded-full",children:"Popular"})]}),v.description&&e.jsx("p",{className:"text-xs text-gray-500 mt-0.5 truncate",children:v.description})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-2",children:[f&&v.count&&e.jsx("span",{className:"text-xs text-gray-400",children:v.count}),i.includes(v.value)&&e.jsx(yt,{className:"h-4 w-4 text-violet-600"})]})]},v.value)):e.jsxs("div",{className:"px-3 py-4 text-center text-gray-500",children:[e.jsx(ie,{className:"h-6 w-6 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"No options found"})]})}),N.length>0&&e.jsxs("div",{className:"px-3 py-2 bg-gray-50 border-t text-xs text-gray-500 text-center",children:[i.length>0&&e.jsxs("span",{children:[i.length," selected • "]}),N.length," option",N.length!==1?"s":"",b&&e.jsxs("span",{children:[" • Max ",b]})]})]})]})},zt=({onOfflineChange:t})=>{const i=Te(),[c,s]=r.useState({query:"",drugType:[],therapeuticClass:[],mechanismOfAction:[],indication:[],biomarker:[],approvalStatus:[],clinicalTrialPhase:[],hasInteractions:!1,hasGenomicFactors:!1,requiresMonitoring:!1,isOncologyDrug:!1,isOrphanDrug:!1,hasBlackBoxWarning:!1}),[d,b]=r.useState([]),[k,f]=r.useState([]),[x,A]=r.useState(!1),[j,C]=r.useState(!1),[D,N]=r.useState("search"),[n,m]=r.useState("therapeutic"),[O,M]=r.useState([]),[h,_]=r.useState(!1),[v,P]=r.useState(!1),[B,T]=r.useState(!1),[F,se]=r.useState(null),[G,Z]=r.useState([]),[l,u]=r.useState(!1),[y,q]=r.useState(null),[te,g]=r.useState([]),[E,K]=r.useState(null),[re,le]=r.useState(!1),[p,R]=r.useState(null),[V,U]=r.useState(!1),[Q,J]=r.useState(null),[ne,ce]=r.useState(null),[oe,ve]=r.useState(!1),[je,Ne]=r.useState(null),o=async a=>!a||a.length<2?[]:[{type:"drug",text:"pembrolizumab",confidence:.95,category:"PD-1 Inhibitor",description:"Checkpoint inhibitor for multiple cancer types",relevantDrugs:["nivolumab","atezolizumab"],alternativeTerms:["Keytruda","PD-1 inhibitor"]},{type:"indication",text:"non-small cell lung cancer",confidence:.88,category:"Oncology",description:"Most common type of lung cancer",relevantDrugs:["osimertinib","erlotinib","gefitinib"]},{type:"mechanism",text:"EGFR tyrosine kinase inhibitor",confidence:.82,category:"Targeted Therapy",description:"Targets EGFR signaling pathway",relevantDrugs:["osimertinib","erlotinib","afatinib"]}].filter(I=>I.text.toLowerCase().includes(a.toLowerCase())||I.category.toLowerCase().includes(a.toLowerCase())||I.alternativeTerms?.some(X=>X.toLowerCase().includes(a.toLowerCase())));r.useEffect(()=>{const a=setTimeout(async()=>{if(c.query){const w=await o(c.query);b(w)}},300);return()=>clearTimeout(a)},[c.query]),r.useEffect(()=>{let a=!1;if(!c.query||c.query.trim().length<2){M([]),_(!1);return}P(!0);const w=setTimeout(async()=>{try{const I=await fetch(`/api/drugs/suggestions?q=${encodeURIComponent(c.query)}&limit=8`);if(!I.ok)throw new Error("suggestions failed");const X=await I.json();if(a)return;M((X.suggestions||[]).map(me=>({name:me.name,rxcui:me.rxcui}))),_(!!X.offline),t?.(!!X.offline)}catch{if(!a){const I=[{name:"aspirin"},{name:"ibuprofen"},{name:"acetaminophen"},{name:"clopidogrel"},{name:"warfarin"},{name:"omeprazole"},{name:"simvastatin"},{name:"levodopa"}],X=c.query.toLowerCase(),me=I.filter(ue=>ue.name.includes(X)).slice(0,8);M(me),_(!0),t?.(!0)}}finally{a||P(!1)}},300);return()=>{a=!0,clearTimeout(w)}},[c.query,t]);const S=(a,w)=>{s(I=>({...I,[a]:w}))},z=async()=>{const a=(c.query||"").trim();if(!(a.length<2)){T(!0),se(null),Z([]);try{const w=await fetch(`/api/drugs/search?q=${encodeURIComponent(a)}`);if(!w.ok)throw new Error(`HTTP ${w.status}`);const I=await w.json(),X=Array.isArray(I?.results)?I.results:[];Z(X)}catch(w){se(w?.message||"Search failed")}finally{T(!1)}}};r.useEffect(()=>{(async()=>{if(!y){g([]),K(null);return}le(!0),K(null);try{const w=await fetch(`/api/drugs/${encodeURIComponent(y)}/variants`);if(!w.ok)throw new Error(`HTTP ${w.status}`);const I=await w.json();g(Array.isArray(I?.variants)?I.variants:[])}catch(w){K(w?.message||"Failed to load variations"),g([])}finally{le(!1)}})()},[y]),r.useEffect(()=>{(async()=>{if(!y){R(null),J(null);return}U(!0),J(null);try{const w=await fetch(`/api/drugs/${encodeURIComponent(y)}`);if(!w.ok)throw new Error(`HTTP ${w.status}`);const I=await w.json();R(I)}catch(w){J(w?.message||"Failed to load details"),R(null)}finally{U(!1)}})()},[y]),r.useEffect(()=>{(async()=>{if(!y){ce(null),Ne(null);return}ve(!0),Ne(null);try{const w=await fetch(`/api/drugs/${encodeURIComponent(y)}/interactions`);if(!w.ok)throw new Error(`HTTP ${w.status}`);const I=await w.json(),X=I?.interactions?.stored||[],me=I?.interactions?.external||[],ue=[...X,...me],xe=de=>String(de||"").toLowerCase(),at=ue.filter(de=>xe(de.severity).includes("major")||xe(de.severity).includes("high")).length,st=ue.filter(de=>xe(de.severity).includes("moderate")).length,rt=ue.filter(de=>xe(de.severity).includes("minor")||xe(de.severity).includes("low")).length;ce({total:ue.length,major:at,moderate:st,minor:rt})}catch(w){Ne(w?.message||"Failed to load interaction summary"),ce(null)}finally{ve(!1)}})()},[y]);const L=()=>{s({query:"",drugType:[],therapeuticClass:[],mechanismOfAction:[],indication:[],biomarker:[],approvalStatus:[],clinicalTrialPhase:[],hasInteractions:!1,hasGenomicFactors:!1,requiresMonitoring:!1,isOncologyDrug:!1,isOrphanDrug:!1,hasBlackBoxWarning:!1})},H=()=>{let a=0;return Object.entries(c).forEach(([w,I])=>{w!=="query"&&(Array.isArray(I)&&I.length>0&&a++,typeof I=="boolean"&&I&&a++)}),a},W=(a,w,I,X)=>{const me=c[a];return e.jsxs($,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[X,e.jsx("h4",{className:"font-medium text-gray-900",children:I})]}),e.jsx(Mt,{options:w,selectedValues:me,onSelectionChange:ue=>{s(xe=>({...xe,[a]:ue}))},placeholder:`Select ${I.toLowerCase()}...`,searchable:!0,showCounts:!0,maxSelection:5})]})},Y=({isActive:a,onClick:w,children:I})=>e.jsx("button",{onClick:w,className:`px-4 py-2 text-sm font-medium rounded-lg ${a?"bg-violet-100 text-violet-700 border border-violet-200":"text-gray-600 hover:text-gray-800 hover:bg-gray-100"}`,children:I});return e.jsxs("div",{className:"space-y-6",children:[e.jsx($,{className:"border-violet-200 bg-gradient-to-r from-violet-50 to-indigo-50",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(pe,{className:"h-6 w-6 text-violet-600"}),e.jsx("h2",{className:"text-xl font-bold text-violet-800",children:"AI-Enhanced Drug Search"}),e.jsx("span",{className:"px-3 py-1 bg-violet-100 text-violet-800 rounded-full text-sm font-medium",children:"Neural Engine v2.0"})]}),e.jsx("div",{className:"mb-4",children:e.jsx(Rt,{placeholder:"Search by drug name, indication, mechanism, biomarker, or ask a question...",value:c.query,onChange:a=>S("query",a),onSelect:a=>{S("query",a.name),a.rxcui&&/^\d+$/.test(String(a.rxcui))&&q(String(a.rxcui))},maxResults:12,onOfflineChange:t,onAutoResolve:a=>{S("query",a.name),a.rxcui&&/^\d+$/.test(String(a.rxcui))&&q(String(a.rxcui))}})}),d.length>0&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-lg mb-4",children:[e.jsx("div",{className:"p-3 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ze,{className:"h-4 w-4 text-violet-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"AI Suggestions"})]})}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:d.map((a,w)=>e.jsxs("button",{onClick:()=>S("query",a.text),className:"w-full flex items-center space-x-3 p-3 hover:bg-gray-50 text-left",children:[e.jsxs("div",{className:"flex-shrink-0",children:[a.type==="drug"&&e.jsx(ye,{className:"h-4 w-4 text-blue-500"}),a.type==="indication"&&e.jsx(ge,{className:"h-4 w-4 text-red-500"}),a.type==="mechanism"&&e.jsx(Ie,{className:"h-4 w-4 text-purple-500"}),a.type==="biomarker"&&e.jsx(be,{className:"h-4 w-4 text-green-500"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:a.text}),e.jsx("div",{className:"text-xs text-gray-500",children:a.category}),a.description&&e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:a.description})]}),e.jsxs("div",{className:"text-xs text-gray-400",children:[Math.round(a.confidence*100),"%"]})]},w))})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"AI Mode:"}),e.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[{mode:"search",label:"Smart Search",icon:ie},{mode:"recommend",label:"Recommendations",icon:ge},{mode:"analyze",label:"Deep Analysis",icon:Ue}].map(({mode:a,label:w,icon:I})=>e.jsxs("button",{onClick:()=>N(a),className:`flex items-center space-x-2 px-3 py-1 rounded-md text-sm font-medium transition-all ${D===a?"bg-white text-violet-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:w})]},a))})]})]})}),e.jsx($,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Re,{className:"h-5 w-5 text-gray-600"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Advanced Filters"}),H()>0&&e.jsxs("span",{className:"px-2 py-1 bg-violet-100 text-violet-800 rounded-full text-sm font-medium",children:[H()," active"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:L,className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Clear All"}),e.jsxs("button",{onClick:()=>C(!j),className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center space-x-1",children:[j?e.jsx(Ke,{className:"h-4 w-4"}):e.jsx(Pe,{className:"h-4 w-4"}),e.jsxs("span",{children:[j?"Hide":"Show"," Filters"]})]})]})]}),j&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex space-x-2 mb-4",children:[e.jsx(Y,{isActive:n==="therapeutic",onClick:()=>m("therapeutic"),children:"Therapeutic"}),e.jsx(Y,{isActive:n==="molecular",onClick:()=>m("molecular"),children:"Molecular"}),e.jsx(Y,{isActive:n==="clinical",onClick:()=>m("clinical"),children:"Clinical"}),e.jsx(Y,{isActive:n==="regulatory",onClick:()=>m("regulatory"),children:"Regulatory"}),e.jsx(Y,{isActive:n==="safety",onClick:()=>m("safety"),children:"Safety"})]}),n==="therapeutic"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[W("therapeuticClass",Pt,"Therapeutic Class",e.jsx(Me,{className:"h-4 w-4 text-red-500"})),W("indication",Et,"Cancer Indication",e.jsx(ge,{className:"h-4 w-4 text-blue-500"})),W("mechanismOfAction",_t,"Mechanism of Action",e.jsx(Ie,{className:"h-4 w-4 text-purple-500"}))]}),n==="molecular"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[W("biomarker",Lt,"Biomarker Targets",e.jsx(be,{className:"h-4 w-4 text-green-500"})),e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Qe,{className:"h-4 w-4 text-blue-500"}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Molecular Features"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.hasGenomicFactors,onChange:a=>S("hasGenomicFactors",a.target.checked),className:"rounded border-gray-300 text-violet-600 focus:ring-violet-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Has Genomic Factors"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.hasInteractions,onChange:a=>S("hasInteractions",a.target.checked),className:"rounded border-gray-300 text-violet-600 focus:ring-violet-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Has Drug Interactions"})]})]})]})})]}),n==="clinical"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[W("clinicalTrialPhase",Bt,"Clinical Trial Phase",e.jsx(qe,{className:"h-4 w-4 text-orange-500"})),e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{className:"h-4 w-4 text-purple-500"}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Patient Factors"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.requiresMonitoring,onChange:a=>S("requiresMonitoring",a.target.checked),className:"rounded border-gray-300 text-violet-600 focus:ring-violet-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Requires Monitoring"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.isOncologyDrug,onChange:a=>S("isOncologyDrug",a.target.checked),className:"rounded border-gray-300 text-violet-600 focus:ring-violet-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Oncology Drugs Only"})]})]})]})})]}),n==="regulatory"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[W("approvalStatus",qt,"Approval Status",e.jsx(ke,{className:"h-4 w-4 text-green-500"})),e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Oe,{className:"h-4 w-4 text-blue-500"}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Regulatory Features"})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.isOrphanDrug,onChange:a=>S("isOrphanDrug",a.target.checked),className:"rounded border-gray-300 text-violet-600 focus:ring-violet-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Orphan Drug Status"})]})})]})})]}),n==="safety"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(He,{className:"h-4 w-4 text-red-500"}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Safety Alerts"})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.hasBlackBoxWarning,onChange:a=>S("hasBlackBoxWarning",a.target.checked),className:"rounded border-gray-300 text-violet-600 focus:ring-violet-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Black Box Warning"})]})})]})})})]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:z,disabled:B||!c.query||c.query.trim().length<2,className:"bg-gradient-to-r from-violet-600 to-indigo-600 disabled:opacity-50 text-white px-6 py-3 rounded-lg hover:from-violet-700 hover:to-indigo-700 flex items-center space-x-2",children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx("span",{children:"Search Drugs"})]}),e.jsxs("button",{className:"border border-gray-300 text-gray-700 px-4 py-3 rounded-lg hover:bg-gray-50 flex items-center space-x-2",children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx("span",{children:"Get AI Recommendations"})]}),e.jsxs("button",{className:"border border-gray-300 text-gray-700 px-4 py-3 rounded-lg hover:bg-gray-50 flex items-center space-x-2",children:[e.jsx(Xe,{className:"h-4 w-4"}),e.jsx("span",{children:"Export Results"})]})]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Powered by OncoSafeRx Neural Engine"})]}),e.jsxs("div",{className:"mt-4",children:[y&&e.jsxs("div",{className:"mb-3 p-3 bg-white border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-700",children:["Variations for RXCUI ",y]}),re&&e.jsx("div",{className:"text-xs text-gray-500",children:"Loading…"})]}),E&&e.jsx("div",{className:"text-xs text-red-600",children:E}),!E&&te.length===0&&!re&&e.jsx("div",{className:"text-xs text-gray-500",children:"No variations found"}),te.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:te.slice(0,30).map(a=>e.jsx("button",{onClick:()=>q(a.rxcui),className:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-800 hover:bg-gray-200",title:a.tty,children:a.name},a.rxcui))})]}),y&&e.jsxs("div",{className:"mb-3 p-3 bg-white border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Details"}),V&&e.jsx("div",{className:"text-xs text-gray-500",children:"Loading…"})]}),Q&&e.jsx("div",{className:"text-xs text-red-600",children:Q}),!Q&&!V&&p&&e.jsxs("div",{className:"text-sm text-gray-800 space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Name:"})," ",p.name]}),p.generic_name&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Generic:"})," ",p.generic_name]}),Array.isArray(p.brand_names)&&p.brand_names.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Brands:"})," ",p.brand_names.join(", ")]}),Array.isArray(p.dosage_forms)&&p.dosage_forms.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Dosage forms:"})," ",p.dosage_forms.join(", ")]}),Array.isArray(p.strengths)&&p.strengths.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Strengths:"})," ",p.strengths.join(", ")]}),e.jsxs("div",{className:"pt-2",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Interaction summary"}),oe&&e.jsx("div",{className:"text-xs text-gray-500",children:"Checking…"}),je&&e.jsx("div",{className:"text-xs text-red-600",children:je}),!oe&&!je&&ne&&e.jsxs("div",{className:"flex gap-3 text-xs text-gray-700",children:[e.jsxs("span",{children:["Total: ",ne.total]}),e.jsxs("span",{children:["Major: ",ne.major]}),e.jsxs("span",{children:["Moderate: ",ne.moderate]}),e.jsxs("span",{children:["Minor: ",ne.minor]})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("button",{type:"button",className:"text-xs px-3 py-1 border border-gray-300 rounded hover:bg-gray-50",onClick:()=>{try{const a="osrx_interaction_basket",w=JSON.parse(localStorage.getItem(a)||"[]");console.log("🔍 Adding drug to basket:",{selectedRxcui:y,drugName:p.name,currentBasket:w}),w.find(I=>I.id===y)?console.log("🔍 Drug already in basket, not adding"):(w.push({id:y,name:p.name}),localStorage.setItem(a,JSON.stringify(w.slice(-10))),console.log("🔍 Drug added to basket:",{newBasket:w,stored:localStorage.getItem(a)})),setTimeout(()=>{console.log("🔍 Navigating to interactions page..."),window.location.pathname!=="/interactions"&&i("/interactions")},150)}catch(a){console.error("🔍 Error adding drug to basket:",a)}},children:"Check interactions for this drug"}),e.jsx("button",{type:"button",className:"text-xs px-3 py-1 border border-gray-300 rounded hover:bg-gray-50",onClick:()=>{try{localStorage.setItem("osrx_selected_drug",JSON.stringify(p))}catch{}setTimeout(()=>i("/database"),100)},children:"View full profile"})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:a=>u(a.target.checked),className:"rounded border-gray-300 text-violet-600 focus:ring-violet-500"}),"Pinned only"]})}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:()=>{window.location.pathname!=="/interactions"&&setTimeout(()=>i("/interactions"),100)},className:"text-sm px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Go to Interactions"})})]}),B&&e.jsx("div",{className:"text-sm text-gray-600",children:"Searching…"}),F&&e.jsx("div",{className:"text-sm text-red-600",children:F}),!B&&!F&&G.length>0&&e.jsx(Ot,{drugs:G.map(a=>({id:a.rxcui||a.id||a.name,name:a.name,genericName:a.generic_name||a.genericName||a.name,therapeuticClass:a.insights?.therapeuticClass||a.therapeutic_class||"Unknown",mechanismOfAction:a.insights?.mechanism||a.mechanism||"Unknown",indication:a.insights?.indications||(a.indication?[a.indication]:[]),fdaApproved:!0,safetyScore:0,efficacyScore:0,evidenceLevel:"moderate",hasInteractions:!1,hasGenomicFactors:!1,requiresMonitoring:!1,costTier:"moderate",routeOfAdministration:[],dosageForm:[],keyBenefits:[],keyRisks:[],commonSideEffects:[],monitoringRequirements:[],contraindications:[],patientSuitability:[],relatedDrugs:[],clinicalTrials:0,publications:0,isOncologyDrug:!!a.insights?.isOncologyDrug,isOrphanDrug:!!a.insights?.isOrphanDrug})).filter(a=>{if(!l)return!0;try{return!!JSON.parse(localStorage.getItem("oncosaferx_pins")||"{}")[String(a.id)]}catch{return!1}}),loading:!1,error:void 0,onDrugSelect:a=>{s(w=>({...w,query:a.name})),a?.id&&/^\d+$/.test(String(a.id))&&q(String(a.id))},onPin:a=>{a?.id&&a?.name&&Se(String(a.id),String(a.name))},onAddToInteractions:a=>{try{const w="osrx_interaction_basket",I=JSON.parse(localStorage.getItem(w)||"[]");console.log("🔍 EnhancedDrugResults - Adding drug to basket:",{drugId:a.id,drugName:a.name,currentBasket:I}),I.find(X=>X.id===a.id)?console.log("🔍 EnhancedDrugResults - Drug already in basket, not adding"):(I.push({id:a.id,name:a.name}),localStorage.setItem(w,JSON.stringify(I.slice(-10))),console.log("🔍 EnhancedDrugResults - Drug added to basket:",{newBasket:I,stored:localStorage.getItem(w)})),setTimeout(()=>{console.log("🔍 EnhancedDrugResults - Navigating to interactions page..."),window.location.pathname!=="/interactions"&&i("/interactions")},150)}catch(w){console.error("🔍 EnhancedDrugResults - Error adding drug to basket:",w)}}})]})]})},$e=[{id:"pembrolizumab",label:"Pembrolizumab (Keytruda)",value:"pembrolizumab",type:"drug",category:"PD-1 Inhibitor",description:"Immune checkpoint inhibitor for various cancers",aliases:["keytruda","mk-3475"],frequency:95,fdaApproved:!0,isOncology:!0,targetGenes:["PD1","PDL1"],relatedTerms:["immunotherapy","checkpoint inhibitor","PD-1"]},{id:"nivolumab",label:"Nivolumab (Opdivo)",value:"nivolumab",type:"drug",category:"PD-1 Inhibitor",description:"Anti-PD-1 monoclonal antibody",aliases:["opdivo","bms-936558"],frequency:88,fdaApproved:!0,isOncology:!0,targetGenes:["PD1"],relatedTerms:["immunotherapy","melanoma","lung cancer"]},{id:"trastuzumab",label:"Trastuzumab (Herceptin)",value:"trastuzumab",type:"drug",category:"HER2 Inhibitor",description:"Monoclonal antibody targeting HER2",aliases:["herceptin"],frequency:92,fdaApproved:!0,isOncology:!0,targetGenes:["HER2","ERBB2"],relatedTerms:["breast cancer","HER2 positive","targeted therapy"]},{id:"imatinib",label:"Imatinib (Gleevec)",value:"imatinib",type:"drug",category:"Tyrosine Kinase Inhibitor",description:"BCR-ABL tyrosine kinase inhibitor",aliases:["gleevec","sti571"],frequency:85,fdaApproved:!0,isOncology:!0,targetGenes:["BCR-ABL","KIT","PDGFR"],relatedTerms:["CML","leukemia","GIST"]},{id:"osimertinib",label:"Osimertinib (Tagrisso)",value:"osimertinib",type:"drug",category:"EGFR Inhibitor",description:"Third-generation EGFR inhibitor",aliases:["tagrisso","azd9291"],frequency:82,fdaApproved:!0,isOncology:!0,targetGenes:["EGFR","T790M"],relatedTerms:["NSCLC","lung cancer","EGFR mutation"]},{id:"bevacizumab",label:"Bevacizumab (Avastin)",value:"bevacizumab",type:"drug",category:"VEGF Inhibitor",description:"Anti-VEGF monoclonal antibody",aliases:["avastin"],frequency:89,fdaApproved:!0,isOncology:!0,targetGenes:["VEGF"],relatedTerms:["angiogenesis","colorectal cancer","anti-angiogenic"]},{id:"rituximab",label:"Rituximab (Rituxan)",value:"rituximab",type:"drug",category:"CD20 Inhibitor",description:"Anti-CD20 monoclonal antibody",aliases:["rituxan","mabthera"],frequency:87,fdaApproved:!0,isOncology:!0,targetGenes:["CD20"],relatedTerms:["lymphoma","B-cell","hematologic malignancy"]},{id:"paclitaxel",label:"Paclitaxel (Taxol)",value:"paclitaxel",type:"drug",category:"Taxane",description:"Microtubule stabilizing agent",aliases:["taxol"],frequency:91,fdaApproved:!0,isOncology:!0,relatedTerms:["chemotherapy","breast cancer","ovarian cancer"]},{id:"doxorubicin",label:"Doxorubicin (Adriamycin)",value:"doxorubicin",type:"drug",category:"Anthracycline",description:"DNA intercalating agent",aliases:["adriamycin"],frequency:86,fdaApproved:!0,isOncology:!0,relatedTerms:["chemotherapy","cardiotoxicity","sarcoma"]},{id:"carboplatin",label:"Carboplatin",value:"carboplatin",type:"drug",category:"Platinum Compound",description:"DNA crosslinking agent",frequency:84,fdaApproved:!0,isOncology:!0,relatedTerms:["chemotherapy","ovarian cancer","lung cancer"]},{id:"aspirin",label:"Aspirin (Acetylsalicylic Acid)",value:"aspirin",type:"drug",category:"NSAID",description:"Anti-inflammatory, pain reliever, blood thinner",aliases:["acetylsalicylic acid","ASA","asa","asp"],frequency:99,fdaApproved:!0,isOncology:!1,relatedTerms:["pain relief","inflammation","heart disease","blood thinner","stroke prevention"]},{id:"acetaminophen",label:"Acetaminophen (Tylenol)",value:"acetaminophen",type:"drug",category:"Analgesic",description:"Pain reliever and fever reducer",aliases:["tylenol","paracetamol","acet"],frequency:98,fdaApproved:!0,isOncology:!1,relatedTerms:["pain relief","fever","headache"]},{id:"ibuprofen",label:"Ibuprofen (Advil, Motrin)",value:"ibuprofen",type:"drug",category:"NSAID",description:"Anti-inflammatory pain reliever",aliases:["advil","motrin","ibu"],frequency:97,fdaApproved:!0,isOncology:!1,relatedTerms:["pain relief","inflammation","fever","arthritis"]},{id:"naproxen",label:"Naproxen (Aleve)",value:"naproxen",type:"drug",category:"NSAID",description:"Long-acting anti-inflammatory",aliases:["aleve","naprosyn"],frequency:85,fdaApproved:!0,isOncology:!1,relatedTerms:["pain relief","inflammation","arthritis"]},{id:"diphenhydramine",label:"Diphenhydramine (Benadryl)",value:"diphenhydramine",type:"drug",category:"Antihistamine",description:"Allergy relief and sleep aid",aliases:["benadryl","dph"],frequency:82,fdaApproved:!0,isOncology:!1,relatedTerms:["allergy","sleep","antihistamine","itching"]},{id:"loratadine",label:"Loratadine (Claritin)",value:"loratadine",type:"drug",category:"Antihistamine",description:"Non-drowsy allergy medication",aliases:["claritin"],frequency:78,fdaApproved:!0,isOncology:!1,relatedTerms:["allergy","antihistamine","non-drowsy"]},{id:"cetirizine",label:"Cetirizine (Zyrtec)",value:"cetirizine",type:"drug",category:"Antihistamine",description:"Allergy and hives treatment",aliases:["zyrtec"],frequency:76,fdaApproved:!0,isOncology:!1,relatedTerms:["allergy","hives","antihistamine"]},{id:"omeprazole",label:"Omeprazole (Prilosec)",value:"omeprazole",type:"drug",category:"PPI",description:"Proton pump inhibitor for acid reflux",aliases:["prilosec","ppi"],frequency:89,fdaApproved:!0,isOncology:!1,relatedTerms:["acid reflux","heartburn","GERD","stomach acid"]},{id:"ranitidine",label:"Ranitidine (Zantac)",value:"ranitidine",type:"drug",category:"H2 Blocker",description:"Histamine H2 receptor antagonist",aliases:["zantac"],frequency:75,fdaApproved:!1,isOncology:!1,relatedTerms:["acid reflux","heartburn","H2 blocker"]},{id:"simvastatin",label:"Simvastatin (Zocor)",value:"simvastatin",type:"drug",category:"Statin",description:"Cholesterol-lowering medication",aliases:["zocor"],frequency:88,fdaApproved:!0,isOncology:!1,relatedTerms:["cholesterol","statin","heart disease","lipids"]},{id:"sertraline",label:"Sertraline (Zoloft)",value:"sertraline",type:"drug",category:"Antidepressant",description:"SSRI for depression and anxiety",aliases:["zoloft","lustral"],frequency:95,fdaApproved:!0,isOncology:!1,relatedTerms:["depression","anxiety","SSRI","mental health"]},{id:"fluoxetine",label:"Fluoxetine (Prozac)",value:"fluoxetine",type:"drug",category:"Antidepressant",description:"SSRI for depression and OCD",aliases:["prozac"],frequency:93,fdaApproved:!0,isOncology:!1,relatedTerms:["depression","OCD","SSRI","mental health"]},{id:"escitalopram",label:"Escitalopram (Lexapro)",value:"escitalopram",type:"drug",category:"Antidepressant",description:"SSRI for depression and anxiety disorders",aliases:["lexapro","cipralex"],frequency:91,fdaApproved:!0,isOncology:!1,relatedTerms:["depression","anxiety","SSRI","panic disorder"]},{id:"alprazolam",label:"Alprazolam (Xanax)",value:"alprazolam",type:"drug",category:"Benzodiazepine",description:"Short-acting benzodiazepine for anxiety",aliases:["xanax"],frequency:89,fdaApproved:!0,isOncology:!1,relatedTerms:["anxiety","panic disorder","benzodiazepine"]},{id:"lorazepam",label:"Lorazepam (Ativan)",value:"lorazepam",type:"drug",category:"Benzodiazepine",description:"Benzodiazepine for anxiety and seizures",aliases:["ativan"],frequency:87,fdaApproved:!0,isOncology:!1,relatedTerms:["anxiety","seizures","benzodiazepine"]},{id:"risperidone",label:"Risperidone (Risperdal)",value:"risperidone",type:"drug",category:"Antipsychotic",description:"Atypical antipsychotic",aliases:["risperdal"],frequency:83,fdaApproved:!0,isOncology:!1,relatedTerms:["schizophrenia","bipolar","antipsychotic"]},{id:"quetiapine",label:"Quetiapine (Seroquel)",value:"quetiapine",type:"drug",category:"Antipsychotic",description:"Atypical antipsychotic for bipolar and schizophrenia",aliases:["seroquel"],frequency:85,fdaApproved:!0,isOncology:!1,relatedTerms:["bipolar disorder","schizophrenia","antipsychotic"]},{id:"bupropion",label:"Bupropion (Wellbutrin)",value:"bupropion",type:"drug",category:"Antidepressant",description:"Atypical antidepressant and smoking cessation aid",aliases:["wellbutrin","zyban"],frequency:88,fdaApproved:!0,isOncology:!1,relatedTerms:["depression","smoking cessation","NDRI"]},{id:"levodopa",label:"Levodopa/Carbidopa (Sinemet)",value:"levodopa",type:"drug",category:"Neurological",description:"Dopamine precursor for Parkinson's disease",aliases:["sinemet","l-dopa"],frequency:90,fdaApproved:!0,isOncology:!1,relatedTerms:["parkinsons","dopamine","movement disorder"]},{id:"gabapentin",label:"Gabapentin (Neurontin)",value:"gabapentin",type:"drug",category:"Anticonvulsant",description:"Anticonvulsant for neuropathic pain and seizures",aliases:["neurontin"],frequency:92,fdaApproved:!0,isOncology:!1,relatedTerms:["neuropathic pain","seizures","epilepsy"]},{id:"pregabalin",label:"Pregabalin (Lyrica)",value:"pregabalin",type:"drug",category:"Anticonvulsant",description:"Anticonvulsant for neuropathic pain and fibromyalgia",aliases:["lyrica"],frequency:89,fdaApproved:!0,isOncology:!1,relatedTerms:["neuropathic pain","fibromyalgia","seizures"]},{id:"phenytoin",label:"Phenytoin (Dilantin)",value:"phenytoin",type:"drug",category:"Anticonvulsant",description:"Classic anticonvulsant for epilepsy",aliases:["dilantin"],frequency:85,fdaApproved:!0,isOncology:!1,relatedTerms:["epilepsy","seizures","anticonvulsant"]},{id:"valproic_acid",label:"Valproic Acid (Depakote)",value:"valproic acid",type:"drug",category:"Anticonvulsant",description:"Anticonvulsant and mood stabilizer",aliases:["depakote","divalproex"],frequency:87,fdaApproved:!0,isOncology:!1,relatedTerms:["epilepsy","bipolar disorder","migraine prevention"]},{id:"donepezil",label:"Donepezil (Aricept)",value:"donepezil",type:"drug",category:"Cholinesterase Inhibitor",description:"Cholinesterase inhibitor for Alzheimer's disease",aliases:["aricept"],frequency:88,fdaApproved:!0,isOncology:!1,relatedTerms:["alzheimers","dementia","cognitive impairment"]},{id:"morphine",label:"Morphine",value:"morphine",type:"drug",category:"Opioid",description:"Strong opioid for severe pain",aliases:["ms contin","kadian"],frequency:90,fdaApproved:!0,isOncology:!1,relatedTerms:["severe pain","opioid","cancer pain"]},{id:"oxycodone",label:"Oxycodone (OxyContin)",value:"oxycodone",type:"drug",category:"Opioid",description:"Opioid for moderate to severe pain",aliases:["oxycontin","percocet","roxicodone"],frequency:89,fdaApproved:!0,isOncology:!1,relatedTerms:["moderate pain","severe pain","opioid"]},{id:"hydrocodone",label:"Hydrocodone (Vicodin)",value:"hydrocodone",type:"drug",category:"Opioid",description:"Opioid for moderate pain",aliases:["vicodin","norco","lortab"],frequency:88,fdaApproved:!0,isOncology:!1,relatedTerms:["moderate pain","opioid","dental pain"]},{id:"fentanyl",label:"Fentanyl",value:"fentanyl",type:"drug",category:"Opioid",description:"Potent opioid for severe pain",aliases:["duragesic","actiq"],frequency:85,fdaApproved:!0,isOncology:!1,relatedTerms:["severe pain","cancer pain","breakthrough pain"]},{id:"tramadol",label:"Tramadol (Ultram)",value:"tramadol",type:"drug",category:"Opioid",description:"Mild opioid for moderate pain",aliases:["ultram","conzip"],frequency:87,fdaApproved:!0,isOncology:!1,relatedTerms:["moderate pain","chronic pain","weak opioid"]},{id:"celecoxib",label:"Celecoxib (Celebrex)",value:"celecoxib",type:"drug",category:"COX-2 Inhibitor",description:"Selective COX-2 inhibitor for pain and inflammation",aliases:["celebrex"],frequency:86,fdaApproved:!0,isOncology:!1,relatedTerms:["arthritis","inflammation","COX-2","joint pain"]},{id:"diclofenac",label:"Diclofenac (Voltaren)",value:"diclofenac",type:"drug",category:"NSAID",description:"NSAID for pain and inflammation",aliases:["voltaren","cataflam"],frequency:84,fdaApproved:!0,isOncology:!1,relatedTerms:["arthritis","inflammation","topical pain relief"]},{id:"venlafaxine",label:"Venlafaxine (Effexor)",value:"venlafaxine",type:"drug",category:"SNRI",description:"SNRI for depression and anxiety",aliases:["effexor"],frequency:86,fdaApproved:!0,isOncology:!1,relatedTerms:["depression","anxiety","SNRI"]},{id:"duloxetine",label:"Duloxetine (Cymbalta)",value:"duloxetine",type:"drug",category:"SNRI",description:"SNRI for depression and neuropathic pain",aliases:["cymbalta"],frequency:85,fdaApproved:!0,isOncology:!1,relatedTerms:["depression","neuropathic pain","fibromyalgia"]},{id:"citalopram",label:"Citalopram (Celexa)",value:"citalopram",type:"drug",category:"Antidepressant",description:"SSRI for depression",aliases:["celexa"],frequency:83,fdaApproved:!0,isOncology:!1,relatedTerms:["depression","SSRI"]},{id:"paroxetine",label:"Paroxetine (Paxil)",value:"paroxetine",type:"drug",category:"Antidepressant",description:"SSRI for depression and anxiety",aliases:["paxil"],frequency:82,fdaApproved:!0,isOncology:!1,relatedTerms:["depression","anxiety","SSRI"]},{id:"lithium",label:"Lithium",value:"lithium",type:"drug",category:"Mood Stabilizer",description:"Mood stabilizer for bipolar disorder",aliases:["lithobid","eskalith"],frequency:81,fdaApproved:!0,isOncology:!1,relatedTerms:["bipolar disorder","mood stabilizer","mania"]},{id:"breast_cancer",label:"Breast Cancer",value:"breast cancer",type:"indication",category:"Solid Tumor",description:"Most common cancer in women",frequency:95,relatedTerms:["HER2","ER","PR","triple negative","ductal carcinoma"]},{id:"lung_cancer",label:"Lung Cancer",value:"lung cancer",type:"indication",category:"Solid Tumor",description:"Leading cause of cancer death",frequency:93,relatedTerms:["NSCLC","SCLC","EGFR","ALK","smoking"]},{id:"colorectal_cancer",label:"Colorectal Cancer",value:"colorectal cancer",type:"indication",category:"Solid Tumor",description:"Cancer of colon or rectum",frequency:88,relatedTerms:["KRAS","BRAF","MSI","CRC","adenocarcinoma"]},{id:"melanoma",label:"Melanoma",value:"melanoma",type:"indication",category:"Skin Cancer",description:"Aggressive skin cancer",frequency:86,relatedTerms:["BRAF","MEK","immunotherapy","metastatic"]},{id:"leukemia",label:"Leukemia",value:"leukemia",type:"indication",category:"Hematologic Malignancy",description:"Blood cancer affecting white blood cells",frequency:84,relatedTerms:["AML","CML","ALL","CLL","bone marrow"]},{id:"lymphoma",label:"Lymphoma",value:"lymphoma",type:"indication",category:"Hematologic Malignancy",description:"Cancer of lymphatic system",frequency:82,relatedTerms:["Hodgkin","non-Hodgkin","B-cell","T-cell"]},{id:"prostate_cancer",label:"Prostate Cancer",value:"prostate cancer",type:"indication",category:"Solid Tumor",description:"Most common cancer in men",frequency:89,relatedTerms:["PSA","androgen","hormone therapy","Gleason score"]},{id:"ovarian_cancer",label:"Ovarian Cancer",value:"ovarian cancer",type:"indication",category:"Solid Tumor",description:"Gynecologic malignancy",frequency:78,relatedTerms:["BRCA","PARP","CA-125","serous carcinoma"]},{id:"pancreatic_cancer",label:"Pancreatic Cancer",value:"pancreatic cancer",type:"indication",category:"Solid Tumor",description:"Aggressive digestive system cancer",frequency:75,relatedTerms:["KRAS","BRCA2","gemcitabine","poor prognosis"]},{id:"renal_cell_carcinoma",label:"Renal Cell Carcinoma",value:"renal cell carcinoma",type:"indication",category:"Solid Tumor",description:"Most common kidney cancer",frequency:73,relatedTerms:["VHL","clear cell","sunitinib","immunotherapy"]},{id:"checkpoint_inhibitor",label:"Checkpoint Inhibitor",value:"checkpoint inhibitor",type:"mechanism",category:"Immunotherapy",description:"Blocks immune checkpoint proteins",frequency:92,relatedTerms:["PD-1","PD-L1","CTLA-4","immunotherapy"]},{id:"tyrosine_kinase_inhibitor",label:"Tyrosine Kinase Inhibitor",value:"tyrosine kinase inhibitor",type:"mechanism",category:"Targeted Therapy",description:"Inhibits tyrosine kinase enzymes",frequency:90,relatedTerms:["EGFR","BCR-ABL","VEGFR","targeted therapy"]},{id:"monoclonal_antibody",label:"Monoclonal Antibody",value:"monoclonal antibody",type:"mechanism",category:"Targeted Therapy",description:"Engineered antibodies targeting specific antigens",frequency:88,relatedTerms:["mAb","targeted therapy","binding","specificity"]},{id:"alkylating_agent",label:"Alkylating Agent",value:"alkylating agent",type:"mechanism",category:"Chemotherapy",description:"Forms covalent bonds with DNA",frequency:85,relatedTerms:["DNA damage","cyclophosphamide","cisplatin"]},{id:"antimetabolite",label:"Antimetabolite",value:"antimetabolite",type:"mechanism",category:"Chemotherapy",description:"Interferes with DNA/RNA synthesis",frequency:83,relatedTerms:["folate antagonist","purine analog","pyrimidine analog"]},{id:"topoisomerase_inhibitor",label:"Topoisomerase Inhibitor",value:"topoisomerase inhibitor",type:"mechanism",category:"Chemotherapy",description:"Prevents DNA unwinding",frequency:81,relatedTerms:["topotecan","irinotecan","etoposide"]},{id:"proteasome_inhibitor",label:"Proteasome Inhibitor",value:"proteasome inhibitor",type:"mechanism",category:"Targeted Therapy",description:"Blocks protein degradation pathway",frequency:76,relatedTerms:["bortezomib","carfilzomib","protein degradation"]},{id:"angiogenesis_inhibitor",label:"Angiogenesis Inhibitor",value:"angiogenesis inhibitor",type:"mechanism",category:"Targeted Therapy",description:"Prevents blood vessel formation",frequency:79,relatedTerms:["VEGF","bevacizumab","anti-angiogenic"]},{id:"her2_positive",label:"HER2 Positive",value:"HER2 positive",type:"biomarker",category:"Protein Expression",description:"Overexpression of HER2 protein",frequency:94,relatedTerms:["breast cancer","trastuzumab","pertuzumab"]},{id:"er_pr_positive",label:"ER/PR Positive",value:"ER/PR positive",type:"biomarker",category:"Hormone Receptor",description:"Estrogen/Progesterone receptor positive",frequency:92,relatedTerms:["breast cancer","hormone therapy","tamoxifen"]},{id:"triple_negative",label:"Triple Negative",value:"triple negative",type:"biomarker",category:"Receptor Status",description:"ER-, PR-, HER2- breast cancer",frequency:87,relatedTerms:["breast cancer","chemotherapy","BRCA"]},{id:"egfr_mutation",label:"EGFR Mutation",value:"EGFR mutation",type:"biomarker",category:"Genetic Mutation",description:"Epidermal growth factor receptor mutations",frequency:89,relatedTerms:["lung cancer","osimertinib","erlotinib"]},{id:"kras_mutation",label:"KRAS Mutation",value:"KRAS mutation",type:"biomarker",category:"Genetic Mutation",description:"Kirsten rat sarcoma viral oncogene mutations",frequency:85,relatedTerms:["colorectal cancer","lung cancer","pancreatic cancer"]},{id:"brca_mutation",label:"BRCA Mutation",value:"BRCA mutation",type:"biomarker",category:"Genetic Mutation",description:"BRCA1/2 tumor suppressor gene mutations",frequency:88,relatedTerms:["breast cancer","ovarian cancer","PARP inhibitor"]},{id:"pd_l1_positive",label:"PD-L1 Positive",value:"PD-L1 positive",type:"biomarker",category:"Protein Expression",description:"Programmed death-ligand 1 expression",frequency:86,relatedTerms:["immunotherapy","pembrolizumab","checkpoint inhibitor"]},{id:"msi_high",label:"MSI-High",value:"MSI-high",type:"biomarker",category:"Molecular Feature",description:"Microsatellite instability high",frequency:83,relatedTerms:["colorectal cancer","immunotherapy","mismatch repair"]},{id:"tmb_high",label:"TMB-High",value:"TMB-high",type:"biomarker",category:"Molecular Feature",description:"Tumor mutational burden high",frequency:81,relatedTerms:["immunotherapy","checkpoint inhibitor","mutation load"]},{id:"braf",label:"BRAF",value:"BRAF",type:"gene",category:"Oncogene",description:"Proto-oncogene B-Raf",frequency:84,relatedTerms:["melanoma","colorectal cancer","dabrafenib"]},{id:"alk",label:"ALK",value:"ALK",type:"gene",category:"Fusion Gene",description:"Anaplastic lymphoma kinase",frequency:78,relatedTerms:["lung cancer","crizotinib","alectinib"]},{id:"ros1",label:"ROS1",value:"ROS1",type:"gene",category:"Fusion Gene",description:"ROS proto-oncogene 1",frequency:72,relatedTerms:["lung cancer","crizotinib","entrectinib"]},{id:"ntrk",label:"NTRK",value:"NTRK",type:"gene",category:"Fusion Gene",description:"Neurotrophic tyrosine receptor kinase",frequency:68,relatedTerms:["solid tumors","larotrectinib","entrectinib"]},{id:"ret",label:"RET",value:"RET",type:"gene",category:"Fusion Gene",description:"Rearranged during transfection",frequency:70,relatedTerms:["lung cancer","thyroid cancer","selpercatinib"]}],Ft=({placeholder:t="Search drugs, indications, mechanisms...",onSelect:i,onInputChange:c,value:s="",maxResults:d=10,showCategories:b=!0,allowMultiple:k=!1,selectedOptions:f=[],disabled:x=!1,loading:A=!1,className:j="",onOfflineChange:C})=>{const[D,N]=r.useState(s),[n,m]=r.useState(!1),[O,M]=r.useState([]),[h,_]=r.useState(-1),[v,P]=r.useState([]),[B,T]=r.useState([]),[F,se]=r.useState(!1),G=r.useRef(null),Z=r.useRef(null);r.useEffect(()=>{const g=localStorage.getItem("oncosaferx_recent_searches");if(g)try{P(JSON.parse(g))}catch(E){console.warn("Failed to parse recent searches:",E)}},[]),r.useEffect(()=>{let g=!1;if(D.trim().length<2){T([]),se(!1);return}const E=setTimeout(async()=>{try{const K=await fetch(`/api/drugs/search?q=${encodeURIComponent(D)}`);if(!K.ok)throw new Error("suggestions failed");const re=await K.json(),le=(re.results||[]).slice(0,d).map(p=>({id:p.id||p.rxcui||p.name,label:p.name,value:p.name,type:"drug",category:"Drug"}));if(!g){T(le);const p=!re.sources?.rxnorm||re.sources.rxnorm===0;se(p),C?.(p)}}catch{g||T([])}},250);return()=>{g=!0,clearTimeout(E)}},[D,d,C]),r.useEffect(()=>{if(!D.trim()){const p=$e.filter(R=>R.type==="drug"&&R.frequency&&R.frequency>80).sort((R,V)=>(V.frequency||0)-(R.frequency||0)).slice(0,d);M(p);return}const g=D.toLowerCase().trim(),E=(p,R)=>{if(p=p.toLowerCase(),R=R.toLowerCase(),p===R)return{matches:!0,score:100};if(p.startsWith(R))return{matches:!0,score:90};if(p.includes(R))return{matches:!0,score:80};if(R.includes("-")||R.includes(" ")||R.includes(".")){const V=R.replace(/[-\s.]/g,"");if(p.includes(V))return{matches:!0,score:70}}if(R.length>=2){if(p.split(/[\s-()]/).map(J=>J.charAt(0)).join("").includes(R))return{matches:!0,score:60};let Q=0;for(const J of R){const ne=p.indexOf(J,Q);if(ne===-1||(Q=ne+1,Q>=p.length))break}if(Q>0&&R.length>=3)return{matches:!0,score:50}}if(R.length>=3){let V=0,U=-1;for(const Q of R){const J=p.indexOf(Q,U+1);J>U&&(V++,U=J)}if(V/R.length>=.7)return{matches:!0,score:40}}return{matches:!1,score:0}},re=$e.filter(p=>p.type!=="drug"?!1:!!(E(p.label,g).matches||E(p.value,g).matches||p.aliases?.some(U=>E(U,g).matches)||p.relatedTerms?.some(U=>E(U,g).matches)||p.description&&E(p.description,g).matches||E(p.category,g).matches)).map(p=>{const R=E(p.label,g),V=E(p.value,g),U=p.aliases?Math.max(...p.aliases.map(J=>E(J,g).score)):0,Q=Math.max(R.score,V.score,U);return{...p,relevanceScore:Q}}).sort((p,R)=>{if(p.relevanceScore!==R.relevanceScore)return R.relevanceScore-p.relevanceScore;if(p.type==="drug"&&R.type==="drug"){if(p.fdaApproved&&!R.fdaApproved)return-1;if(!p.fdaApproved&&R.fdaApproved)return 1}return(R.frequency||0)-(p.frequency||0)}),le=B.length>0?B.slice(0,d):re.slice(0,d);M(le),_(-1)},[D,d,B]);const l=g=>{const E=g.target.value;N(E),c?.(E),m(!0)},u=g=>{k?f.find(K=>K.id===g.id)||i(g):(N(g.label),i(g));const E=[g.value,...v.filter(K=>K!==g.value)].slice(0,10);P(E),localStorage.setItem("oncosaferx_recent_searches",JSON.stringify(E)),m(!1),_(-1)},y=g=>{if(n)switch(g.key){case"ArrowDown":g.preventDefault(),_(E=>E<O.length-1?E+1:E);break;case"ArrowUp":g.preventDefault(),_(E=>E>0?E-1:E);break;case"Enter":g.preventDefault(),h>=0&&O[h]&&u(O[h]);break;case"Escape":m(!1),_(-1),G.current?.blur();break}},q=g=>{switch(g){case"drug":return e.jsx(ye,{className:"h-4 w-4 text-blue-500"});case"indication":return e.jsx(ge,{className:"h-4 w-4 text-red-500"});case"mechanism":return e.jsx(Ie,{className:"h-4 w-4 text-purple-500"});case"biomarker":return e.jsx(be,{className:"h-4 w-4 text-green-500"});case"gene":return e.jsx(Me,{className:"h-4 w-4 text-pink-500"});case"class":return e.jsx(Ve,{className:"h-4 w-4 text-orange-500"});default:return e.jsx(ie,{className:"h-4 w-4 text-gray-500"})}},te=g=>{console.log("Remove option:",g)};return e.jsxs("div",{className:`relative ${j}`,children:[k&&f.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:f.map(g=>e.jsxs("div",{className:"flex items-center space-x-1 px-3 py-1 bg-violet-100 text-violet-800 rounded-full text-sm",children:[q(g.type),e.jsx("span",{children:g.label}),e.jsx("button",{onClick:()=>te(g.id),className:"text-violet-600 hover:text-violet-800",children:e.jsx(Be,{className:"h-3 w-3"})})]},g.id))}),e.jsxs("div",{className:"relative",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{ref:G,type:"text",value:D,onChange:l,onKeyDown:y,onFocus:()=>m(!0),onBlur:()=>setTimeout(()=>m(!1),200),placeholder:t,disabled:x||A,className:`w-full pl-10 pr-10 py-3 text-lg border border-gray-300 rounded-xl focus:ring-2 focus:ring-violet-500 focus:border-violet-500 ${x?"bg-gray-100 cursor-not-allowed":"bg-white"}`}),A&&e.jsx(Nt,{className:"absolute right-8 top-1/2 transform -translate-y-1/2 h-5 w-5 text-violet-600 animate-spin"}),e.jsx(Pe,{className:`absolute right-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400 transition-transform ${n?"rotate-180":""}`})]}),n&&e.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-96 overflow-hidden",children:[D.trim()===""&&e.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b text-sm text-gray-600",children:v.length>0?"Recent searches & Popular options":"Popular options"}),O.length>0?e.jsx("ul",{ref:Z,className:"max-h-80 overflow-y-auto",children:O.map((g,E)=>e.jsx("li",{children:e.jsxs("button",{onMouseDown:K=>{K.preventDefault()},onClick:()=>u(g),className:`w-full flex items-center space-x-3 px-4 py-3 text-left hover:bg-gray-50 ${E===h?"bg-violet-50 border-l-4 border-violet-500":""}`,children:[q(g.type),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"font-medium text-gray-900 truncate",children:g.label}),g.fdaApproved&&e.jsx(ke,{className:"h-3 w-3 text-green-500 flex-shrink-0"}),g.isOncology&&e.jsx(ge,{className:"h-3 w-3 text-red-500 flex-shrink-0"})]}),b&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-xs text-gray-500 capitalize",children:[g.type," • ",g.category]}),g.frequency&&g.frequency>85&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ae,{className:"h-3 w-3 text-yellow-500"}),e.jsx("span",{className:"text-xs text-yellow-600",children:"Popular"})]})]}),g.description&&e.jsx("p",{className:"text-xs text-gray-400 mt-1 truncate",children:g.description})]}),g.type==="drug"&&e.jsx("div",{className:"text-right flex-shrink-0",children:e.jsx("div",{className:"text-xs text-gray-500",children:g.fdaApproved?"FDA Approved":"Investigational"})})]})},g.id))}):e.jsxs("div",{className:"px-4 py-6 text-center text-gray-500",children:[e.jsx(ie,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No matches found"}),e.jsx("p",{className:"text-xs mt-1",children:"Try a different search term"})]}),O.length>0&&e.jsxs("div",{className:"px-4 py-2 bg-gray-50 border-t text-xs text-gray-500 text-center",children:["Showing ",O.length," result",O.length!==1?"s":"",D.trim()&&` for "${D}"`]})]})]})};function Ae(t,i={}){const c=Te(),s=Je(),{defaultValue:d,serialize:b=Ye,deserialize:k=et,replace:f=!1}=i,x=r.useCallback(()=>{const n=new URLSearchParams(s.search).get(t);if(n!==null)try{return k(n)}catch(m){console.warn(`Failed to deserialize URL parameter "${t}":`,m)}return d??null},[t,s.search,d,k]),[A,j]=r.useState(x),C=r.useCallback(N=>{const n=new URLSearchParams(s.search);if(N==null||N==="")n.delete(t);else try{const M=b(N);n.set(t,M)}catch(M){console.warn(`Failed to serialize value for URL parameter "${t}":`,M);return}const m=n.toString(),O=`${s.pathname}${m?`?${m}`:""}`;f?c(O,{replace:!0}):c(O)},[t,s.pathname,s.search,c,f,b]);r.useEffect(()=>{const N=x();j(N)},[x]);const D=r.useCallback(N=>{j(n=>{const m=typeof N=="function"?N(n):N;return setTimeout(()=>C(m),0),m})},[C]);return[A,D]}function Ye(t){return t==null?"":typeof t=="string"?t:typeof t=="number"||typeof t=="boolean"?String(t):Array.isArray(t)||typeof t=="object"?JSON.stringify(t):String(t)}function et(t){if(!t)return null;try{return JSON.parse(t)}catch{return t==="true"?!0:t==="false"?!1:!isNaN(Number(t))&&t!==""?Number(t):t}}function $t(t,i={}){const c=Te(),s=Je(),{replace:d=!0}=i,b=r.useCallback(()=>{const C=new URLSearchParams(s.search),D={...t};return Object.keys(t).forEach(N=>{const n=C.get(N);if(n!==null)try{D[N]=et(n)}catch(m){console.warn(`Failed to parse filter "${N}" from URL:`,m)}}),D},[s.search]),[k,f]=r.useState(b),x=r.useCallback(C=>{const D=new URLSearchParams(s.search);Object.entries(C).forEach(([m,O])=>{if(O==null||O===""||Array.isArray(O)&&O.length===0||O===t[m])D.delete(m);else try{D.set(m,Ye(O))}catch(M){console.warn(`Failed to serialize filter "${m}":`,M)}});const N=D.toString(),n=`${s.pathname}${N?`?${N}`:""}`;d?c(n,{replace:!0}):c(n)},[s.pathname,s.search,c,d]);r.useEffect(()=>{const C=b();f(C)},[b]);const A=r.useCallback(C=>{f(D=>{const N=typeof C=="function"?C(D):C,n={...D,...N};return setTimeout(()=>x(n),0),n})},[x]),j=r.useCallback(()=>{f(t),setTimeout(()=>x(t),0)},[x,t]);return[k,A,j]}function Gt(t=1,i=20){const[c,s]=Ae("page",{defaultValue:t,replace:!0}),[d,b]=Ae("pageSize",{defaultValue:i,replace:!0}),k=r.useCallback(()=>{s(t)},[s,t]);return{page:c||t,pageSize:d||i,setPage:s,setPageSize:b,resetPagination:k}}function Ut(t,i="asc"){const[c,s]=Ae("sortBy",{defaultValue:t,replace:!0}),[d,b]=Ae("sortDirection",{defaultValue:i,replace:!0}),k=r.useCallback((f,x)=>{s(f),b(x||(f===c&&d==="asc"?"desc":"asc"))},[c,d,s,b]);return{sortBy:c,sortDirection:d||i,updateSort:k,setSortBy:s,setSortDirection:b}}function tt(t,i,c={}){const{serialize:s=JSON.stringify,deserialize:d=JSON.parse,syncAcrossTabs:b=!0}=c,[k,f]=r.useState(()=>{try{const j=window.localStorage.getItem(t);return j!==null?d(j):i}catch(j){return console.warn(`Error reading localStorage key "${t}":`,j),i}}),x=r.useCallback(j=>{try{const C=j instanceof Function?j(k):j;f(C),C===void 0?window.localStorage.removeItem(t):window.localStorage.setItem(t,s(C))}catch(C){console.warn(`Error setting localStorage key "${t}":`,C)}},[t,s,k]),A=r.useCallback(()=>{try{window.localStorage.removeItem(t),f(i)}catch(j){console.warn(`Error removing localStorage key "${t}":`,j)}},[t,i]);return r.useEffect(()=>{if(!b)return;const j=C=>{if(C.key===t&&C.newValue!==null)try{f(d(C.newValue))}catch(D){console.warn(`Error parsing localStorage change for key "${t}":`,D)}else C.key===t&&C.newValue===null&&f(i)};return window.addEventListener("storage",j),()=>window.removeEventListener("storage",j)},[t,d,i,b]),[k,x,A]}function Ht(t,i="user_preferences"){const[c,s,d]=tt(i,t),b=r.useCallback((x,A)=>{s(j=>({...j,[x]:A}))},[s]),k=r.useCallback(x=>{s(A=>({...A,...x}))},[s]),f=r.useCallback(()=>{s(t)},[s,t]);return{preferences:c,updatePreference:b,updatePreferences:k,resetPreferences:f,clearPreferences:d}}function Kt(t=10,i="recent_searches"){const[c,s]=tt(i,[]),d=r.useCallback(f=>{const x=f.trim();x&&s(A=>{const j=A.filter(C=>C!==x);return[x,...j].slice(0,t)})},[s,t]),b=r.useCallback(f=>{s(x=>x.filter(A=>A!==f))},[s]),k=r.useCallback(()=>{s([])},[s]);return{searches:c,addSearch:d,removeSearch:b,clearSearches:k}}const Vt=()=>{const t=Ge(),[i,c]=Ae("q",{defaultValue:""}),[s,d]=$t({onlyOncology:!1,onlyPinned:!1,drugType:"",category:"",hasInteractions:!1,hasGenomics:!1,approvalStatus:"",BN:!1,SCD:!1,SBD:!1,IN:!1,MIN:!1});Gt(1,20),Ut("relevance","desc"),Ht({defaultPageSize:20,showDescriptions:!0,compactView:!1},"drug_search_preferences"),Kt(10,"drug_search_history");const b=Te(),[k,f]=r.useState(null),[x,A]=r.useState(null),[j,C]=r.useState(!1),[D,N]=r.useState(null),[n,m]=r.useState(0),[O,M]=r.useState(!1),[h,_]=r.useState("advanced"),[v,P]=r.useState(null),[B,T]=r.useState(null),[F,se]=r.useState([]),[G,Z]=r.useState([]),[l,u]=r.useState(!1),[y,q]=r.useState(!1),[te,g]=r.useState("unknown"),[E,K]=r.useState(!1),[re,le]=r.useState(null),[p,R]=r.useState([]),[V,U]=r.useState(!1),[Q,J]=r.useState(!1);r.useEffect(()=>{const o=localStorage.getItem("rxnorm_offline_toast_dismissed")==="1";q(o),ne()},[]);async function ne(){try{K(!0);const o=await fetch("/api/drugs/search?q=aspirin",{method:"GET"});if(!o.ok)g("error");else{const z=(await o.json())?.sources?.rxnorm>0;g(z?"online":"offline")}le(new Date().toLocaleTimeString())}catch(o){console.error("Connectivity test failed:",o),g("error"),le(new Date().toLocaleTimeString())}finally{K(!1)}}const ce=r.useMemo(()=>new Set(Object.entries(s).filter(([o,S])=>["BN","SCD","SBD","IN","MIN"].includes(o)&&S).map(([o])=>o)),[s]),oe=r.useMemo(()=>Object.entries(fe()).map(([o,S])=>({rxcui:o,name:S.name})),[n]),ve=async o=>{C(!0),N(null),A(null);try{const S=new URLSearchParams({q:o});s?.drugType&&S.append("type",s.drugType),s?.category&&S.append("category",s.category),s?.hasInteractions&&S.append("hasInteractions","true"),s?.hasGenomics&&S.append("hasGenomics","true"),s?.sortBy&&S.append("sort",s.sortBy);const z=await ze.searchDrugs(o);let L=z.results;if(s?.sortBy)switch(s.sortBy){case"name":L.sort((W,Y)=>W.name.localeCompare(Y.name));break;case"recent":break;case"popular":break;default:break}const H={...z,results:L};f(H);try{we.logSearch(o,H?.count)}catch{}}catch(S){N(S instanceof Error?S.message:"Failed to search drugs"),f(null)}finally{C(!1)}},je=async o=>{A(o),t.addDrug(o),C(!0);try{const S=await ze.getDrugDetails(o.rxcui);A({...o,...S})}catch(S){console.warn("Failed to load drug details:",S)}finally{C(!1)}},Ne=()=>{A(null)};return r.useEffect(()=>{const o=S=>{if(S.key==="/"){const z=document.getElementById("drug-search-input");z&&(S.preventDefault(),z.focus())}else S.key==="Escape"?(A(null),f(null)):S.key.toLowerCase()==="r"&&!S.metaKey&&!S.ctrlKey?d({BN:!1,SCD:!1,SBD:!1,IN:!1,MIN:!1,onlyOncology:!1}):S.key.toLowerCase()==="o"&&!S.metaKey&&!S.ctrlKey&&d({onlyOncology:!s.onlyOncology})};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[]),r.useEffect(()=>{let o=!1;if(h!=="basic"||!i||String(i).trim().length<2){R([]),U(!1);return}J(!0);const S=setTimeout(async()=>{try{const z=await fetch(`/api/drugs/search?q=${encodeURIComponent(i)}`);if(!z.ok)throw new Error("suggestions failed");const L=await z.json();if(o)return;R((L.results||[]).slice(0,8).map(H=>({name:H.name,rxcui:H.rxcui}))),U(!L.sources?.rxnorm||L.sources.rxnorm===0)}catch{o||(R([]),U(!1))}finally{o||J(!1)}},300);return()=>{o=!0,clearTimeout(S)}},[h,i]),x?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ke,{className:"h-6 w-6 text-green-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-green-800",children:"Drug Selected Successfully!"}),e.jsxs("p",{className:"text-sm text-green-700",children:["You've selected ",e.jsx("strong",{children:x.name}),". Explore the options below to analyze interactions, genomics, or clinical protocols."]})]})]})}),e.jsxs("button",{onClick:Ne,className:"flex items-center space-x-2 text-primary-600 hover:text-primary-700 font-medium",children:[e.jsx("span",{children:"←"}),e.jsx("span",{children:"Back to Search Results"})]}),j?e.jsx($,{children:e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading drug details..."})]})})}):e.jsx(Ce,{drug:x,showDetails:!0}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs($,{padding:"sm",className:"text-center",children:[e.jsx("div",{className:"text-primary-600 mb-2",children:e.jsx(ie,{className:"w-6 h-6 mx-auto"})}),e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:"View Interactions"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Check drug-drug interactions"}),e.jsx("button",{onClick:()=>setTimeout(()=>b(`/interactions?drug=${x.rxcui}`),100),className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Check Interactions →"})]}),e.jsxs($,{padding:"sm",className:"text-center",children:[e.jsx("div",{className:"text-purple-600 mb-2",children:e.jsx(ae,{className:"w-6 h-6 mx-auto"})}),e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:"Genomic Analysis"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"View pharmacogenomic factors"}),e.jsx("button",{onClick:()=>setTimeout(()=>b(`/genomics?drug=${x.rxcui}`),100),className:"text-sm text-purple-600 hover:text-purple-700 font-medium",children:"Analyze Genomics →"})]}),e.jsxs($,{padding:"sm",className:"text-center",children:[e.jsx("div",{className:"text-green-600 mb-2",children:e.jsx(vt,{className:"w-6 h-6 mx-auto"})}),e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:"Clinical Trials"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Find relevant studies"}),e.jsx("button",{onClick:()=>setTimeout(()=>b(`/protocols?drug=${x.name}`),100),className:"text-sm text-green-600 hover:text-green-700 font-medium",children:"View Trials →"})]})]})]}):e.jsxs("div",{className:"space-y-8",children:[l&&!y&&e.jsxs("div",{className:"p-3 border border-amber-200 bg-amber-50 text-amber-800 rounded flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Using offline suggestions"}),e.jsx("div",{className:"text-sm",children:"RxNorm appears unreachable. Typeahead uses a limited offline list; full results may be reduced."})]}),e.jsx("button",{className:"text-amber-800 hover:text-amber-900 text-sm ml-4",onClick:()=>{u(!1),q(!0),localStorage.setItem("rxnorm_offline_toast_dismissed","1")},"aria-label":"Dismiss offline notice",children:"Dismiss"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-violet-600/10 via-blue-600/10 to-indigo-600/10 rounded-2xl"}),e.jsxs("div",{className:"relative p-8 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-6",children:[e.jsx("div",{className:"p-3 bg-gradient-to-r from-violet-600 to-indigo-600 rounded-xl",children:e.jsx(he,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-violet-600 to-indigo-600 bg-clip-text text-transparent",children:"Intelligent Drug Discovery"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(pe,{className:"w-6 h-6 text-violet-600"}),e.jsx("span",{className:"px-3 py-1 bg-violet-100 text-violet-800 rounded-full text-sm font-medium",children:"AI-Powered"})]})]}),e.jsx("p",{className:"text-xl text-gray-600 max-w-4xl mx-auto mb-6",children:"Advanced drug search with AI-powered insights, molecular analysis, and personalized recommendations"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-lg p-4 border border-violet-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-violet-600 mb-2",children:[e.jsx(ye,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Drug Database"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"50,000+"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Medications"})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-blue-600 mb-2",children:[e.jsx(be,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Interactions"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"2.5M+"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Drug Pairs"})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-lg p-4 border border-green-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-green-600 mb-2",children:[e.jsx(Qe,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Clinical Trials"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"25,000+"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Active Studies"})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-lg p-4 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-purple-600 mb-2",children:[e.jsx(Me,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Oncology Focus"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"5,000+"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Cancer Drugs"})]})]}),oe.length>0&&e.jsxs("div",{className:"mt-6 flex items-center justify-center space-x-2",children:[e.jsx(ae,{className:"w-5 h-5 text-yellow-500"}),e.jsxs("span",{className:"text-lg font-medium text-gray-700",children:[oe.length," Pinned Medication",oe.length!==1?"s":""]})]})]})]}),e.jsx("div",{className:"flex items-center justify-center mt-2",children:e.jsxs("div",{className:"inline-flex items-center gap-3 text-xs text-gray-600 bg-gray-50 border border-gray-200 rounded px-3 py-2",children:[e.jsxs("div",{className:"inline-flex items-center gap-2",children:[e.jsx("span",{className:`inline-block w-2.5 h-2.5 rounded-full ${te==="online"?"bg-green-500":te==="offline"?"bg-amber-500":te==="error"?"bg-red-500":"bg-gray-400"}`}),e.jsxs("span",{children:[te==="online"&&"RxNorm connectivity: Online",te==="offline"&&"RxNorm connectivity: Offline (fallback)",te==="error"&&"RxNorm connectivity: Error",te==="unknown"&&"RxNorm connectivity: Unknown",re?` • Checked ${re}`:""]})]}),e.jsx("button",{onClick:ne,disabled:E,className:"text-blue-700 hover:text-blue-800 underline disabled:opacity-60",children:E?"Testing…":"Test connectivity"})]})}),e.jsx("div",{className:"flex items-center justify-center space-x-4",children:e.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[{mode:"basic",label:"Basic Search",icon:ie},{mode:"advanced",label:"Advanced Filters",icon:Re},{mode:"ai",label:"AI Assistant",icon:pe}].map(({mode:o,label:S,icon:z})=>e.jsxs("button",{onClick:()=>_(o),className:`flex items-center space-x-2 px-4 py-2 rounded-md text-sm font-medium transition-all ${h===o?"bg-white text-violet-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{children:S})]},o))})}),h==="basic"&&e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx(Ft,{placeholder:"Search drugs by name, indication, or mechanism...",onSelect:o=>{if(c(o.value),o.type==="drug"){const S={rxcui:o.id,name:o.label,synonym:o.value,tty:"SBD"};je(S)}else ve(o.value)},onInputChange:o=>c(o),value:i,loading:j,maxResults:8,showCategories:!0,className:"w-full",onOfflineChange:o=>{o?y||u(!0):u(!1)}}),e.jsx("div",{className:"flex items-center justify-center mt-4",children:e.jsxs("button",{onClick:()=>ve(i),disabled:j||!i||!String(i).trim(),className:"bg-gradient-to-r from-violet-600 to-indigo-600 text-white px-8 py-3 text-lg rounded-lg hover:from-violet-700 hover:to-indigo-700 disabled:opacity-50 flex items-center space-x-2",children:[e.jsx(ie,{className:"h-5 w-5"}),e.jsx("span",{children:"Search Drugs"})]})}),i&&String(i).trim().length>=2&&e.jsxs("div",{className:"mt-4 bg-white border border-gray-200 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Top matches"}),V&&e.jsx("div",{className:"text-[11px] text-gray-500",children:"Using offline suggestions"})]}),e.jsx("div",{className:"p-3",children:Q?e.jsx("div",{className:"text-xs text-gray-500",children:"Analyzing…"}):p.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:p.map((o,S)=>e.jsx("button",{onClick:()=>c(o.name),className:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-800 hover:bg-gray-200",title:o.rxcui?`RXCUI ${o.rxcui}`:o.name,children:o.name},`${o.rxcui||o.name}-${S}`))}):e.jsx("div",{className:"text-xs text-gray-500",children:"No matches"})})]})]}),h==="advanced"&&e.jsx(zt,{onOfflineChange:o=>{o?y||u(!0):u(!1)}}),h==="ai"&&e.jsx("div",{className:"space-y-6",children:e.jsx($,{className:"border-violet-200 bg-gradient-to-r from-violet-50 to-indigo-50",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[e.jsx(pe,{className:"h-6 w-6 text-violet-600"}),e.jsx("h2",{className:"text-xl font-bold text-violet-800",children:"AI Drug Discovery Assistant"}),e.jsx("span",{className:"px-2 py-1 bg-violet-100 text-violet-800 rounded-full text-sm font-medium",children:"Beta"})]}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[e.jsx(Ze,{className:"h-8 w-8 text-violet-600"}),e.jsx("span",{className:"text-2xl font-bold text-violet-800",children:"Ask the AI"})]}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Describe your patient case, treatment goals, or ask questions about drug therapy"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 cursor-pointer hover:bg-blue-50 border border-blue-200 rounded-lg bg-white",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-blue-600 mb-2",children:[e.jsx(ge,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Find Similar Drugs"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:'"Find drugs similar to pembrolizumab for lung cancer"'})]}),e.jsxs("div",{className:"p-4 cursor-pointer hover:bg-green-50 border border-green-200 rounded-lg bg-white",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-green-600 mb-2",children:[e.jsx(be,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Biomarker Matching"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:'"What drugs target HER2-positive breast cancer?"'})]}),e.jsxs("div",{className:"p-4 cursor-pointer hover:bg-purple-50 border border-purple-200 rounded-lg bg-white",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-purple-600 mb-2",children:[e.jsx(Ie,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Drug Interactions"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:'"Check interactions between warfarin and chemotherapy"'})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{id:"ai-input",placeholder:"Describe your patient case or ask a question about drug therapy...",className:"w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500 focus:border-violet-500 h-32 resize-none",value:i,onChange:o=>c(o.target.value)}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(ot,{className:"h-4 w-4"}),e.jsx("span",{children:"AI responses are for educational purposes only"})]}),e.jsxs("button",{onClick:()=>{i&&String(i).trim()&&P({query:i,response:"AI assistant is currently in development. For now, please use the basic or advanced search modes to find specific drugs and their interactions.",suggestions:["Try searching for specific drug names","Use the advanced filters to narrow your search","Check drug interactions in the interaction checker"]})},disabled:!i||!String(i).trim()||j,className:"bg-gradient-to-r from-violet-600 to-indigo-600 text-white px-4 py-2 rounded-lg hover:from-violet-700 hover:to-indigo-700 flex items-center space-x-2 disabled:opacity-50",children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx("span",{children:"Ask AI Assistant"})]})]})]}),v&&e.jsxs("div",{className:"mt-6 p-4 bg-violet-50 border border-violet-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(pe,{className:"h-5 w-5 text-violet-600"}),e.jsx("span",{className:"font-medium text-violet-800",children:"AI Response"})]}),e.jsx("p",{className:"text-gray-700 mb-4",children:v.response}),v.suggestions&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Suggestions:"}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:v.suggestions.map((o,S)=>e.jsx("li",{className:"text-sm text-gray-600",children:o},S))})]})]})]})})}),(h==="basic"||h==="advanced")&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 mr-1",children:"Pinned:"}),oe.length===0?e.jsx("span",{className:"text-xs text-gray-400",children:"No pinned drugs yet"}):oe.slice(0,10).map((o,S)=>e.jsxs("div",{className:"inline-flex items-center pl-2 pr-1 py-1 rounded-full text-xs bg-yellow-50 text-yellow-800 border border-yellow-200",title:`Pinned: ${o.name}`,draggable:!0,onDragStart:z=>{z.dataTransfer.setData("text/plain",o.rxcui),z.dataTransfer.effectAllowed="move"},onDragOver:z=>{z.preventDefault(),z.dataTransfer.dropEffect="move"},onDrop:z=>{z.preventDefault();const L=z.dataTransfer.getData("text/plain");if(!L||L===o.rxcui)return;const H=oe.slice(0,10).map(a=>a.rxcui),W=H.indexOf(L),Y=S;W===-1||Y===-1||(H.splice(Y,0,H.splice(W,1)[0]),Ct(H),m(a=>a+1))},children:[e.jsx("button",{onClick:()=>ve(o.name),className:"px-0.5 mr-1 hover:underline","aria-label":`Search for ${o.name}`,children:o.name}),e.jsx("button",{onClick:z=>{z.stopPropagation(),Se(o.rxcui,o.name),m(L=>L+1)},className:"ml-1 inline-flex items-center justify-center w-4 h-4 rounded-full hover:bg-yellow-100","aria-label":`Unpin ${o.name}`,title:"Unpin",children:e.jsx(Be,{className:"w-3 h-3"})})]},o.rxcui))]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",className:`text-xs px-2 py-1 rounded-full border ${s.onlyPinned?"bg-yellow-100 text-yellow-800 border-yellow-200":"text-gray-600 bg-gray-50 border-gray-200 hover:text-gray-800"}`,onClick:()=>d({onlyPinned:!s.onlyPinned}),"aria-pressed":s.onlyPinned,"aria-label":`Show only pinned ${s.onlyPinned?"on":"off"}`,title:"Show only pinned in results",children:"Show only pinned"}),e.jsx("button",{type:"button",className:"text-xs text-gray-500 hover:text-gray-700 underline",onClick:()=>{if(!k||!Array.isArray(k.results))return;const o=fe(),S=["pembrolizumab","nivolumab","fluorouracil","cisplatin","doxorubicin","paclitaxel","tamoxifen","imatinib"];k.results.filter(L=>{const H=ce.size===0||(L.tty?ce.has(L.tty):!1),W=S.some(a=>(L.name||"").toLowerCase().includes(a)),Y=!s.onlyOncology||W;return H&&Y&&o[L.rxcui]}).forEach(L=>{o[L.rxcui]&&Se(L.rxcui,L.name)}),m(L=>L+1)},"aria-label":"Unpin all shown results",title:"Unpin all shown in results",children:"Unpin Shown"}),e.jsx("button",{type:"button",className:"text-xs text-gray-500 hover:text-gray-700 underline",onClick:()=>{St(),m(o=>o+1)},"aria-label":"Clear pinned drugs",children:"Clear Pins"})]})]})}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 mr-1",children:"Filters:"}),["BN","SCD","SBD","IN","MIN"].map(o=>e.jsx("button",{type:"button",onClick:()=>d({[o]:!s[o]}),className:`px-2 py-1 rounded-full text-xs border ${s[o]?"bg-blue-100 text-blue-700 border-blue-200":"bg-gray-50 text-gray-600 border-gray-200"}`,"aria-pressed":s[o],"aria-label":`Filter ${o} ${s[o]?"on":"off"}`,children:o},o)),e.jsx("button",{type:"button",onClick:()=>d({onlyOncology:!s.onlyOncology}),className:`px-2 py-1 rounded-full text-xs border ${s.onlyOncology?"bg-purple-100 text-purple-700 border-purple-200":"bg-gray-50 text-gray-600 border-gray-200"}`,"aria-pressed":s.onlyOncology,"aria-label":`Oncology filter ${s.onlyOncology?"on":"off"}`,children:"Oncology"}),e.jsx("button",{type:"button",onClick:()=>d({onlyPinned:!s.onlyPinned}),className:`px-2 py-1 rounded-full text-xs border ${s.onlyPinned?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-gray-50 text-gray-600 border-gray-200"}`,"aria-pressed":s.onlyPinned,"aria-label":`Pinned filter ${s.onlyPinned?"on":"off"}`,children:"Pinned only"}),e.jsx("button",{type:"button",onClick:()=>d({BN:!1,SCD:!1,SBD:!1,IN:!1,MIN:!1,onlyOncology:!1}),className:"px-2 py-1 rounded-full text-xs border bg-gray-50 text-gray-600 border-gray-200",children:"Reset"}),e.jsx("button",{type:"button",onClick:()=>{if(!k||!Array.isArray(k.results))return;const o=fe(),S=["pembrolizumab","nivolumab","fluorouracil","cisplatin","doxorubicin","paclitaxel","tamoxifen","imatinib"];k.results.filter(L=>{const H=ce.size===0||(L.tty?ce.has(L.tty):!1),W=S.some(a=>(L.name||"").toLowerCase().includes(a)),Y=!s.onlyOncology||W;return H&&Y}).forEach(L=>{o[L.rxcui]||Se(L.rxcui,L.name)}),m(L=>L+1)},className:"px-2 py-1 rounded-full text-xs border bg-yellow-50 text-yellow-800 border-yellow-200 hover:bg-yellow-100","aria-label":"Pin all shown results",children:"Pin All Shown"})]}),k&&e.jsxs("div",{className:`grid ${x?"md:grid-cols-2 gap-6":""}`,children:[e.jsx("div",{children:e.jsx(Dt,{results:k,loading:j,error:D,onDrugSelect:je,filters:{onlyOncology:s.onlyOncology,onlyPinned:s.onlyPinned,tty:ce},pinVersion:n})}),x&&e.jsx("div",{children:e.jsx(Ce,{drug:x,showDetails:!0})})]}),!k&&!j&&e.jsx($,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(he,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-blue-900",children:"Search Features"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 text-sm text-blue-800",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center space-x-1",children:[e.jsx(ie,{className:"w-4 h-4"}),e.jsx("span",{children:"Search Capabilities"})]}),e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Search by generic or brand name"}),e.jsx("li",{children:"• Partial name matching supported"}),e.jsx("li",{children:"• Case-insensitive search"}),e.jsx("li",{children:"• Search by drug categories"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center space-x-1",children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsx("span",{children:"Quick Access"})]}),e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Organized drug shortcuts by category"}),e.jsx("li",{children:"• Common medications readily available"}),e.jsx("li",{children:"• Oncology drugs for cancer care"}),e.jsx("li",{children:"• Cardiovascular medications"})]})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-100 rounded-lg",children:e.jsxs("p",{className:"text-blue-800 text-sm",children:[e.jsx("strong",{children:"Tip:"})," Use the quick access buttons above for common medications, or search directly by typing the drug name."]})})]})}),e.jsx(Le,{type:"info",title:"Data Sources",children:"Drug information is sourced from RxNorm (National Library of Medicine), FDA's DailyMed database, and our curated database of oncology medications. Data is regularly updated to ensure accuracy."})]})},ja=()=>e.jsx(bt,{featureName:"Drug Search",fallbackMessage:"The drug search feature is temporarily unavailable. This may be due to database connectivity or processing issues.",children:e.jsx(Vt,{})});export{ja as default};
//# sourceMappingURL=DrugSearch-B0fuDZ6Q.js.map
